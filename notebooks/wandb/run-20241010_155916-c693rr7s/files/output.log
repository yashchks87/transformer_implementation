  0%|          | 0/59 [00:14<?, ?batch/s]
OUTPUT: torch.Size([21, 68729, 49])
TGT: torch.Size([21, 48])
OUTPUT: torch.Size([21, 68729, 49])
TGT: torch.Size([21, 48])
OUTPUT: torch.Size([21, 68729, 49])
TGT: torch.Size([21, 48])
OUTPUT: torch.Size([21, 68729, 49])
TGT: torch.Size([21, 48])
OUTPUT: torch.Size([21, 68729, 49])
TGT: torch.Size([21, 48])
OUTPUT: torch.Size([21, 68729, 49])
TGT: torch.Size([21, 48])
OUTPUT: torch.Size([21, 68729, 49])
TGT: torch.Size([21, 48])
OUTPUT: torch.Size([21, 68729, 49])
TGT: torch.Size([21, 48])
The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
[34m[1mwandb[0m: [33mWARNING[0m Calling wandb.login() after wandb.init() has no effect.
Reading CSV file...
Splitting is completed. Train size: 9801, Val size: 99, Test size: 100
Datasets are created.
DataLoaders are created.
  0%|          | 0/59 [00:00<?, ?batch/s]
Output: tensor([[[ 5.2976e-02,  7.3244e-01, -1.2614e+00,  ...,  4.4182e-01,
           1.3542e-01, -3.1532e-01],
         [-2.9431e-01,  5.5307e-02, -4.8923e-01,  ..., -5.1807e-01,
          -2.9482e-01, -3.5950e-01],
         [-8.9761e-02,  1.2789e+00, -1.0538e+00,  ...,  1.3350e-01,
           2.0262e-01, -4.4851e-01],
         ...,
         [-1.0509e-03,  1.2527e+00, -1.4951e+00,  ..., -9.6556e-02,
           5.9266e-01,  3.1001e-01],
         [-4.3390e-01,  1.0841e+00, -1.5000e+00,  ...,  6.1076e-02,
           4.7776e-01,  6.7173e-01],
         [-2.7941e-01,  9.5513e-01, -1.3092e+00,  ..., -1.7426e-01,
           2.4694e-01,  4.2174e-01]],

        [[ 5.8182e-01,  1.6112e+00, -1.1961e+00,  ...,  1.8085e-01,
           1.9095e-01, -1.9067e-01],
         [-7.6959e-01,  1.4187e+00, -5.3425e-01,  ..., -1.4648e-01,
           2.3376e-01, -1.4781e+00],
         [ 7.5080e-01,  6.7041e-01, -1.2291e+00,  ..., -4.1907e-01,
           3.8174e-01, -2.6373e-01],
         ...,
         [-3.0974e-01,  1.6359e+00, -1.2864e+00,  ..., -5.4178e-02,
           4.2540e-01,  4.0268e-01],
         [-4.5348e-01,  1.2373e+00, -1.3209e+00,  ..., -1.3576e-01,
           3.4109e-01,  8.2168e-01],
         [-6.3966e-01,  1.1139e+00, -9.6213e-01,  ..., -3.9663e-01,
           5.9919e-01,  4.1091e-01]],

        [[ 6.7979e-01,  9.6908e-01, -7.6191e-01,  ...,  6.1165e-01,
          -1.2480e-01, -5.6435e-01],
         [-1.0115e+00,  1.8958e-01,  1.3362e-01,  ...,  5.2550e-03,
           2.5335e-01, -1.2099e+00],
         [-1.1505e+00,  2.3889e-01, -7.7809e-01,  ..., -3.4832e-01,
           1.3495e+00, -4.7413e-01],
         ...,
         [-3.9197e-01,  1.0753e+00, -6.6972e-01,  ..., -3.3372e-01,
           2.9000e-01, -1.1632e-01],
         [-1.1649e-02,  1.1728e+00, -8.7268e-01,  ...,  3.3100e-01,
           8.2267e-02,  5.8441e-01],
         [-1.7789e-01,  1.3192e+00, -7.2151e-01,  ..., -2.8092e-01,
           3.6349e-01,  5.3393e-01]],

        ...,

        [[ 5.6018e-02,  8.6508e-01, -1.3515e+00,  ...,  2.1439e-01,
           5.3680e-02, -1.0306e+00],
         [-1.3565e+00,  1.4198e-01, -2.3899e-01,  ..., -4.2612e-02,
          -3.7078e-02, -1.2100e+00],
         [-6.9830e-01,  3.6463e-01, -4.8850e-01,  ..., -2.6931e-01,
          -6.5656e-01, -1.6090e+00],
         ...,
         [-1.1514e+00,  1.2377e+00, -1.1572e+00,  ...,  3.4151e-02,
          -3.4058e-02, -5.3869e-01],
         [-9.5349e-01,  1.2793e+00, -1.3025e+00,  ..., -3.0060e-01,
          -9.9602e-02, -4.5509e-01],
         [-8.0708e-01,  1.0296e+00, -7.9292e-01,  ..., -6.9695e-01,
           1.6247e-01, -1.4205e-02]],

        [[ 1.5808e-01,  8.8005e-01, -1.0257e+00,  ...,  3.8376e-02,
          -1.6900e-01, -6.3006e-01],
         [-3.9203e-01,  6.0271e-01, -4.4512e-01,  ..., -8.1560e-01,
          -2.9854e-01, -8.9487e-01],
         [-2.9836e-01,  1.5659e+00, -1.1697e+00,  ..., -4.8072e-01,
           4.7241e-01, -1.8921e+00],
         ...,
         [-8.1952e-01,  1.6268e+00, -1.3291e+00,  ..., -3.0548e-01,
           6.8731e-02,  2.5948e-01],
         [-7.4338e-01,  1.1583e+00, -1.0175e+00,  ..., -5.3883e-01,
           3.5188e-01,  3.9551e-01],
         [-3.6019e-01,  1.0538e+00, -4.8266e-01,  ..., -1.5472e-01,
           2.5917e-01,  2.0193e-01]],

        [[-2.1610e-01,  6.3628e-01, -1.1846e+00,  ..., -1.0178e-01,
           3.4077e-01, -1.4862e-01],
         [-5.0369e-01,  1.1730e+00,  3.9123e-01,  ..., -8.8030e-01,
           3.9647e-01, -6.5553e-01],
         [ 1.3047e-01,  8.6118e-01,  2.8730e-01,  ..., -1.4439e-01,
           4.3917e-01, -3.4455e-01],
         ...,
         [-8.0171e-01,  1.0592e+00, -9.8085e-01,  ..., -1.4561e-01,
           1.5933e-01,  2.3658e-01],
         [-8.7569e-01,  9.8061e-01, -6.9187e-01,  ..., -5.0145e-01,
           8.2626e-01,  6.9119e-02],
         [-6.6509e-01,  1.1977e+00, -4.1874e-01,  ..., -7.1837e-01,
           3.8678e-01, -7.2881e-02]]], device='cuda:0',
       grad_fn=<GatherBackward>)
Tgt: tensor([[    0,   593,  8991,  ...,     2,     2,     2],
        [    0, 18562, 50379,  ...,     2,     2,     2],
        [    0,    64,  6184,  ...,     2,     2,     2],
        ...,
        [    0,    64,  2611,  ...,     2,     2,     2],
        [    0,   141,  2481,  ...,     2,     2,     2],
        [    0,    29, 14766,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[ 5.2976e-02, -2.9431e-01, -8.9761e-02,  ..., -1.0509e-03,
          -4.3390e-01, -2.7941e-01],
         [ 7.3244e-01,  5.5307e-02,  1.2789e+00,  ...,  1.2527e+00,
           1.0841e+00,  9.5513e-01],
         [-1.2614e+00, -4.8923e-01, -1.0538e+00,  ..., -1.4951e+00,
          -1.5000e+00, -1.3092e+00],
         ...,
         [ 4.4182e-01, -5.1807e-01,  1.3350e-01,  ..., -9.6556e-02,
           6.1076e-02, -1.7426e-01],
         [ 1.3542e-01, -2.9482e-01,  2.0262e-01,  ...,  5.9266e-01,
           4.7776e-01,  2.4694e-01],
         [-3.1532e-01, -3.5950e-01, -4.4851e-01,  ...,  3.1001e-01,
           6.7173e-01,  4.2174e-01]],

        [[ 5.8182e-01, -7.6959e-01,  7.5080e-01,  ..., -3.0974e-01,
          -4.5348e-01, -6.3966e-01],
         [ 1.6112e+00,  1.4187e+00,  6.7041e-01,  ...,  1.6359e+00,
           1.2373e+00,  1.1139e+00],
         [-1.1961e+00, -5.3425e-01, -1.2291e+00,  ..., -1.2864e+00,
          -1.3209e+00, -9.6213e-01],
         ...,
         [ 1.8085e-01, -1.4648e-01, -4.1907e-01,  ..., -5.4178e-02,
          -1.3576e-01, -3.9663e-01],
         [ 1.9095e-01,  2.3376e-01,  3.8174e-01,  ...,  4.2540e-01,
           3.4109e-01,  5.9919e-01],
         [-1.9067e-01, -1.4781e+00, -2.6373e-01,  ...,  4.0268e-01,
           8.2168e-01,  4.1091e-01]],

        [[ 6.7979e-01, -1.0115e+00, -1.1505e+00,  ..., -3.9197e-01,
          -1.1649e-02, -1.7789e-01],
         [ 9.6908e-01,  1.8958e-01,  2.3889e-01,  ...,  1.0753e+00,
           1.1728e+00,  1.3192e+00],
         [-7.6191e-01,  1.3362e-01, -7.7809e-01,  ..., -6.6972e-01,
          -8.7268e-01, -7.2151e-01],
         ...,
         [ 6.1165e-01,  5.2550e-03, -3.4832e-01,  ..., -3.3372e-01,
           3.3100e-01, -2.8092e-01],
         [-1.2480e-01,  2.5335e-01,  1.3495e+00,  ...,  2.9000e-01,
           8.2267e-02,  3.6349e-01],
         [-5.6435e-01, -1.2099e+00, -4.7413e-01,  ..., -1.1632e-01,
           5.8441e-01,  5.3393e-01]],

        ...,

        [[ 5.6018e-02, -1.3565e+00, -6.9830e-01,  ..., -1.1514e+00,
          -9.5349e-01, -8.0708e-01],
         [ 8.6508e-01,  1.4198e-01,  3.6463e-01,  ...,  1.2377e+00,
           1.2793e+00,  1.0296e+00],
         [-1.3515e+00, -2.3899e-01, -4.8850e-01,  ..., -1.1572e+00,
          -1.3025e+00, -7.9292e-01],
         ...,
         [ 2.1439e-01, -4.2612e-02, -2.6931e-01,  ...,  3.4151e-02,
          -3.0060e-01, -6.9695e-01],
         [ 5.3680e-02, -3.7078e-02, -6.5656e-01,  ..., -3.4058e-02,
          -9.9602e-02,  1.6247e-01],
         [-1.0306e+00, -1.2100e+00, -1.6090e+00,  ..., -5.3869e-01,
          -4.5509e-01, -1.4205e-02]],

        [[ 1.5808e-01, -3.9203e-01, -2.9836e-01,  ..., -8.1952e-01,
          -7.4338e-01, -3.6019e-01],
         [ 8.8005e-01,  6.0271e-01,  1.5659e+00,  ...,  1.6268e+00,
           1.1583e+00,  1.0538e+00],
         [-1.0257e+00, -4.4512e-01, -1.1697e+00,  ..., -1.3291e+00,
          -1.0175e+00, -4.8266e-01],
         ...,
         [ 3.8376e-02, -8.1560e-01, -4.8072e-01,  ..., -3.0548e-01,
          -5.3883e-01, -1.5472e-01],
         [-1.6900e-01, -2.9854e-01,  4.7241e-01,  ...,  6.8731e-02,
           3.5188e-01,  2.5917e-01],
         [-6.3006e-01, -8.9487e-01, -1.8921e+00,  ...,  2.5948e-01,
           3.9551e-01,  2.0193e-01]],

        [[-2.1610e-01, -5.0369e-01,  1.3047e-01,  ..., -8.0171e-01,
          -8.7569e-01, -6.6509e-01],
         [ 6.3628e-01,  1.1730e+00,  8.6118e-01,  ...,  1.0592e+00,
           9.8061e-01,  1.1977e+00],
         [-1.1846e+00,  3.9123e-01,  2.8730e-01,  ..., -9.8085e-01,
          -6.9187e-01, -4.1874e-01],
         ...,
         [-1.0178e-01, -8.8030e-01, -1.4439e-01,  ..., -1.4561e-01,
          -5.0145e-01, -7.1837e-01],
         [ 3.4077e-01,  3.9647e-01,  4.3917e-01,  ...,  1.5933e-01,
           8.2626e-01,  3.8678e-01],
         [-1.4862e-01, -6.5553e-01, -3.4455e-01,  ...,  2.3658e-01,
           6.9119e-02, -7.2881e-02]]], device='cuda:0',
       grad_fn=<PermuteBackward0>)
Tgt: tensor([[    0,   593,  8991,  ...,     2,     2,     2],
        [    0, 18562, 50379,  ...,     2,     2,     2],
        [    0,    64,  6184,  ...,     2,     2,     2],
        ...,
        [    0,    64,  2611,  ...,     2,     2,     2],
        [    0,   141,  2481,  ...,     2,     2,     2],
        [    0,    29, 14766,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[ 5.2976e-02, -2.9431e-01, -8.9761e-02,  ..., -1.0509e-03,
          -4.3390e-01, -2.7941e-01],
         [ 7.3244e-01,  5.5307e-02,  1.2789e+00,  ...,  1.2527e+00,
           1.0841e+00,  9.5513e-01],
         [-1.2614e+00, -4.8923e-01, -1.0538e+00,  ..., -1.4951e+00,
          -1.5000e+00, -1.3092e+00],
         ...,
         [ 4.4182e-01, -5.1807e-01,  1.3350e-01,  ..., -9.6556e-02,
           6.1076e-02, -1.7426e-01],
         [ 1.3542e-01, -2.9482e-01,  2.0262e-01,  ...,  5.9266e-01,
           4.7776e-01,  2.4694e-01],
         [-3.1532e-01, -3.5950e-01, -4.4851e-01,  ...,  3.1001e-01,
           6.7173e-01,  4.2174e-01]],

        [[ 5.8182e-01, -7.6959e-01,  7.5080e-01,  ..., -3.0974e-01,
          -4.5348e-01, -6.3966e-01],
         [ 1.6112e+00,  1.4187e+00,  6.7041e-01,  ...,  1.6359e+00,
           1.2373e+00,  1.1139e+00],
         [-1.1961e+00, -5.3425e-01, -1.2291e+00,  ..., -1.2864e+00,
          -1.3209e+00, -9.6213e-01],
         ...,
         [ 1.8085e-01, -1.4648e-01, -4.1907e-01,  ..., -5.4178e-02,
          -1.3576e-01, -3.9663e-01],
         [ 1.9095e-01,  2.3376e-01,  3.8174e-01,  ...,  4.2540e-01,
           3.4109e-01,  5.9919e-01],
         [-1.9067e-01, -1.4781e+00, -2.6373e-01,  ...,  4.0268e-01,
           8.2168e-01,  4.1091e-01]],

        [[ 6.7979e-01, -1.0115e+00, -1.1505e+00,  ..., -3.9197e-01,
          -1.1649e-02, -1.7789e-01],
         [ 9.6908e-01,  1.8958e-01,  2.3889e-01,  ...,  1.0753e+00,
           1.1728e+00,  1.3192e+00],
         [-7.6191e-01,  1.3362e-01, -7.7809e-01,  ..., -6.6972e-01,
          -8.7268e-01, -7.2151e-01],
         ...,
         [ 6.1165e-01,  5.2550e-03, -3.4832e-01,  ..., -3.3372e-01,
           3.3100e-01, -2.8092e-01],
         [-1.2480e-01,  2.5335e-01,  1.3495e+00,  ...,  2.9000e-01,
           8.2267e-02,  3.6349e-01],
         [-5.6435e-01, -1.2099e+00, -4.7413e-01,  ..., -1.1632e-01,
           5.8441e-01,  5.3393e-01]],

        ...,

        [[ 5.6018e-02, -1.3565e+00, -6.9830e-01,  ..., -1.1514e+00,
          -9.5349e-01, -8.0708e-01],
         [ 8.6508e-01,  1.4198e-01,  3.6463e-01,  ...,  1.2377e+00,
           1.2793e+00,  1.0296e+00],
         [-1.3515e+00, -2.3899e-01, -4.8850e-01,  ..., -1.1572e+00,
          -1.3025e+00, -7.9292e-01],
         ...,
         [ 2.1439e-01, -4.2612e-02, -2.6931e-01,  ...,  3.4151e-02,
          -3.0060e-01, -6.9695e-01],
         [ 5.3680e-02, -3.7078e-02, -6.5656e-01,  ..., -3.4058e-02,
          -9.9602e-02,  1.6247e-01],
         [-1.0306e+00, -1.2100e+00, -1.6090e+00,  ..., -5.3869e-01,
          -4.5509e-01, -1.4205e-02]],

        [[ 1.5808e-01, -3.9203e-01, -2.9836e-01,  ..., -8.1952e-01,
          -7.4338e-01, -3.6019e-01],
         [ 8.8005e-01,  6.0271e-01,  1.5659e+00,  ...,  1.6268e+00,
           1.1583e+00,  1.0538e+00],
         [-1.0257e+00, -4.4512e-01, -1.1697e+00,  ..., -1.3291e+00,
          -1.0175e+00, -4.8266e-01],
         ...,
         [ 3.8376e-02, -8.1560e-01, -4.8072e-01,  ..., -3.0548e-01,
          -5.3883e-01, -1.5472e-01],
         [-1.6900e-01, -2.9854e-01,  4.7241e-01,  ...,  6.8731e-02,
           3.5188e-01,  2.5917e-01],
         [-6.3006e-01, -8.9487e-01, -1.8921e+00,  ...,  2.5948e-01,
           3.9551e-01,  2.0193e-01]],

        [[-2.1610e-01, -5.0369e-01,  1.3047e-01,  ..., -8.0171e-01,
          -8.7569e-01, -6.6509e-01],
         [ 6.3628e-01,  1.1730e+00,  8.6118e-01,  ...,  1.0592e+00,
           9.8061e-01,  1.1977e+00],
         [-1.1846e+00,  3.9123e-01,  2.8730e-01,  ..., -9.8085e-01,
          -6.9187e-01, -4.1874e-01],
         ...,
         [-1.0178e-01, -8.8030e-01, -1.4439e-01,  ..., -1.4561e-01,
          -5.0145e-01, -7.1837e-01],
         [ 3.4077e-01,  3.9647e-01,  4.3917e-01,  ...,  1.5933e-01,
           8.2626e-01,  3.8678e-01],
         [-1.4862e-01, -6.5553e-01, -3.4455e-01,  ...,  2.3658e-01,
           6.9119e-02, -7.2881e-02]]], device='cuda:0',
       grad_fn=<PermuteBackward0>)
Tgt: tensor([[  593,  8991,    27,  ...,     2,     2,     2],
        [18562, 50379,    23,  ...,     2,     2,     2],
        [   64,  6184,    15,  ...,     2,     2,     2],
        ...,
        [   64,  2611,    25,  ...,     2,     2,     2],
        [  141,  2481,    25,  ...,     2,     2,     2],
        [   29, 14766, 24629,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[-5.0180e-03,  1.2510e+00, -2.7234e-01,  ...,  2.9363e-01,
          -1.6775e-01, -2.1439e-01],
         [-4.5005e-01,  1.8507e+00, -2.1445e-01,  ..., -1.0690e+00,
           3.3395e-01, -3.3567e-02],
         [-1.4741e+00,  1.6277e+00, -5.5724e-01,  ..., -4.6413e-01,
           6.2295e-01, -2.9852e-01],
         ...,
         [-7.2951e-01,  1.4281e+00,  4.4594e-01,  ..., -1.7848e-01,
           1.8671e-01,  5.2861e-01],
         [-8.2382e-01,  1.3418e+00, -3.3572e-01,  ..., -1.3617e-01,
           3.9398e-01,  5.0392e-01],
         [-2.5843e-01,  1.3762e+00, -2.6082e-01,  ..., -2.5740e-01,
           5.0353e-01,  2.1595e-01]],

        [[ 2.4944e-01,  6.4846e-01, -1.8813e-02,  ...,  9.7328e-02,
           1.5658e-02, -6.6874e-01],
         [-8.6753e-01,  1.1760e+00, -2.4452e-01,  ...,  2.7100e-01,
          -7.1604e-02, -6.1189e-01],
         [-3.3309e-01,  5.9238e-01,  3.3139e-01,  ...,  1.3807e-01,
           1.2344e-01, -6.3538e-01],
         ...,
         [-5.2461e-01,  1.0486e+00, -9.1206e-02,  ..., -3.0337e-01,
           1.7029e-01,  2.6496e-02],
         [-6.2409e-01,  6.1346e-01,  9.3974e-02,  ..., -3.7943e-01,
           4.7841e-01, -9.9242e-02],
         [-3.5655e-01,  8.3498e-01,  4.6313e-02,  ..., -2.7435e-01,
           4.9050e-01,  1.8947e-01]],

        [[-2.6530e-01,  8.3643e-01, -2.1022e-01,  ...,  4.0317e-01,
           1.0935e-02, -9.0957e-01],
         [-2.0121e-01,  7.4314e-01,  2.8493e-01,  ...,  1.2406e-01,
           3.1315e-01, -5.8543e-01],
         [-2.1506e-01,  7.4568e-01,  8.4392e-02,  ..., -6.5719e-01,
           6.4336e-01, -4.9495e-01],
         ...,
         [-1.3359e+00,  8.6493e-01, -1.7414e-01,  ..., -3.7916e-01,
           1.1052e-01,  4.2237e-04],
         [-9.6944e-01,  8.9455e-01,  1.9688e-01,  ...,  1.8075e-01,
           2.6689e-01,  1.5056e-01],
         [-7.0966e-01,  9.0446e-01, -1.1442e-01,  ...,  7.4716e-02,
           1.7978e-01,  2.8958e-01]],

        ...,

        [[ 3.6057e-01,  1.1517e+00, -3.7486e-01,  ...,  2.5406e-01,
          -2.1634e-01, -2.2244e-01],
         [-6.3881e-01,  1.1466e+00, -4.2327e-01,  ..., -1.6940e-02,
           1.7311e-01, -8.5736e-01],
         [ 3.7992e-01,  1.3793e+00,  3.3733e-01,  ..., -7.7573e-01,
          -2.5025e-01, -7.9116e-01],
         ...,
         [-4.0432e-01,  1.4342e+00, -3.4144e-01,  ..., -2.5361e-01,
           4.4894e-01,  1.0315e-01],
         [-7.5443e-01,  1.1025e+00,  1.2270e-01,  ..., -3.1790e-01,
           1.9229e-01,  3.9607e-01],
         [-5.4245e-01,  1.4220e+00,  1.7496e-02,  ..., -2.8511e-01,
           1.0761e-01,  4.2102e-01]],

        [[ 1.8098e-01,  1.4080e+00, -1.2306e-01,  ...,  1.1184e-01,
          -2.2194e-01, -5.9247e-02],
         [-6.6344e-01,  1.5892e+00,  4.4834e-01,  ..., -4.5648e-01,
          -4.8686e-01, -1.1169e+00],
         [ 1.6903e-01,  2.6754e-01,  4.5281e-01,  ..., -3.9835e-01,
          -2.0558e-01, -5.1844e-01],
         ...,
         [-8.5725e-01,  1.5753e+00, -2.5240e-01,  ...,  1.5232e-01,
           2.1927e-01, -3.4785e-01],
         [-9.8697e-02,  1.5477e+00,  1.5031e-02,  ..., -2.5434e-01,
           3.5737e-01,  3.2898e-01],
         [-7.7823e-01,  1.2563e+00, -2.8750e-01,  ..., -8.5552e-02,
          -9.7015e-02,  6.2177e-01]],

        [[ 1.4869e-02,  1.1494e+00, -5.0068e-02,  ...,  3.2754e-01,
           4.1528e-01, -6.9597e-01],
         [-1.6191e-02,  7.5010e-01,  2.0563e-01,  ...,  3.2897e-01,
           5.5030e-01, -2.1303e-02],
         [ 9.6764e-02,  1.2335e+00,  6.2810e-01,  ...,  7.2502e-02,
           4.0706e-02, -7.9009e-01],
         ...,
         [-6.6122e-01,  1.5226e+00, -1.2741e-01,  ...,  3.6974e-01,
           6.1319e-01,  5.1413e-01],
         [-7.5692e-01,  1.3335e+00, -2.4912e-01,  ..., -1.0953e-01,
           2.9798e-01,  3.6354e-01],
         [-6.8413e-01,  1.6733e+00, -4.3249e-01,  ..., -2.9695e-01,
           4.6002e-01,  3.0369e-01]]], device='cuda:0',
       grad_fn=<GatherBackward>)
Tgt: tensor([[    0,    94, 10558,  ...,     2,     2,     2],
        [    0,   209, 13160,  ...,     2,     2,     2],
        [    0, 43287,    84,  ...,     2,     2,     2],
        ...,
        [    0,   209,  4969,  ...,     2,     2,     2],
        [    0,  1354,   303,  ...,     2,     2,     2],
        [    0,   641, 16216,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[-5.0180e-03, -4.5005e-01, -1.4741e+00,  ..., -7.2951e-01,
          -8.2382e-01, -2.5843e-01],
         [ 1.2510e+00,  1.8507e+00,  1.6277e+00,  ...,  1.4281e+00,
           1.3418e+00,  1.3762e+00],
         [-2.7234e-01, -2.1445e-01, -5.5724e-01,  ...,  4.4594e-01,
          -3.3572e-01, -2.6082e-01],
         ...,
         [ 2.9363e-01, -1.0690e+00, -4.6413e-01,  ..., -1.7848e-01,
          -1.3617e-01, -2.5740e-01],
         [-1.6775e-01,  3.3395e-01,  6.2295e-01,  ...,  1.8671e-01,
           3.9398e-01,  5.0353e-01],
         [-2.1439e-01, -3.3567e-02, -2.9852e-01,  ...,  5.2861e-01,
           5.0392e-01,  2.1595e-01]],

        [[ 2.4944e-01, -8.6753e-01, -3.3309e-01,  ..., -5.2461e-01,
          -6.2409e-01, -3.5655e-01],
         [ 6.4846e-01,  1.1760e+00,  5.9238e-01,  ...,  1.0486e+00,
           6.1346e-01,  8.3498e-01],
         [-1.8813e-02, -2.4452e-01,  3.3139e-01,  ..., -9.1206e-02,
           9.3974e-02,  4.6313e-02],
         ...,
         [ 9.7328e-02,  2.7100e-01,  1.3807e-01,  ..., -3.0337e-01,
          -3.7943e-01, -2.7435e-01],
         [ 1.5658e-02, -7.1604e-02,  1.2344e-01,  ...,  1.7029e-01,
           4.7841e-01,  4.9050e-01],
         [-6.6874e-01, -6.1189e-01, -6.3538e-01,  ...,  2.6496e-02,
          -9.9242e-02,  1.8947e-01]],

        [[-2.6530e-01, -2.0121e-01, -2.1506e-01,  ..., -1.3359e+00,
          -9.6944e-01, -7.0966e-01],
         [ 8.3643e-01,  7.4314e-01,  7.4568e-01,  ...,  8.6493e-01,
           8.9455e-01,  9.0446e-01],
         [-2.1022e-01,  2.8493e-01,  8.4392e-02,  ..., -1.7414e-01,
           1.9688e-01, -1.1442e-01],
         ...,
         [ 4.0317e-01,  1.2406e-01, -6.5719e-01,  ..., -3.7916e-01,
           1.8075e-01,  7.4716e-02],
         [ 1.0935e-02,  3.1315e-01,  6.4336e-01,  ...,  1.1052e-01,
           2.6689e-01,  1.7978e-01],
         [-9.0957e-01, -5.8543e-01, -4.9495e-01,  ...,  4.2237e-04,
           1.5056e-01,  2.8958e-01]],

        ...,

        [[ 3.6057e-01, -6.3881e-01,  3.7992e-01,  ..., -4.0432e-01,
          -7.5443e-01, -5.4245e-01],
         [ 1.1517e+00,  1.1466e+00,  1.3793e+00,  ...,  1.4342e+00,
           1.1025e+00,  1.4220e+00],
         [-3.7486e-01, -4.2327e-01,  3.3733e-01,  ..., -3.4144e-01,
           1.2270e-01,  1.7496e-02],
         ...,
         [ 2.5406e-01, -1.6940e-02, -7.7573e-01,  ..., -2.5361e-01,
          -3.1790e-01, -2.8511e-01],
         [-2.1634e-01,  1.7311e-01, -2.5025e-01,  ...,  4.4894e-01,
           1.9229e-01,  1.0761e-01],
         [-2.2244e-01, -8.5736e-01, -7.9116e-01,  ...,  1.0315e-01,
           3.9607e-01,  4.2102e-01]],

        [[ 1.8098e-01, -6.6344e-01,  1.6903e-01,  ..., -8.5725e-01,
          -9.8697e-02, -7.7823e-01],
         [ 1.4080e+00,  1.5892e+00,  2.6754e-01,  ...,  1.5753e+00,
           1.5477e+00,  1.2563e+00],
         [-1.2306e-01,  4.4834e-01,  4.5281e-01,  ..., -2.5240e-01,
           1.5031e-02, -2.8750e-01],
         ...,
         [ 1.1184e-01, -4.5648e-01, -3.9835e-01,  ...,  1.5232e-01,
          -2.5434e-01, -8.5552e-02],
         [-2.2194e-01, -4.8686e-01, -2.0558e-01,  ...,  2.1927e-01,
           3.5737e-01, -9.7015e-02],
         [-5.9247e-02, -1.1169e+00, -5.1844e-01,  ..., -3.4785e-01,
           3.2898e-01,  6.2177e-01]],

        [[ 1.4869e-02, -1.6191e-02,  9.6764e-02,  ..., -6.6122e-01,
          -7.5692e-01, -6.8413e-01],
         [ 1.1494e+00,  7.5010e-01,  1.2335e+00,  ...,  1.5226e+00,
           1.3335e+00,  1.6733e+00],
         [-5.0068e-02,  2.0563e-01,  6.2810e-01,  ..., -1.2741e-01,
          -2.4912e-01, -4.3249e-01],
         ...,
         [ 3.2754e-01,  3.2897e-01,  7.2502e-02,  ...,  3.6974e-01,
          -1.0953e-01, -2.9695e-01],
         [ 4.1528e-01,  5.5030e-01,  4.0706e-02,  ...,  6.1319e-01,
           2.9798e-01,  4.6002e-01],
         [-6.9597e-01, -2.1303e-02, -7.9009e-01,  ...,  5.1413e-01,
           3.6354e-01,  3.0369e-01]]], device='cuda:0',
       grad_fn=<PermuteBackward0>)
Tgt: tensor([[    0,    94, 10558,  ...,     2,     2,     2],
        [    0,   209, 13160,  ...,     2,     2,     2],
        [    0, 43287,    84,  ...,     2,     2,     2],
        ...,
        [    0,   209,  4969,  ...,     2,     2,     2],
        [    0,  1354,   303,  ...,     2,     2,     2],
        [    0,   641, 16216,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[-5.0180e-03, -4.5005e-01, -1.4741e+00,  ..., -7.2951e-01,
          -8.2382e-01, -2.5843e-01],
         [ 1.2510e+00,  1.8507e+00,  1.6277e+00,  ...,  1.4281e+00,
           1.3418e+00,  1.3762e+00],
         [-2.7234e-01, -2.1445e-01, -5.5724e-01,  ...,  4.4594e-01,
          -3.3572e-01, -2.6082e-01],
         ...,
         [ 2.9363e-01, -1.0690e+00, -4.6413e-01,  ..., -1.7848e-01,
          -1.3617e-01, -2.5740e-01],
         [-1.6775e-01,  3.3395e-01,  6.2295e-01,  ...,  1.8671e-01,
           3.9398e-01,  5.0353e-01],
         [-2.1439e-01, -3.3567e-02, -2.9852e-01,  ...,  5.2861e-01,
           5.0392e-01,  2.1595e-01]],

        [[ 2.4944e-01, -8.6753e-01, -3.3309e-01,  ..., -5.2461e-01,
          -6.2409e-01, -3.5655e-01],
         [ 6.4846e-01,  1.1760e+00,  5.9238e-01,  ...,  1.0486e+00,
           6.1346e-01,  8.3498e-01],
         [-1.8813e-02, -2.4452e-01,  3.3139e-01,  ..., -9.1206e-02,
           9.3974e-02,  4.6313e-02],
         ...,
         [ 9.7328e-02,  2.7100e-01,  1.3807e-01,  ..., -3.0337e-01,
          -3.7943e-01, -2.7435e-01],
         [ 1.5658e-02, -7.1604e-02,  1.2344e-01,  ...,  1.7029e-01,
           4.7841e-01,  4.9050e-01],
         [-6.6874e-01, -6.1189e-01, -6.3538e-01,  ...,  2.6496e-02,
          -9.9242e-02,  1.8947e-01]],

        [[-2.6530e-01, -2.0121e-01, -2.1506e-01,  ..., -1.3359e+00,
          -9.6944e-01, -7.0966e-01],
         [ 8.3643e-01,  7.4314e-01,  7.4568e-01,  ...,  8.6493e-01,
           8.9455e-01,  9.0446e-01],
         [-2.1022e-01,  2.8493e-01,  8.4392e-02,  ..., -1.7414e-01,
           1.9688e-01, -1.1442e-01],
         ...,
         [ 4.0317e-01,  1.2406e-01, -6.5719e-01,  ..., -3.7916e-01,
           1.8075e-01,  7.4716e-02],
         [ 1.0935e-02,  3.1315e-01,  6.4336e-01,  ...,  1.1052e-01,
           2.6689e-01,  1.7978e-01],
         [-9.0957e-01, -5.8543e-01, -4.9495e-01,  ...,  4.2237e-04,
           1.5056e-01,  2.8958e-01]],

        ...,

        [[ 3.6057e-01, -6.3881e-01,  3.7992e-01,  ..., -4.0432e-01,
          -7.5443e-01, -5.4245e-01],
         [ 1.1517e+00,  1.1466e+00,  1.3793e+00,  ...,  1.4342e+00,
           1.1025e+00,  1.4220e+00],
         [-3.7486e-01, -4.2327e-01,  3.3733e-01,  ..., -3.4144e-01,
           1.2270e-01,  1.7496e-02],
         ...,
         [ 2.5406e-01, -1.6940e-02, -7.7573e-01,  ..., -2.5361e-01,
          -3.1790e-01, -2.8511e-01],
         [-2.1634e-01,  1.7311e-01, -2.5025e-01,  ...,  4.4894e-01,
           1.9229e-01,  1.0761e-01],
         [-2.2244e-01, -8.5736e-01, -7.9116e-01,  ...,  1.0315e-01,
           3.9607e-01,  4.2102e-01]],

        [[ 1.8098e-01, -6.6344e-01,  1.6903e-01,  ..., -8.5725e-01,
          -9.8697e-02, -7.7823e-01],
         [ 1.4080e+00,  1.5892e+00,  2.6754e-01,  ...,  1.5753e+00,
           1.5477e+00,  1.2563e+00],
         [-1.2306e-01,  4.4834e-01,  4.5281e-01,  ..., -2.5240e-01,
           1.5031e-02, -2.8750e-01],
         ...,
         [ 1.1184e-01, -4.5648e-01, -3.9835e-01,  ...,  1.5232e-01,
          -2.5434e-01, -8.5552e-02],
         [-2.2194e-01, -4.8686e-01, -2.0558e-01,  ...,  2.1927e-01,
           3.5737e-01, -9.7015e-02],
         [-5.9247e-02, -1.1169e+00, -5.1844e-01,  ..., -3.4785e-01,
           3.2898e-01,  6.2177e-01]],

        [[ 1.4869e-02, -1.6191e-02,  9.6764e-02,  ..., -6.6122e-01,
          -7.5692e-01, -6.8413e-01],
         [ 1.1494e+00,  7.5010e-01,  1.2335e+00,  ...,  1.5226e+00,
           1.3335e+00,  1.6733e+00],
         [-5.0068e-02,  2.0563e-01,  6.2810e-01,  ..., -1.2741e-01,
          -2.4912e-01, -4.3249e-01],
         ...,
         [ 3.2754e-01,  3.2897e-01,  7.2502e-02,  ...,  3.6974e-01,
          -1.0953e-01, -2.9695e-01],
         [ 4.1528e-01,  5.5030e-01,  4.0706e-02,  ...,  6.1319e-01,
           2.9798e-01,  4.6002e-01],
         [-6.9597e-01, -2.1303e-02, -7.9009e-01,  ...,  5.1413e-01,
           3.6354e-01,  3.0369e-01]]], device='cuda:0',
       grad_fn=<PermuteBackward0>)
Tgt: tensor([[   94, 10558,    14,  ...,     2,     2,     2],
        [  209, 13160,    14,  ...,     2,     2,     2],
        [43287,    84, 38829,  ...,     2,     2,     2],
        ...,
        [  209,  4969,  1976,  ...,     2,     2,     2],
        [ 1354,   303,  3838,  ...,     2,     2,     2],
        [  641, 16216,    15,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[-0.2278,  0.8474,  0.1625,  ..., -0.0661,  0.2558, -0.7513],
         [-1.5842,  1.3508,  0.1755,  ..., -0.0907,  0.1284, -0.8645],
         [-0.4841,  0.8583,  1.2960,  ..., -0.4930,  0.5900, -0.5593],
         ...,
         [-0.9258,  0.8335,  0.8332,  ..., -0.1529,  0.6186, -0.1129],
         [-0.8318,  1.3145,  0.7758,  ..., -0.6047,  0.5342,  0.0397],
         [-0.7817,  0.6992,  0.7102,  ..., -0.2926,  0.9998, -0.1922]],

        [[-0.1506,  1.0091,  0.2433,  ...,  0.2406,  0.5518, -1.2444],
         [-0.9765,  1.4888,  1.1866,  ...,  0.3522,  0.5702, -1.6266],
         [-0.5972,  1.3712,  1.0047,  ...,  0.2987,  0.4707, -0.7180],
         ...,
         [-1.3293,  1.3796,  0.3806,  ..., -0.0316,  0.8548, -0.5444],
         [-1.3130,  1.2873,  0.3714,  ...,  0.3160,  0.7803, -0.5235],
         [-1.2019,  1.1180,  0.6751,  ..., -0.3024,  1.0510, -0.5159]],

        [[ 0.3108,  0.6836,  0.3346,  ..., -0.0961,  0.0553, -0.9570],
         [-1.0102, -0.1742,  1.5672,  ...,  0.0518, -0.3462, -1.3404],
         [-0.0270,  0.5917,  0.6415,  ..., -0.6749,  0.7147, -0.3926],
         ...,
         [-0.2041,  1.0112,  1.2033,  ..., -0.4152,  0.2880, -0.3071],
         [-0.4512,  1.2256,  1.1301,  ..., -0.6618,  0.3431, -0.1934],
         [-0.4281,  0.8463,  1.5349,  ..., -0.0945,  0.1874,  0.0157]],

        ...,

        [[ 0.0050,  1.0286,  0.1737,  ..., -0.0413, -0.0547, -0.2283],
         [-0.0519,  0.8232,  0.1547,  ..., -0.4567, -0.1276, -0.7886],
         [-0.6386,  0.6702,  0.5111,  ..., -0.3684, -0.0627, -0.2724],
         ...,
         [-0.8578,  1.2943,  0.3906,  ..., -0.2242,  0.0966,  0.1076],
         [-0.9460,  1.1836,  0.5404,  ..., -0.1461,  0.1027,  0.3679],
         [-0.5726,  1.1671,  0.8482,  ...,  0.0689,  0.0306,  0.8262]],

        [[-0.5331,  1.1727,  0.2042,  ...,  0.1905,  0.0877, -0.7790],
         [-0.2908,  0.6635,  0.2233,  ...,  0.2631, -0.0705, -1.0916],
         [-0.1593,  1.6345,  0.9804,  ..., -0.2163,  0.4898, -0.7370],
         ...,
         [-1.0498,  1.1351,  0.4791,  ..., -0.1920,  0.5524, -0.6102],
         [-0.9307,  1.4885,  0.6227,  ...,  0.0483,  0.1872, -0.3799],
         [-0.9072,  1.1363,  0.7308,  ..., -0.3499,  0.8678,  0.2882]],

        [[ 0.3282,  1.0149,  0.6938,  ...,  0.3088,  0.0592, -0.8716],
         [ 0.2097,  1.6663,  1.6757,  ..., -0.3089, -0.1052, -0.7889],
         [ 0.1114,  1.8534,  0.8608,  ..., -0.0237, -0.2492, -0.5555],
         ...,
         [-1.0035,  1.3819,  0.8206,  ...,  0.2009, -0.2605, -0.0862],
         [-0.4231,  0.9832,  1.0863,  ..., -0.2269,  0.0612, -0.3212],
         [-0.2962,  1.2233,  0.9876,  ..., -0.2552,  0.5089,  0.0912]]],
       device='cuda:0', grad_fn=<GatherBackward>)
Tgt: tensor([[    0,  7830, 12849,  ...,     2,     2,     2],
        [    0, 19779,  7960,  ...,     2,     2,     2],
        [    0,    64,   436,  ...,     2,     2,     2],
        ...,
        [    0,   174,   265,  ...,     2,     2,     2],
        [    0,  2120,   789,  ...,     2,     2,     2],
        [    0,   175,    58,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[-0.2278, -1.5842, -0.4841,  ..., -0.9258, -0.8318, -0.7817],
         [ 0.8474,  1.3508,  0.8583,  ...,  0.8335,  1.3145,  0.6992],
         [ 0.1625,  0.1755,  1.2960,  ...,  0.8332,  0.7758,  0.7102],
         ...,
         [-0.0661, -0.0907, -0.4930,  ..., -0.1529, -0.6047, -0.2926],
         [ 0.2558,  0.1284,  0.5900,  ...,  0.6186,  0.5342,  0.9998],
         [-0.7513, -0.8645, -0.5593,  ..., -0.1129,  0.0397, -0.1922]],

        [[-0.1506, -0.9765, -0.5972,  ..., -1.3293, -1.3130, -1.2019],
         [ 1.0091,  1.4888,  1.3712,  ...,  1.3796,  1.2873,  1.1180],
         [ 0.2433,  1.1866,  1.0047,  ...,  0.3806,  0.3714,  0.6751],
         ...,
         [ 0.2406,  0.3522,  0.2987,  ..., -0.0316,  0.3160, -0.3024],
         [ 0.5518,  0.5702,  0.4707,  ...,  0.8548,  0.7803,  1.0510],
         [-1.2444, -1.6266, -0.7180,  ..., -0.5444, -0.5235, -0.5159]],

        [[ 0.3108, -1.0102, -0.0270,  ..., -0.2041, -0.4512, -0.4281],
         [ 0.6836, -0.1742,  0.5917,  ...,  1.0112,  1.2256,  0.8463],
         [ 0.3346,  1.5672,  0.6415,  ...,  1.2033,  1.1301,  1.5349],
         ...,
         [-0.0961,  0.0518, -0.6749,  ..., -0.4152, -0.6618, -0.0945],
         [ 0.0553, -0.3462,  0.7147,  ...,  0.2880,  0.3431,  0.1874],
         [-0.9570, -1.3404, -0.3926,  ..., -0.3071, -0.1934,  0.0157]],

        ...,

        [[ 0.0050, -0.0519, -0.6386,  ..., -0.8578, -0.9460, -0.5726],
         [ 1.0286,  0.8232,  0.6702,  ...,  1.2943,  1.1836,  1.1671],
         [ 0.1737,  0.1547,  0.5111,  ...,  0.3906,  0.5404,  0.8482],
         ...,
         [-0.0413, -0.4567, -0.3684,  ..., -0.2242, -0.1461,  0.0689],
         [-0.0547, -0.1276, -0.0627,  ...,  0.0966,  0.1027,  0.0306],
         [-0.2283, -0.7886, -0.2724,  ...,  0.1076,  0.3679,  0.8262]],

        [[-0.5331, -0.2908, -0.1593,  ..., -1.0498, -0.9307, -0.9072],
         [ 1.1727,  0.6635,  1.6345,  ...,  1.1351,  1.4885,  1.1363],
         [ 0.2042,  0.2233,  0.9804,  ...,  0.4791,  0.6227,  0.7308],
         ...,
         [ 0.1905,  0.2631, -0.2163,  ..., -0.1920,  0.0483, -0.3499],
         [ 0.0877, -0.0705,  0.4898,  ...,  0.5524,  0.1872,  0.8678],
         [-0.7790, -1.0916, -0.7370,  ..., -0.6102, -0.3799,  0.2882]],

        [[ 0.3282,  0.2097,  0.1114,  ..., -1.0035, -0.4231, -0.2962],
         [ 1.0149,  1.6663,  1.8534,  ...,  1.3819,  0.9832,  1.2233],
         [ 0.6938,  1.6757,  0.8608,  ...,  0.8206,  1.0863,  0.9876],
         ...,
         [ 0.3088, -0.3089, -0.0237,  ...,  0.2009, -0.2269, -0.2552],
         [ 0.0592, -0.1052, -0.2492,  ..., -0.2605,  0.0612,  0.5089],
         [-0.8716, -0.7889, -0.5555,  ..., -0.0862, -0.3212,  0.0912]]],
       device='cuda:0', grad_fn=<PermuteBackward0>)
Tgt: tensor([[    0,  7830, 12849,  ...,     2,     2,     2],
        [    0, 19779,  7960,  ...,     2,     2,     2],
        [    0,    64,   436,  ...,     2,     2,     2],
        ...,
        [    0,   174,   265,  ...,     2,     2,     2],
        [    0,  2120,   789,  ...,     2,     2,     2],
        [    0,   175,    58,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[-0.2278, -1.5842, -0.4841,  ..., -0.9258, -0.8318, -0.7817],
         [ 0.8474,  1.3508,  0.8583,  ...,  0.8335,  1.3145,  0.6992],
         [ 0.1625,  0.1755,  1.2960,  ...,  0.8332,  0.7758,  0.7102],
         ...,
         [-0.0661, -0.0907, -0.4930,  ..., -0.1529, -0.6047, -0.2926],
         [ 0.2558,  0.1284,  0.5900,  ...,  0.6186,  0.5342,  0.9998],
         [-0.7513, -0.8645, -0.5593,  ..., -0.1129,  0.0397, -0.1922]],

        [[-0.1506, -0.9765, -0.5972,  ..., -1.3293, -1.3130, -1.2019],
         [ 1.0091,  1.4888,  1.3712,  ...,  1.3796,  1.2873,  1.1180],
         [ 0.2433,  1.1866,  1.0047,  ...,  0.3806,  0.3714,  0.6751],
         ...,
         [ 0.2406,  0.3522,  0.2987,  ..., -0.0316,  0.3160, -0.3024],
         [ 0.5518,  0.5702,  0.4707,  ...,  0.8548,  0.7803,  1.0510],
         [-1.2444, -1.6266, -0.7180,  ..., -0.5444, -0.5235, -0.5159]],

        [[ 0.3108, -1.0102, -0.0270,  ..., -0.2041, -0.4512, -0.4281],
         [ 0.6836, -0.1742,  0.5917,  ...,  1.0112,  1.2256,  0.8463],
         [ 0.3346,  1.5672,  0.6415,  ...,  1.2033,  1.1301,  1.5349],
         ...,
         [-0.0961,  0.0518, -0.6749,  ..., -0.4152, -0.6618, -0.0945],
         [ 0.0553, -0.3462,  0.7147,  ...,  0.2880,  0.3431,  0.1874],
         [-0.9570, -1.3404, -0.3926,  ..., -0.3071, -0.1934,  0.0157]],

        ...,

        [[ 0.0050, -0.0519, -0.6386,  ..., -0.8578, -0.9460, -0.5726],
         [ 1.0286,  0.8232,  0.6702,  ...,  1.2943,  1.1836,  1.1671],
         [ 0.1737,  0.1547,  0.5111,  ...,  0.3906,  0.5404,  0.8482],
         ...,
         [-0.0413, -0.4567, -0.3684,  ..., -0.2242, -0.1461,  0.0689],
         [-0.0547, -0.1276, -0.0627,  ...,  0.0966,  0.1027,  0.0306],
         [-0.2283, -0.7886, -0.2724,  ...,  0.1076,  0.3679,  0.8262]],

        [[-0.5331, -0.2908, -0.1593,  ..., -1.0498, -0.9307, -0.9072],
         [ 1.1727,  0.6635,  1.6345,  ...,  1.1351,  1.4885,  1.1363],
         [ 0.2042,  0.2233,  0.9804,  ...,  0.4791,  0.6227,  0.7308],
         ...,
         [ 0.1905,  0.2631, -0.2163,  ..., -0.1920,  0.0483, -0.3499],
         [ 0.0877, -0.0705,  0.4898,  ...,  0.5524,  0.1872,  0.8678],
         [-0.7790, -1.0916, -0.7370,  ..., -0.6102, -0.3799,  0.2882]],

        [[ 0.3282,  0.2097,  0.1114,  ..., -1.0035, -0.4231, -0.2962],
         [ 1.0149,  1.6663,  1.8534,  ...,  1.3819,  0.9832,  1.2233],
         [ 0.6938,  1.6757,  0.8608,  ...,  0.8206,  1.0863,  0.9876],
         ...,
         [ 0.3088, -0.3089, -0.0237,  ...,  0.2009, -0.2269, -0.2552],
         [ 0.0592, -0.1052, -0.2492,  ..., -0.2605,  0.0612,  0.5089],
         [-0.8716, -0.7889, -0.5555,  ..., -0.0862, -0.3212,  0.0912]]],
       device='cuda:0', grad_fn=<PermuteBackward0>)
Tgt: tensor([[ 7830, 12849,  1019,  ...,     2,     2,     2],
        [19779,  7960,     1,  ...,     2,     2,     2],
        [   64,   436,  7678,  ...,     2,     2,     2],
        ...,
        [  174,   265,   899,  ...,     2,     2,     2],
        [ 2120,   789,     1,  ...,     2,     2,     2],
        [  175,    58,  1416,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[ 8.9818e-01,  1.0841e+00,  1.2691e+00,  ...,  3.5577e-01,
           1.1256e-02, -5.3705e-01],
         [-1.5571e-01,  7.8370e-01,  1.1746e+00,  ..., -3.7621e-01,
           7.0030e-01, -7.6844e-01],
         [-2.0057e-01,  1.2399e+00,  1.0407e+00,  ..., -1.0011e+00,
           9.0846e-01, -8.9945e-01],
         ...,
         [-6.4449e-01,  1.2360e-01,  1.5961e+00,  ..., -6.3850e-01,
          -2.9893e-01, -8.9685e-02],
         [-1.9019e-01,  1.3573e+00,  6.4631e-01,  ..., -3.7595e-02,
          -5.8393e-01, -1.1679e+00],
         [-2.5642e-01,  6.5816e-01,  1.3336e+00,  ..., -1.1356e+00,
          -4.7076e-02, -5.2397e-01]],

        [[ 1.3631e-02,  5.7285e-01,  1.1163e+00,  ...,  2.8299e-01,
          -1.8903e-01, -8.0223e-01],
         [-9.5757e-01,  4.5603e-01,  1.2020e+00,  ..., -3.7519e-01,
          -1.6844e-01, -1.0384e+00],
         [-2.5562e-01,  7.5243e-01,  1.7181e+00,  ..., -9.8653e-01,
           3.8481e-01, -5.2551e-01],
         ...,
         [-5.8119e-01,  1.2007e+00,  1.4898e+00,  ..., -3.7201e-01,
           5.7732e-01, -2.8642e-01],
         [-9.2697e-01,  1.5431e+00,  1.7747e+00,  ..., -4.9597e-01,
           2.9010e-01, -3.0141e-01],
         [-1.0485e+00,  1.5717e+00,  1.9485e+00,  ..., -5.8890e-01,
           2.3552e-01, -1.3928e-01]],

        [[ 2.3343e-01,  1.1542e+00,  6.0677e-01,  ..., -1.5671e-02,
          -2.4839e-01, -2.5190e-01],
         [-5.5499e-01,  8.8889e-01,  1.6805e+00,  ..., -1.0215e-01,
          -2.0535e-02, -9.4020e-01],
         [ 7.4911e-02,  1.0666e+00,  1.2898e+00,  ..., -3.3069e-01,
           1.0825e+00, -5.6220e-01],
         ...,
         [-9.4412e-01,  1.5447e+00,  1.1928e+00,  ..., -2.4766e-01,
          -1.8558e-03,  4.4944e-01],
         [-6.8899e-01,  1.0846e+00,  1.4127e+00,  ..., -5.9057e-01,
           2.1210e-01,  4.0181e-01],
         [-7.8931e-01,  1.0367e+00,  9.8053e-01,  ..., -1.4708e-01,
           6.9612e-01,  2.3635e-01]],

        ...,

        [[-5.7917e-01,  9.0454e-01,  6.7575e-01,  ...,  4.8301e-02,
          -2.0600e-01, -1.1775e+00],
         [-6.0169e-01,  8.9811e-01,  1.2232e+00,  ..., -9.5468e-01,
           8.2574e-01, -8.0897e-01],
         [-4.5372e-01,  7.4191e-01,  1.2778e+00,  ..., -7.9640e-01,
           3.5065e-01, -1.0060e+00],
         ...,
         [-7.7095e-01,  1.0252e+00,  1.5915e+00,  ..., -2.5277e-01,
           6.1760e-01, -3.8686e-01],
         [-8.8644e-01,  1.1545e+00,  1.2042e+00,  ...,  2.0846e-02,
           2.2257e-01, -3.7694e-01],
         [-4.4062e-01,  1.3575e+00,  1.3747e+00,  ..., -5.7567e-01,
           5.0756e-01, -2.7792e-01]],

        [[ 1.5818e-01,  1.0325e+00,  1.0082e+00,  ...,  3.3356e-02,
          -1.9537e-01, -1.0589e+00],
         [-1.3850e+00,  7.2025e-01,  1.5936e+00,  ..., -1.1946e+00,
          -7.4467e-02, -9.5547e-01],
         [-2.5830e-01,  9.5606e-01,  9.3387e-01,  ..., -2.8813e-01,
           2.4371e-01, -4.8048e-01],
         ...,
         [-7.3828e-01,  1.3731e+00,  1.9527e+00,  ...,  2.0121e-01,
           2.9886e-01,  2.3939e-02],
         [-5.0333e-01,  1.2338e+00,  1.6453e+00,  ..., -2.3924e-01,
           5.0957e-01,  1.1186e-01],
         [-2.1231e-01,  1.1211e+00,  1.7263e+00,  ..., -2.7125e-01,
           5.4362e-01,  1.8982e-01]],

        [[ 1.0981e-01,  8.7046e-01,  1.4645e+00,  ..., -3.9193e-01,
           2.3823e-01, -8.0140e-01],
         [-2.1227e-01,  9.1100e-01,  8.4860e-01,  ..., -6.4226e-01,
           6.4114e-01, -3.1998e-01],
         [-4.2444e-01, -2.6867e-02,  3.0152e+00,  ..., -9.5836e-01,
           3.1906e-01,  1.8885e-01],
         ...,
         [-5.2447e-01,  1.2225e+00,  1.8707e+00,  ..., -4.7296e-01,
           3.6121e-01, -2.8376e-02],
         [-9.3160e-01,  1.3365e+00,  1.5723e+00,  ..., -9.2427e-01,
           4.8649e-01,  1.6725e-01],
         [-4.2704e-01,  9.6568e-01,  1.8953e+00,  ..., -4.7298e-01,
           2.4257e-01,  1.1686e-01]]], device='cuda:0',
       grad_fn=<GatherBackward>)
Tgt: tensor([[    0,   174,  1802,  ...,    16,     1,     2],
        [    0,  1894,    14,  ...,     2,     2,     2],
        [    0,    60,  2060,  ...,     2,     2,     2],
        ...,
        [    0, 18648,  1473,  ...,     2,     2,     2],
        [    0,   141,    22,  ...,     2,     2,     2],
        [    0,    84,  9962,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[ 8.9818e-01, -1.5571e-01, -2.0057e-01,  ..., -6.4449e-01,
          -1.9019e-01, -2.5642e-01],
         [ 1.0841e+00,  7.8370e-01,  1.2399e+00,  ...,  1.2360e-01,
           1.3573e+00,  6.5816e-01],
         [ 1.2691e+00,  1.1746e+00,  1.0407e+00,  ...,  1.5961e+00,
           6.4631e-01,  1.3336e+00],
         ...,
         [ 3.5577e-01, -3.7621e-01, -1.0011e+00,  ..., -6.3850e-01,
          -3.7595e-02, -1.1356e+00],
         [ 1.1256e-02,  7.0030e-01,  9.0846e-01,  ..., -2.9893e-01,
          -5.8393e-01, -4.7076e-02],
         [-5.3705e-01, -7.6844e-01, -8.9945e-01,  ..., -8.9685e-02,
          -1.1679e+00, -5.2397e-01]],

        [[ 1.3631e-02, -9.5757e-01, -2.5562e-01,  ..., -5.8119e-01,
          -9.2697e-01, -1.0485e+00],
         [ 5.7285e-01,  4.5603e-01,  7.5243e-01,  ...,  1.2007e+00,
           1.5431e+00,  1.5717e+00],
         [ 1.1163e+00,  1.2020e+00,  1.7181e+00,  ...,  1.4898e+00,
           1.7747e+00,  1.9485e+00],
         ...,
         [ 2.8299e-01, -3.7519e-01, -9.8653e-01,  ..., -3.7201e-01,
          -4.9597e-01, -5.8890e-01],
         [-1.8903e-01, -1.6844e-01,  3.8481e-01,  ...,  5.7732e-01,
           2.9010e-01,  2.3552e-01],
         [-8.0223e-01, -1.0384e+00, -5.2551e-01,  ..., -2.8642e-01,
          -3.0141e-01, -1.3928e-01]],

        [[ 2.3343e-01, -5.5499e-01,  7.4911e-02,  ..., -9.4412e-01,
          -6.8899e-01, -7.8931e-01],
         [ 1.1542e+00,  8.8889e-01,  1.0666e+00,  ...,  1.5447e+00,
           1.0846e+00,  1.0367e+00],
         [ 6.0677e-01,  1.6805e+00,  1.2898e+00,  ...,  1.1928e+00,
           1.4127e+00,  9.8053e-01],
         ...,
         [-1.5671e-02, -1.0215e-01, -3.3069e-01,  ..., -2.4766e-01,
          -5.9057e-01, -1.4708e-01],
         [-2.4839e-01, -2.0535e-02,  1.0825e+00,  ..., -1.8558e-03,
           2.1210e-01,  6.9612e-01],
         [-2.5190e-01, -9.4020e-01, -5.6220e-01,  ...,  4.4944e-01,
           4.0181e-01,  2.3635e-01]],

        ...,

        [[-5.7917e-01, -6.0169e-01, -4.5372e-01,  ..., -7.7095e-01,
          -8.8644e-01, -4.4062e-01],
         [ 9.0454e-01,  8.9811e-01,  7.4191e-01,  ...,  1.0252e+00,
           1.1545e+00,  1.3575e+00],
         [ 6.7575e-01,  1.2232e+00,  1.2778e+00,  ...,  1.5915e+00,
           1.2042e+00,  1.3747e+00],
         ...,
         [ 4.8301e-02, -9.5468e-01, -7.9640e-01,  ..., -2.5277e-01,
           2.0846e-02, -5.7567e-01],
         [-2.0600e-01,  8.2574e-01,  3.5065e-01,  ...,  6.1760e-01,
           2.2257e-01,  5.0756e-01],
         [-1.1775e+00, -8.0897e-01, -1.0060e+00,  ..., -3.8686e-01,
          -3.7694e-01, -2.7792e-01]],

        [[ 1.5818e-01, -1.3850e+00, -2.5830e-01,  ..., -7.3828e-01,
          -5.0333e-01, -2.1231e-01],
         [ 1.0325e+00,  7.2025e-01,  9.5606e-01,  ...,  1.3731e+00,
           1.2338e+00,  1.1211e+00],
         [ 1.0082e+00,  1.5936e+00,  9.3387e-01,  ...,  1.9527e+00,
           1.6453e+00,  1.7263e+00],
         ...,
         [ 3.3356e-02, -1.1946e+00, -2.8813e-01,  ...,  2.0121e-01,
          -2.3924e-01, -2.7125e-01],
         [-1.9537e-01, -7.4467e-02,  2.4371e-01,  ...,  2.9886e-01,
           5.0957e-01,  5.4362e-01],
         [-1.0589e+00, -9.5547e-01, -4.8048e-01,  ...,  2.3939e-02,
           1.1186e-01,  1.8982e-01]],

        [[ 1.0981e-01, -2.1227e-01, -4.2444e-01,  ..., -5.2447e-01,
          -9.3160e-01, -4.2704e-01],
         [ 8.7046e-01,  9.1100e-01, -2.6867e-02,  ...,  1.2225e+00,
           1.3365e+00,  9.6568e-01],
         [ 1.4645e+00,  8.4860e-01,  3.0152e+00,  ...,  1.8707e+00,
           1.5723e+00,  1.8953e+00],
         ...,
         [-3.9193e-01, -6.4226e-01, -9.5836e-01,  ..., -4.7296e-01,
          -9.2427e-01, -4.7298e-01],
         [ 2.3823e-01,  6.4114e-01,  3.1906e-01,  ...,  3.6121e-01,
           4.8649e-01,  2.4257e-01],
         [-8.0140e-01, -3.1998e-01,  1.8885e-01,  ..., -2.8376e-02,
           1.6725e-01,  1.1686e-01]]], device='cuda:0',
       grad_fn=<PermuteBackward0>)
Tgt: tensor([[    0,   174,  1802,  ...,    16,     1,     2],
        [    0,  1894,    14,  ...,     2,     2,     2],
        [    0,    60,  2060,  ...,     2,     2,     2],
        ...,
        [    0, 18648,  1473,  ...,     2,     2,     2],
        [    0,   141,    22,  ...,     2,     2,     2],
        [    0,    84,  9962,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[ 8.9818e-01, -1.5571e-01, -2.0057e-01,  ..., -6.4449e-01,
          -1.9019e-01, -2.5642e-01],
         [ 1.0841e+00,  7.8370e-01,  1.2399e+00,  ...,  1.2360e-01,
           1.3573e+00,  6.5816e-01],
         [ 1.2691e+00,  1.1746e+00,  1.0407e+00,  ...,  1.5961e+00,
           6.4631e-01,  1.3336e+00],
         ...,
         [ 3.5577e-01, -3.7621e-01, -1.0011e+00,  ..., -6.3850e-01,
          -3.7595e-02, -1.1356e+00],
         [ 1.1256e-02,  7.0030e-01,  9.0846e-01,  ..., -2.9893e-01,
          -5.8393e-01, -4.7076e-02],
         [-5.3705e-01, -7.6844e-01, -8.9945e-01,  ..., -8.9685e-02,
          -1.1679e+00, -5.2397e-01]],

        [[ 1.3631e-02, -9.5757e-01, -2.5562e-01,  ..., -5.8119e-01,
          -9.2697e-01, -1.0485e+00],
         [ 5.7285e-01,  4.5603e-01,  7.5243e-01,  ...,  1.2007e+00,
           1.5431e+00,  1.5717e+00],
         [ 1.1163e+00,  1.2020e+00,  1.7181e+00,  ...,  1.4898e+00,
           1.7747e+00,  1.9485e+00],
         ...,
         [ 2.8299e-01, -3.7519e-01, -9.8653e-01,  ..., -3.7201e-01,
          -4.9597e-01, -5.8890e-01],
         [-1.8903e-01, -1.6844e-01,  3.8481e-01,  ...,  5.7732e-01,
           2.9010e-01,  2.3552e-01],
         [-8.0223e-01, -1.0384e+00, -5.2551e-01,  ..., -2.8642e-01,
          -3.0141e-01, -1.3928e-01]],

        [[ 2.3343e-01, -5.5499e-01,  7.4911e-02,  ..., -9.4412e-01,
          -6.8899e-01, -7.8931e-01],
         [ 1.1542e+00,  8.8889e-01,  1.0666e+00,  ...,  1.5447e+00,
           1.0846e+00,  1.0367e+00],
         [ 6.0677e-01,  1.6805e+00,  1.2898e+00,  ...,  1.1928e+00,
           1.4127e+00,  9.8053e-01],
         ...,
         [-1.5671e-02, -1.0215e-01, -3.3069e-01,  ..., -2.4766e-01,
          -5.9057e-01, -1.4708e-01],
         [-2.4839e-01, -2.0535e-02,  1.0825e+00,  ..., -1.8558e-03,
           2.1210e-01,  6.9612e-01],
         [-2.5190e-01, -9.4020e-01, -5.6220e-01,  ...,  4.4944e-01,
           4.0181e-01,  2.3635e-01]],

        ...,

        [[-5.7917e-01, -6.0169e-01, -4.5372e-01,  ..., -7.7095e-01,
          -8.8644e-01, -4.4062e-01],
         [ 9.0454e-01,  8.9811e-01,  7.4191e-01,  ...,  1.0252e+00,
           1.1545e+00,  1.3575e+00],
         [ 6.7575e-01,  1.2232e+00,  1.2778e+00,  ...,  1.5915e+00,
           1.2042e+00,  1.3747e+00],
         ...,
         [ 4.8301e-02, -9.5468e-01, -7.9640e-01,  ..., -2.5277e-01,
           2.0846e-02, -5.7567e-01],
         [-2.0600e-01,  8.2574e-01,  3.5065e-01,  ...,  6.1760e-01,
           2.2257e-01,  5.0756e-01],
         [-1.1775e+00, -8.0897e-01, -1.0060e+00,  ..., -3.8686e-01,
          -3.7694e-01, -2.7792e-01]],

        [[ 1.5818e-01, -1.3850e+00, -2.5830e-01,  ..., -7.3828e-01,
          -5.0333e-01, -2.1231e-01],
         [ 1.0325e+00,  7.2025e-01,  9.5606e-01,  ...,  1.3731e+00,
           1.2338e+00,  1.1211e+00],
         [ 1.0082e+00,  1.5936e+00,  9.3387e-01,  ...,  1.9527e+00,
           1.6453e+00,  1.7263e+00],
         ...,
         [ 3.3356e-02, -1.1946e+00, -2.8813e-01,  ...,  2.0121e-01,
          -2.3924e-01, -2.7125e-01],
         [-1.9537e-01, -7.4467e-02,  2.4371e-01,  ...,  2.9886e-01,
           5.0957e-01,  5.4362e-01],
         [-1.0589e+00, -9.5547e-01, -4.8048e-01,  ...,  2.3939e-02,
           1.1186e-01,  1.8982e-01]],

        [[ 1.0981e-01, -2.1227e-01, -4.2444e-01,  ..., -5.2447e-01,
          -9.3160e-01, -4.2704e-01],
         [ 8.7046e-01,  9.1100e-01, -2.6867e-02,  ...,  1.2225e+00,
           1.3365e+00,  9.6568e-01],
         [ 1.4645e+00,  8.4860e-01,  3.0152e+00,  ...,  1.8707e+00,
           1.5723e+00,  1.8953e+00],
         ...,
         [-3.9193e-01, -6.4226e-01, -9.5836e-01,  ..., -4.7296e-01,
          -9.2427e-01, -4.7298e-01],
         [ 2.3823e-01,  6.4114e-01,  3.1906e-01,  ...,  3.6121e-01,
           4.8649e-01,  2.4257e-01],
         [-8.0140e-01, -3.1998e-01,  1.8885e-01,  ..., -2.8376e-02,
           1.6725e-01,  1.1686e-01]]], device='cuda:0',
       grad_fn=<PermuteBackward0>)
Tgt: tensor([[  174,  1802,    15,  ...,    16,     1,     2],
        [ 1894,    14,   160,  ...,     2,     2,     2],
        [   60,  2060,    28,  ...,     2,     2,     2],
        ...,
        [18648,  1473,     1,  ...,     2,     2,     2],
        [  141,    22, 12790,  ...,     2,     2,     2],
        [   84,  9962,   674,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[-2.9872e-01,  1.3150e+00,  1.3897e+00,  ..., -2.0300e-03,
           7.1295e-02, -6.1480e-01],
         [-8.6887e-01,  1.4611e+00,  1.6030e+00,  ..., -3.7456e-01,
           1.3266e-01, -9.7267e-01],
         [-1.5806e+00,  8.4903e-01,  1.5881e+00,  ..., -1.6763e-01,
          -1.1950e+00, -8.2982e-01],
         ...,
         [-9.8353e-01,  1.4964e+00,  2.2228e+00,  ..., -3.6599e-01,
           3.1737e-01, -1.5202e-01],
         [-5.5969e-01,  1.4579e+00,  2.2904e+00,  ..., -3.6315e-01,
           3.9964e-01,  1.4884e-01],
         [-8.6832e-01,  1.4554e+00,  1.9847e+00,  ..., -4.1775e-01,
           4.2639e-01,  2.2397e-01]],

        [[-6.1631e-01,  1.0513e+00,  1.8046e+00,  ...,  1.0322e-01,
           7.7734e-02, -1.0906e+00],
         [-1.4955e+00,  5.4616e-01,  2.1700e+00,  ..., -2.1440e-01,
           8.0153e-01, -1.2038e+00],
         [-8.9019e-01,  1.1626e+00,  2.4475e+00,  ..., -3.1013e-01,
           1.4306e-01, -1.0129e+00],
         ...,
         [-1.0355e+00,  1.1371e+00,  2.5208e+00,  ..., -1.5108e-01,
           2.1612e-01, -3.5062e-01],
         [-1.2044e+00,  1.6680e+00,  2.7676e+00,  ..., -2.5830e-01,
           2.4694e-01, -9.2543e-01],
         [-1.0688e+00,  1.5720e+00,  2.6805e+00,  ..., -7.2443e-02,
           4.7250e-01, -4.8836e-01]],

        [[ 3.0832e-01,  1.3011e+00,  1.4052e+00,  ..., -4.8759e-01,
          -1.0156e-01, -6.7880e-01],
         [-1.8086e-01,  1.3739e+00,  1.3631e+00,  ..., -1.1536e+00,
           7.8705e-02, -5.3673e-01],
         [-2.5356e-01,  2.0074e-01,  1.8242e+00,  ..., -8.6051e-01,
           5.6267e-01,  6.0822e-01],
         ...,
         [-4.7481e-01,  1.2566e+00,  2.6568e+00,  ..., -8.8671e-01,
           2.7409e-01,  6.3730e-02],
         [-7.4381e-01,  1.4266e+00,  2.5615e+00,  ..., -5.3070e-01,
           1.3000e-01,  2.2058e-01],
         [-6.6594e-01,  1.4554e+00,  2.6538e+00,  ..., -4.3167e-01,
           2.4927e-01, -1.5663e-01]],

        ...,

        [[ 4.6351e-01,  1.4829e+00,  1.7625e+00,  ..., -2.2346e-01,
           3.3621e-02, -4.8746e-01],
         [-3.6271e-01,  8.8658e-01,  8.3426e-01,  ...,  4.4011e-02,
           1.6181e-01, -7.1713e-01],
         [-3.1792e-01,  1.4299e+00,  2.8366e+00,  ...,  2.6254e-01,
           3.0422e-01, -7.2990e-01],
         ...,
         [-4.9479e-01,  1.9355e+00,  2.3997e+00,  ...,  6.3272e-02,
           2.1437e-01, -2.3945e-01],
         [-8.0981e-01,  1.2290e+00,  2.4837e+00,  ..., -5.7626e-01,
           1.2750e-01, -1.0415e-01],
         [-7.5467e-01,  1.4647e+00,  2.9466e+00,  ..., -2.7907e-01,
           3.0473e-01,  7.1135e-03]],

        [[ 1.0685e-01,  9.9386e-01,  2.0801e+00,  ...,  2.5058e-01,
           4.9441e-02, -3.8833e-01],
         [-4.9743e-01,  7.8576e-01,  2.6977e+00,  ..., -7.2974e-01,
          -9.7416e-02, -1.0847e+00],
         [-9.8380e-01,  8.3298e-01,  3.1587e+00,  ..., -2.5318e-01,
          -6.4478e-02, -1.0671e+00],
         ...,
         [-6.5158e-01,  1.5402e+00,  2.9172e+00,  ..., -1.9381e-01,
          -4.6535e-02,  2.5494e-01],
         [-1.0615e+00,  8.4654e-01,  2.7563e+00,  ..., -1.8008e-01,
           1.0470e-01,  2.0006e-01],
         [-7.0732e-01,  1.0637e+00,  2.7687e+00,  ..., -2.7281e-01,
          -7.2721e-02,  4.6914e-01]],

        [[ 8.0785e-02,  1.1701e+00,  1.2294e+00,  ...,  1.9701e-02,
          -2.4804e-01, -1.0581e+00],
         [-7.4479e-01,  9.7386e-01,  1.4225e+00,  ..., -8.8068e-02,
           6.1239e-02, -3.7930e-01],
         [-5.3537e-01,  1.2288e+00,  1.7108e+00,  ..., -5.4916e-01,
           6.1004e-01, -8.4941e-01],
         ...,
         [-4.6145e-01,  1.4618e+00,  2.5914e+00,  ..., -3.0611e-01,
           2.7720e-01, -3.1426e-01],
         [-5.1252e-01,  1.4269e+00,  2.6207e+00,  ...,  1.1912e-03,
           2.8620e-01, -1.5969e-01],
         [-3.1030e-01,  1.8846e+00,  2.9225e+00,  ..., -3.5021e-01,
           5.2891e-01, -6.2363e-02]]], device='cuda:0',
       grad_fn=<GatherBackward>)
Tgt: tensor([[   0, 2228,   34,  ...,    2,    2,    2],
        [   0, 9763,  124,  ...,    2,    2,    2],
        [   0, 1003,  670,  ...,    2,    2,    2],
        ...,
        [   0, 4243, 4167,  ...,    2,    2,    2],
        [   0,   29,   64,  ...,    2,    2,    2],
        [   0,   55,  127,  ...,    2,    2,    2]], device='cuda:0')
Output: tensor([[[-2.9872e-01, -8.6887e-01, -1.5806e+00,  ..., -9.8353e-01,
          -5.5969e-01, -8.6832e-01],
         [ 1.3150e+00,  1.4611e+00,  8.4903e-01,  ...,  1.4964e+00,
           1.4579e+00,  1.4554e+00],
         [ 1.3897e+00,  1.6030e+00,  1.5881e+00,  ...,  2.2228e+00,
           2.2904e+00,  1.9847e+00],
         ...,
         [-2.0300e-03, -3.7456e-01, -1.6763e-01,  ..., -3.6599e-01,
          -3.6315e-01, -4.1775e-01],
         [ 7.1295e-02,  1.3266e-01, -1.1950e+00,  ...,  3.1737e-01,
           3.9964e-01,  4.2639e-01],
         [-6.1480e-01, -9.7267e-01, -8.2982e-01,  ..., -1.5202e-01,
           1.4884e-01,  2.2397e-01]],

        [[-6.1631e-01, -1.4955e+00, -8.9019e-01,  ..., -1.0355e+00,
          -1.2044e+00, -1.0688e+00],
         [ 1.0513e+00,  5.4616e-01,  1.1626e+00,  ...,  1.1371e+00,
           1.6680e+00,  1.5720e+00],
         [ 1.8046e+00,  2.1700e+00,  2.4475e+00,  ...,  2.5208e+00,
           2.7676e+00,  2.6805e+00],
         ...,
         [ 1.0322e-01, -2.1440e-01, -3.1013e-01,  ..., -1.5108e-01,
          -2.5830e-01, -7.2443e-02],
         [ 7.7734e-02,  8.0153e-01,  1.4306e-01,  ...,  2.1612e-01,
           2.4694e-01,  4.7250e-01],
         [-1.0906e+00, -1.2038e+00, -1.0129e+00,  ..., -3.5062e-01,
          -9.2543e-01, -4.8836e-01]],

        [[ 3.0832e-01, -1.8086e-01, -2.5356e-01,  ..., -4.7481e-01,
          -7.4381e-01, -6.6594e-01],
         [ 1.3011e+00,  1.3739e+00,  2.0074e-01,  ...,  1.2566e+00,
           1.4266e+00,  1.4554e+00],
         [ 1.4052e+00,  1.3631e+00,  1.8242e+00,  ...,  2.6568e+00,
           2.5615e+00,  2.6538e+00],
         ...,
         [-4.8759e-01, -1.1536e+00, -8.6051e-01,  ..., -8.8671e-01,
          -5.3070e-01, -4.3167e-01],
         [-1.0156e-01,  7.8705e-02,  5.6267e-01,  ...,  2.7409e-01,
           1.3000e-01,  2.4927e-01],
         [-6.7880e-01, -5.3673e-01,  6.0822e-01,  ...,  6.3730e-02,
           2.2058e-01, -1.5663e-01]],

        ...,

        [[ 4.6351e-01, -3.6271e-01, -3.1792e-01,  ..., -4.9479e-01,
          -8.0981e-01, -7.5467e-01],
         [ 1.4829e+00,  8.8658e-01,  1.4299e+00,  ...,  1.9355e+00,
           1.2290e+00,  1.4647e+00],
         [ 1.7625e+00,  8.3426e-01,  2.8366e+00,  ...,  2.3997e+00,
           2.4837e+00,  2.9466e+00],
         ...,
         [-2.2346e-01,  4.4011e-02,  2.6254e-01,  ...,  6.3272e-02,
          -5.7626e-01, -2.7907e-01],
         [ 3.3621e-02,  1.6181e-01,  3.0422e-01,  ...,  2.1437e-01,
           1.2750e-01,  3.0473e-01],
         [-4.8746e-01, -7.1713e-01, -7.2990e-01,  ..., -2.3945e-01,
          -1.0415e-01,  7.1135e-03]],

        [[ 1.0685e-01, -4.9743e-01, -9.8380e-01,  ..., -6.5158e-01,
          -1.0615e+00, -7.0732e-01],
         [ 9.9386e-01,  7.8576e-01,  8.3298e-01,  ...,  1.5402e+00,
           8.4654e-01,  1.0637e+00],
         [ 2.0801e+00,  2.6977e+00,  3.1587e+00,  ...,  2.9172e+00,
           2.7563e+00,  2.7687e+00],
         ...,
         [ 2.5058e-01, -7.2974e-01, -2.5318e-01,  ..., -1.9381e-01,
          -1.8008e-01, -2.7281e-01],
         [ 4.9441e-02, -9.7416e-02, -6.4478e-02,  ..., -4.6535e-02,
           1.0470e-01, -7.2721e-02],
         [-3.8833e-01, -1.0847e+00, -1.0671e+00,  ...,  2.5494e-01,
           2.0006e-01,  4.6914e-01]],

        [[ 8.0785e-02, -7.4479e-01, -5.3537e-01,  ..., -4.6145e-01,
          -5.1252e-01, -3.1030e-01],
         [ 1.1701e+00,  9.7386e-01,  1.2288e+00,  ...,  1.4618e+00,
           1.4269e+00,  1.8846e+00],
         [ 1.2294e+00,  1.4225e+00,  1.7108e+00,  ...,  2.5914e+00,
           2.6207e+00,  2.9225e+00],
         ...,
         [ 1.9701e-02, -8.8068e-02, -5.4916e-01,  ..., -3.0611e-01,
           1.1912e-03, -3.5021e-01],
         [-2.4804e-01,  6.1239e-02,  6.1004e-01,  ...,  2.7720e-01,
           2.8620e-01,  5.2891e-01],
         [-1.0581e+00, -3.7930e-01, -8.4941e-01,  ..., -3.1426e-01,
          -1.5969e-01, -6.2363e-02]]], device='cuda:0',
       grad_fn=<PermuteBackward0>)
Tgt: tensor([[   0, 2228,   34,  ...,    2,    2,    2],
        [   0, 9763,  124,  ...,    2,    2,    2],
        [   0, 1003,  670,  ...,    2,    2,    2],
        ...,
        [   0, 4243, 4167,  ...,    2,    2,    2],
        [   0,   29,   64,  ...,    2,    2,    2],
        [   0,   55,  127,  ...,    2,    2,    2]], device='cuda:0')
Output: tensor([[[-2.9872e-01, -8.6887e-01, -1.5806e+00,  ..., -9.8353e-01,
          -5.5969e-01, -8.6832e-01],
         [ 1.3150e+00,  1.4611e+00,  8.4903e-01,  ...,  1.4964e+00,
           1.4579e+00,  1.4554e+00],
         [ 1.3897e+00,  1.6030e+00,  1.5881e+00,  ...,  2.2228e+00,
           2.2904e+00,  1.9847e+00],
         ...,
         [-2.0300e-03, -3.7456e-01, -1.6763e-01,  ..., -3.6599e-01,
          -3.6315e-01, -4.1775e-01],
         [ 7.1295e-02,  1.3266e-01, -1.1950e+00,  ...,  3.1737e-01,
           3.9964e-01,  4.2639e-01],
         [-6.1480e-01, -9.7267e-01, -8.2982e-01,  ..., -1.5202e-01,
           1.4884e-01,  2.2397e-01]],

        [[-6.1631e-01, -1.4955e+00, -8.9019e-01,  ..., -1.0355e+00,
          -1.2044e+00, -1.0688e+00],
         [ 1.0513e+00,  5.4616e-01,  1.1626e+00,  ...,  1.1371e+00,
           1.6680e+00,  1.5720e+00],
         [ 1.8046e+00,  2.1700e+00,  2.4475e+00,  ...,  2.5208e+00,
           2.7676e+00,  2.6805e+00],
         ...,
         [ 1.0322e-01, -2.1440e-01, -3.1013e-01,  ..., -1.5108e-01,
          -2.5830e-01, -7.2443e-02],
         [ 7.7734e-02,  8.0153e-01,  1.4306e-01,  ...,  2.1612e-01,
           2.4694e-01,  4.7250e-01],
         [-1.0906e+00, -1.2038e+00, -1.0129e+00,  ..., -3.5062e-01,
          -9.2543e-01, -4.8836e-01]],

        [[ 3.0832e-01, -1.8086e-01, -2.5356e-01,  ..., -4.7481e-01,
          -7.4381e-01, -6.6594e-01],
         [ 1.3011e+00,  1.3739e+00,  2.0074e-01,  ...,  1.2566e+00,
           1.4266e+00,  1.4554e+00],
         [ 1.4052e+00,  1.3631e+00,  1.8242e+00,  ...,  2.6568e+00,
           2.5615e+00,  2.6538e+00],
         ...,
         [-4.8759e-01, -1.1536e+00, -8.6051e-01,  ..., -8.8671e-01,
          -5.3070e-01, -4.3167e-01],
         [-1.0156e-01,  7.8705e-02,  5.6267e-01,  ...,  2.7409e-01,
           1.3000e-01,  2.4927e-01],
         [-6.7880e-01, -5.3673e-01,  6.0822e-01,  ...,  6.3730e-02,
           2.2058e-01, -1.5663e-01]],

        ...,

        [[ 4.6351e-01, -3.6271e-01, -3.1792e-01,  ..., -4.9479e-01,
          -8.0981e-01, -7.5467e-01],
         [ 1.4829e+00,  8.8658e-01,  1.4299e+00,  ...,  1.9355e+00,
           1.2290e+00,  1.4647e+00],
         [ 1.7625e+00,  8.3426e-01,  2.8366e+00,  ...,  2.3997e+00,
           2.4837e+00,  2.9466e+00],
         ...,
         [-2.2346e-01,  4.4011e-02,  2.6254e-01,  ...,  6.3272e-02,
          -5.7626e-01, -2.7907e-01],
         [ 3.3621e-02,  1.6181e-01,  3.0422e-01,  ...,  2.1437e-01,
           1.2750e-01,  3.0473e-01],
         [-4.8746e-01, -7.1713e-01, -7.2990e-01,  ..., -2.3945e-01,
          -1.0415e-01,  7.1135e-03]],

        [[ 1.0685e-01, -4.9743e-01, -9.8380e-01,  ..., -6.5158e-01,
          -1.0615e+00, -7.0732e-01],
         [ 9.9386e-01,  7.8576e-01,  8.3298e-01,  ...,  1.5402e+00,
           8.4654e-01,  1.0637e+00],
         [ 2.0801e+00,  2.6977e+00,  3.1587e+00,  ...,  2.9172e+00,
           2.7563e+00,  2.7687e+00],
         ...,
         [ 2.5058e-01, -7.2974e-01, -2.5318e-01,  ..., -1.9381e-01,
          -1.8008e-01, -2.7281e-01],
         [ 4.9441e-02, -9.7416e-02, -6.4478e-02,  ..., -4.6535e-02,
           1.0470e-01, -7.2721e-02],
         [-3.8833e-01, -1.0847e+00, -1.0671e+00,  ...,  2.5494e-01,
           2.0006e-01,  4.6914e-01]],

        [[ 8.0785e-02, -7.4479e-01, -5.3537e-01,  ..., -4.6145e-01,
          -5.1252e-01, -3.1030e-01],
         [ 1.1701e+00,  9.7386e-01,  1.2288e+00,  ...,  1.4618e+00,
           1.4269e+00,  1.8846e+00],
         [ 1.2294e+00,  1.4225e+00,  1.7108e+00,  ...,  2.5914e+00,
           2.6207e+00,  2.9225e+00],
         ...,
         [ 1.9701e-02, -8.8068e-02, -5.4916e-01,  ..., -3.0611e-01,
           1.1912e-03, -3.5021e-01],
         [-2.4804e-01,  6.1239e-02,  6.1004e-01,  ...,  2.7720e-01,
           2.8620e-01,  5.2891e-01],
         [-1.0581e+00, -3.7930e-01, -8.4941e-01,  ..., -3.1426e-01,
          -1.5969e-01, -6.2363e-02]]], device='cuda:0',
       grad_fn=<PermuteBackward0>)
Tgt: tensor([[2228,   34, 2495,  ...,    2,    2,    2],
        [9763,  124,   43,  ...,    2,    2,    2],
        [1003,  670,   27,  ...,    2,    2,    2],
        ...,
        [4243, 4167,   38,  ...,    2,    2,    2],
        [  29,   64, 3188,  ...,    2,    2,    2],
        [  55,  127,   34,  ...,    2,    2,    2]], device='cuda:0')
Output: tensor([[[ 0.3206,  1.1444,  2.2487,  ..., -0.0409,  0.1848, -0.9656],
         [-0.3445,  2.1292,  2.3180,  ..., -1.0578, -0.3028, -0.9367],
         [-0.4486,  1.7217,  2.8174,  ..., -0.2847,  0.1875, -0.6652],
         ...,
         [-1.1226,  1.1433,  3.7099,  ..., -0.4434,  0.0083, -0.2732],
         [-0.4996,  1.6933,  3.4756,  ..., -0.4107,  0.2357, -0.1419],
         [-0.3875,  1.3189,  3.4435,  ..., -0.5727,  0.3216, -0.4459]],

        [[-0.2980,  0.9132,  2.4306,  ...,  0.1856, -0.1999, -0.9531],
         [-1.2453,  0.9304,  2.2513,  ..., -0.3081, -0.7899, -1.2495],
         [-0.3615,  1.1436,  1.6983,  ..., -0.4969,  0.4774, -0.8960],
         ...,
         [-1.3847,  0.9170,  3.0592,  ..., -0.1322,  0.5207, -0.6183],
         [-1.0929,  0.9432,  3.3376,  ..., -0.0786,  0.2559, -0.1787],
         [-0.7200,  1.5044,  3.3420,  ..., -0.5253,  0.5553, -0.4220]],

        [[ 0.0451,  1.2160,  2.2268,  ..., -0.1510, -0.4144, -0.5479],
         [-1.1112,  0.7003,  1.7039,  ..., -0.4479,  0.0746,  0.1707],
         [-0.1294,  1.8915,  2.3779,  ..., -1.3714,  1.1642, -0.3078],
         ...,
         [-0.5109,  0.9360,  3.5728,  ..., -0.3917,  0.2707, -0.0846],
         [-0.7490,  1.1902,  3.5229,  ..., -0.6839, -0.0515,  0.0337],
         [-0.7632,  1.1327,  3.4473,  ..., -0.7698,  0.2017,  0.0079]],

        ...,

        [[ 0.2649,  1.1844,  2.1983,  ..., -0.1451,  0.0351, -0.5347],
         [-0.3761,  1.0453,  1.6574,  ..., -0.3419, -0.3911, -0.1465],
         [ 0.2998,  1.0784,  3.0317,  ..., -0.0904, -0.8003, -1.0388],
         ...,
         [-0.7229,  1.2259,  3.2021,  ..., -0.1251, -0.0946, -0.2059],
         [-0.5252,  0.8452,  2.9767,  ..., -0.2554,  0.0797, -0.2887],
         [-0.7926,  1.1975,  3.3607,  ..., -0.3478,  0.3755,  0.1961]],

        [[ 0.1467,  1.0534,  2.3788,  ..., -0.0273,  0.5600, -1.0684],
         [-0.3614,  0.4325,  3.3666,  ..., -0.0109, -0.3149, -1.6313],
         [-0.3768,  0.6066,  2.2128,  ..., -0.2125, -0.0572, -1.8653],
         ...,
         [-0.4926,  1.0773,  3.7054,  ..., -0.3358,  0.2262, -0.3412],
         [-0.6346,  1.1016,  3.4907,  ..., -0.3237,  0.1822, -0.4768],
         [-0.7058,  1.0778,  3.8645,  ..., -0.5333,  0.1698, -0.2469]],

        [[-0.3608,  1.5115,  2.2990,  ..., -0.2065, -0.3301, -1.2776],
         [-1.3839,  1.4372,  2.0305,  ..., -0.3550,  0.5000, -1.8373],
         [-0.3150,  1.1227,  2.3033,  ..., -1.3923, -0.1440, -1.7955],
         ...,
         [-1.0905,  1.8429,  3.1809,  ..., -0.7365,  0.0873, -0.2454],
         [-1.1138,  1.6409,  3.3736,  ..., -0.5206,  0.4169, -0.7852],
         [-0.9917,  1.3859,  3.2354,  ..., -0.1767,  0.5278, -0.4009]]],
       device='cuda:0', grad_fn=<GatherBackward>)
Tgt: tensor([[    0,    94,  1455,  ...,     2,     2,     2],
        [    0,    34,    17,  ...,     2,     2,     2],
        [    0,   262,   244,  ...,     2,     2,     2],
        ...,
        [    0,  1925,    67,  ...,     2,     2,     2],
        [    0,    64, 13701,  ...,     2,     2,     2],
        [    0,  1770,     1,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[ 0.3206, -0.3445, -0.4486,  ..., -1.1226, -0.4996, -0.3875],
         [ 1.1444,  2.1292,  1.7217,  ...,  1.1433,  1.6933,  1.3189],
         [ 2.2487,  2.3180,  2.8174,  ...,  3.7099,  3.4756,  3.4435],
         ...,
         [-0.0409, -1.0578, -0.2847,  ..., -0.4434, -0.4107, -0.5727],
         [ 0.1848, -0.3028,  0.1875,  ...,  0.0083,  0.2357,  0.3216],
         [-0.9656, -0.9367, -0.6652,  ..., -0.2732, -0.1419, -0.4459]],

        [[-0.2980, -1.2453, -0.3615,  ..., -1.3847, -1.0929, -0.7200],
         [ 0.9132,  0.9304,  1.1436,  ...,  0.9170,  0.9432,  1.5044],
         [ 2.4306,  2.2513,  1.6983,  ...,  3.0592,  3.3376,  3.3420],
         ...,
         [ 0.1856, -0.3081, -0.4969,  ..., -0.1322, -0.0786, -0.5253],
         [-0.1999, -0.7899,  0.4774,  ...,  0.5207,  0.2559,  0.5553],
         [-0.9531, -1.2495, -0.8960,  ..., -0.6183, -0.1787, -0.4220]],

        [[ 0.0451, -1.1112, -0.1294,  ..., -0.5109, -0.7490, -0.7632],
         [ 1.2160,  0.7003,  1.8915,  ...,  0.9360,  1.1902,  1.1327],
         [ 2.2268,  1.7039,  2.3779,  ...,  3.5728,  3.5229,  3.4473],
         ...,
         [-0.1510, -0.4479, -1.3714,  ..., -0.3917, -0.6839, -0.7698],
         [-0.4144,  0.0746,  1.1642,  ...,  0.2707, -0.0515,  0.2017],
         [-0.5479,  0.1707, -0.3078,  ..., -0.0846,  0.0337,  0.0079]],

        ...,

        [[ 0.2649, -0.3761,  0.2998,  ..., -0.7229, -0.5252, -0.7926],
         [ 1.1844,  1.0453,  1.0784,  ...,  1.2259,  0.8452,  1.1975],
         [ 2.1983,  1.6574,  3.0317,  ...,  3.2021,  2.9767,  3.3607],
         ...,
         [-0.1451, -0.3419, -0.0904,  ..., -0.1251, -0.2554, -0.3478],
         [ 0.0351, -0.3911, -0.8003,  ..., -0.0946,  0.0797,  0.3755],
         [-0.5347, -0.1465, -1.0388,  ..., -0.2059, -0.2887,  0.1961]],

        [[ 0.1467, -0.3614, -0.3768,  ..., -0.4926, -0.6346, -0.7058],
         [ 1.0534,  0.4325,  0.6066,  ...,  1.0773,  1.1016,  1.0778],
         [ 2.3788,  3.3666,  2.2128,  ...,  3.7054,  3.4907,  3.8645],
         ...,
         [-0.0273, -0.0109, -0.2125,  ..., -0.3358, -0.3237, -0.5333],
         [ 0.5600, -0.3149, -0.0572,  ...,  0.2262,  0.1822,  0.1698],
         [-1.0684, -1.6313, -1.8653,  ..., -0.3412, -0.4768, -0.2469]],

        [[-0.3608, -1.3839, -0.3150,  ..., -1.0905, -1.1138, -0.9917],
         [ 1.5115,  1.4372,  1.1227,  ...,  1.8429,  1.6409,  1.3859],
         [ 2.2990,  2.0305,  2.3033,  ...,  3.1809,  3.3736,  3.2354],
         ...,
         [-0.2065, -0.3550, -1.3923,  ..., -0.7365, -0.5206, -0.1767],
         [-0.3301,  0.5000, -0.1440,  ...,  0.0873,  0.4169,  0.5278],
         [-1.2776, -1.8373, -1.7955,  ..., -0.2454, -0.7852, -0.4009]]],
       device='cuda:0', grad_fn=<PermuteBackward0>)
Tgt: tensor([[    0,    94,  1455,  ...,     2,     2,     2],
        [    0,    34,    17,  ...,     2,     2,     2],
        [    0,   262,   244,  ...,     2,     2,     2],
        ...,
        [    0,  1925,    67,  ...,     2,     2,     2],
        [    0,    64, 13701,  ...,     2,     2,     2],
        [    0,  1770,     1,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[ 0.3206, -0.3445, -0.4486,  ..., -1.1226, -0.4996, -0.3875],
         [ 1.1444,  2.1292,  1.7217,  ...,  1.1433,  1.6933,  1.3189],
         [ 2.2487,  2.3180,  2.8174,  ...,  3.7099,  3.4756,  3.4435],
         ...,
         [-0.0409, -1.0578, -0.2847,  ..., -0.4434, -0.4107, -0.5727],
         [ 0.1848, -0.3028,  0.1875,  ...,  0.0083,  0.2357,  0.3216],
         [-0.9656, -0.9367, -0.6652,  ..., -0.2732, -0.1419, -0.4459]],

        [[-0.2980, -1.2453, -0.3615,  ..., -1.3847, -1.0929, -0.7200],
         [ 0.9132,  0.9304,  1.1436,  ...,  0.9170,  0.9432,  1.5044],
         [ 2.4306,  2.2513,  1.6983,  ...,  3.0592,  3.3376,  3.3420],
         ...,
         [ 0.1856, -0.3081, -0.4969,  ..., -0.1322, -0.0786, -0.5253],
         [-0.1999, -0.7899,  0.4774,  ...,  0.5207,  0.2559,  0.5553],
         [-0.9531, -1.2495, -0.8960,  ..., -0.6183, -0.1787, -0.4220]],

        [[ 0.0451, -1.1112, -0.1294,  ..., -0.5109, -0.7490, -0.7632],
         [ 1.2160,  0.7003,  1.8915,  ...,  0.9360,  1.1902,  1.1327],
         [ 2.2268,  1.7039,  2.3779,  ...,  3.5728,  3.5229,  3.4473],
         ...,
         [-0.1510, -0.4479, -1.3714,  ..., -0.3917, -0.6839, -0.7698],
         [-0.4144,  0.0746,  1.1642,  ...,  0.2707, -0.0515,  0.2017],
         [-0.5479,  0.1707, -0.3078,  ..., -0.0846,  0.0337,  0.0079]],

        ...,

        [[ 0.2649, -0.3761,  0.2998,  ..., -0.7229, -0.5252, -0.7926],
         [ 1.1844,  1.0453,  1.0784,  ...,  1.2259,  0.8452,  1.1975],
         [ 2.1983,  1.6574,  3.0317,  ...,  3.2021,  2.9767,  3.3607],
         ...,
         [-0.1451, -0.3419, -0.0904,  ..., -0.1251, -0.2554, -0.3478],
         [ 0.0351, -0.3911, -0.8003,  ..., -0.0946,  0.0797,  0.3755],
         [-0.5347, -0.1465, -1.0388,  ..., -0.2059, -0.2887,  0.1961]],

        [[ 0.1467, -0.3614, -0.3768,  ..., -0.4926, -0.6346, -0.7058],
         [ 1.0534,  0.4325,  0.6066,  ...,  1.0773,  1.1016,  1.0778],
         [ 2.3788,  3.3666,  2.2128,  ...,  3.7054,  3.4907,  3.8645],
         ...,
         [-0.0273, -0.0109, -0.2125,  ..., -0.3358, -0.3237, -0.5333],
         [ 0.5600, -0.3149, -0.0572,  ...,  0.2262,  0.1822,  0.1698],
         [-1.0684, -1.6313, -1.8653,  ..., -0.3412, -0.4768, -0.2469]],

        [[-0.3608, -1.3839, -0.3150,  ..., -1.0905, -1.1138, -0.9917],
         [ 1.5115,  1.4372,  1.1227,  ...,  1.8429,  1.6409,  1.3859],
         [ 2.2990,  2.0305,  2.3033,  ...,  3.1809,  3.3736,  3.2354],
         ...,
         [-0.2065, -0.3550, -1.3923,  ..., -0.7365, -0.5206, -0.1767],
         [-0.3301,  0.5000, -0.1440,  ...,  0.0873,  0.4169,  0.5278],
         [-1.2776, -1.8373, -1.7955,  ..., -0.2454, -0.7852, -0.4009]]],
       device='cuda:0', grad_fn=<PermuteBackward0>)
Tgt: tensor([[   94,  1455,    14,  ...,     2,     2,     2],
        [   34,    17,   345,  ...,     2,     2,     2],
        [  262,   244,    73,  ...,     2,     2,     2],
        ...,
        [ 1925,    67,   495,  ...,     2,     2,     2],
        [   64, 13701,    52,  ...,     2,     2,     2],
        [ 1770,     1,     2,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[-0.5913,  1.1819,  2.5343,  ...,  0.3313,  0.4099, -0.6451],
         [-1.1776,  0.8473,  2.3171,  ..., -0.6075,  0.6391, -0.6193],
         [-1.4971,  1.5615,  3.0254,  ..., -0.2354,  0.5938, -0.1200],
         ...,
         [-1.6219,  1.3061,  3.4365,  ..., -0.2794,  0.0580, -0.1836],
         [-1.1994,  1.6674,  4.1345,  ..., -0.4794,  0.3765, -0.3825],
         [-1.1439,  1.1613,  4.0273,  ..., -0.2860,  0.2567, -0.0192]],

        [[-0.3191,  1.5646,  2.7537,  ..., -0.2885,  0.3187, -1.4992],
         [-1.2359,  1.3485,  2.6718,  ..., -0.1910, -0.0566, -0.7605],
         [ 0.0208,  1.3756,  3.0542,  ...,  0.0184,  0.3691, -1.0785],
         ...,
         [-0.8258,  1.1683,  4.0608,  ..., -0.5430,  0.4413, -0.5299],
         [-0.6631,  1.6611,  4.0026,  ..., -0.3235,  0.4767, -0.2266],
         [-0.3809,  1.5983,  4.5651,  ..., -0.8464,  0.0995,  0.0255]],

        [[ 0.2890,  1.2007,  2.6720,  ...,  0.4020,  0.1377, -0.3997],
         [-0.0591,  0.9100,  2.8294,  ..., -0.3110,  0.2221, -1.4623],
         [-0.2412,  1.0910,  3.4048,  ..., -0.1080,  0.7299, -0.6131],
         ...,
         [-0.6369,  1.0671,  4.0308,  ..., -0.5122,  0.6283,  0.0834],
         [-0.9546,  1.4172,  3.7615,  ..., -0.1972,  0.5066,  0.6901],
         [-0.7614,  0.8954,  4.1439,  ..., -0.4517,  0.3925,  0.1406]],

        ...,

        [[-0.7460,  1.0983,  3.2246,  ...,  0.5610, -0.3140, -1.6933],
         [-0.4353,  1.2080,  3.1398,  ..., -0.3119,  0.3226, -1.3926],
         [-0.9142,  0.8037,  3.4364,  ...,  0.1023, -0.5301, -1.0423],
         ...,
         [-1.0739,  1.3655,  3.8618,  ..., -0.7527,  0.1243, -0.4827],
         [-1.2581,  1.1675,  3.9126,  ..., -0.4424,  0.3507, -0.3566],
         [-1.0430,  0.6963,  4.1112,  ..., -0.5460,  0.2256, -0.6715]],

        [[ 0.2315,  1.2572,  2.9626,  ...,  0.1481,  0.3387, -1.0470],
         [-0.1168,  1.4020,  3.5536,  ..., -0.2179,  0.4793, -1.6663],
         [-0.5025,  1.0858,  3.2998,  ..., -0.3279,  0.3653, -0.9952],
         ...,
         [-0.5925,  1.2458,  4.3697,  ..., -0.5782,  0.0432, -0.2113],
         [-0.5736,  1.3832,  4.3017,  ..., -0.3615,  0.1319, -0.5049],
         [-0.4760,  1.6691,  4.7298,  ..., -0.4684, -0.0077,  0.1473]],

        [[ 0.1886,  1.2768,  2.4474,  ...,  0.1660,  0.2679, -0.8555],
         [-0.3542,  0.1911,  3.5843,  ..., -0.6426, -0.1556, -1.0802],
         [-0.5897,  0.9990,  4.0992,  ..., -0.4612, -0.6388, -1.2405],
         ...,
         [-0.5378,  1.3140,  4.2251,  ..., -0.3841,  0.3437, -0.3393],
         [-0.9671,  1.3639,  4.1592,  ..., -0.7779,  0.3223,  0.0132],
         [-1.1340,  1.2690,  4.4203,  ..., -0.4218, -0.0260, -0.4111]]],
       device='cuda:0', grad_fn=<GatherBackward>)
Tgt: tensor([[    0,  7740,    15,  ...,     2,     2,     2],
        [    0,    55, 14798,  ...,     2,     2,     2],
        [    0,    60, 14902,  ...,     2,     2,     2],
        ...,
        [    0,  4240,   453,  ...,     2,     2,     2],
        [    0,    60,   179,  ...,     2,     2,     2],
        [    0,  4003,  8626,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[-0.5913, -1.1776, -1.4971,  ..., -1.6219, -1.1994, -1.1439],
         [ 1.1819,  0.8473,  1.5615,  ...,  1.3061,  1.6674,  1.1613],
         [ 2.5343,  2.3171,  3.0254,  ...,  3.4365,  4.1345,  4.0273],
         ...,
         [ 0.3313, -0.6075, -0.2354,  ..., -0.2794, -0.4794, -0.2860],
         [ 0.4099,  0.6391,  0.5938,  ...,  0.0580,  0.3765,  0.2567],
         [-0.6451, -0.6193, -0.1200,  ..., -0.1836, -0.3825, -0.0192]],

        [[-0.3191, -1.2359,  0.0208,  ..., -0.8258, -0.6631, -0.3809],
         [ 1.5646,  1.3485,  1.3756,  ...,  1.1683,  1.6611,  1.5983],
         [ 2.7537,  2.6718,  3.0542,  ...,  4.0608,  4.0026,  4.5651],
         ...,
         [-0.2885, -0.1910,  0.0184,  ..., -0.5430, -0.3235, -0.8464],
         [ 0.3187, -0.0566,  0.3691,  ...,  0.4413,  0.4767,  0.0995],
         [-1.4992, -0.7605, -1.0785,  ..., -0.5299, -0.2266,  0.0255]],

        [[ 0.2890, -0.0591, -0.2412,  ..., -0.6369, -0.9546, -0.7614],
         [ 1.2007,  0.9100,  1.0910,  ...,  1.0671,  1.4172,  0.8954],
         [ 2.6720,  2.8294,  3.4048,  ...,  4.0308,  3.7615,  4.1439],
         ...,
         [ 0.4020, -0.3110, -0.1080,  ..., -0.5122, -0.1972, -0.4517],
         [ 0.1377,  0.2221,  0.7299,  ...,  0.6283,  0.5066,  0.3925],
         [-0.3997, -1.4623, -0.6131,  ...,  0.0834,  0.6901,  0.1406]],

        ...,

        [[-0.7460, -0.4353, -0.9142,  ..., -1.0739, -1.2581, -1.0430],
         [ 1.0983,  1.2080,  0.8037,  ...,  1.3655,  1.1675,  0.6963],
         [ 3.2246,  3.1398,  3.4364,  ...,  3.8618,  3.9126,  4.1112],
         ...,
         [ 0.5610, -0.3119,  0.1023,  ..., -0.7527, -0.4424, -0.5460],
         [-0.3140,  0.3226, -0.5301,  ...,  0.1243,  0.3507,  0.2256],
         [-1.6933, -1.3926, -1.0423,  ..., -0.4827, -0.3566, -0.6715]],

        [[ 0.2315, -0.1168, -0.5025,  ..., -0.5925, -0.5736, -0.4760],
         [ 1.2572,  1.4020,  1.0858,  ...,  1.2458,  1.3832,  1.6691],
         [ 2.9626,  3.5536,  3.2998,  ...,  4.3697,  4.3017,  4.7298],
         ...,
         [ 0.1481, -0.2179, -0.3279,  ..., -0.5782, -0.3615, -0.4684],
         [ 0.3387,  0.4793,  0.3653,  ...,  0.0432,  0.1319, -0.0077],
         [-1.0470, -1.6663, -0.9952,  ..., -0.2113, -0.5049,  0.1473]],

        [[ 0.1886, -0.3542, -0.5897,  ..., -0.5378, -0.9671, -1.1340],
         [ 1.2768,  0.1911,  0.9990,  ...,  1.3140,  1.3639,  1.2690],
         [ 2.4474,  3.5843,  4.0992,  ...,  4.2251,  4.1592,  4.4203],
         ...,
         [ 0.1660, -0.6426, -0.4612,  ..., -0.3841, -0.7779, -0.4218],
         [ 0.2679, -0.1556, -0.6388,  ...,  0.3437,  0.3223, -0.0260],
         [-0.8555, -1.0802, -1.2405,  ..., -0.3393,  0.0132, -0.4111]]],
       device='cuda:0', grad_fn=<PermuteBackward0>)
Tgt: tensor([[    0,  7740,    15,  ...,     2,     2,     2],
        [    0,    55, 14798,  ...,     2,     2,     2],
        [    0,    60, 14902,  ...,     2,     2,     2],
        ...,
        [    0,  4240,   453,  ...,     2,     2,     2],
        [    0,    60,   179,  ...,     2,     2,     2],
        [    0,  4003,  8626,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[-0.5913, -1.1776, -1.4971,  ..., -1.6219, -1.1994, -1.1439],
         [ 1.1819,  0.8473,  1.5615,  ...,  1.3061,  1.6674,  1.1613],
         [ 2.5343,  2.3171,  3.0254,  ...,  3.4365,  4.1345,  4.0273],
         ...,
         [ 0.3313, -0.6075, -0.2354,  ..., -0.2794, -0.4794, -0.2860],
         [ 0.4099,  0.6391,  0.5938,  ...,  0.0580,  0.3765,  0.2567],
         [-0.6451, -0.6193, -0.1200,  ..., -0.1836, -0.3825, -0.0192]],

        [[-0.3191, -1.2359,  0.0208,  ..., -0.8258, -0.6631, -0.3809],
         [ 1.5646,  1.3485,  1.3756,  ...,  1.1683,  1.6611,  1.5983],
         [ 2.7537,  2.6718,  3.0542,  ...,  4.0608,  4.0026,  4.5651],
         ...,
         [-0.2885, -0.1910,  0.0184,  ..., -0.5430, -0.3235, -0.8464],
         [ 0.3187, -0.0566,  0.3691,  ...,  0.4413,  0.4767,  0.0995],
         [-1.4992, -0.7605, -1.0785,  ..., -0.5299, -0.2266,  0.0255]],

        [[ 0.2890, -0.0591, -0.2412,  ..., -0.6369, -0.9546, -0.7614],
         [ 1.2007,  0.9100,  1.0910,  ...,  1.0671,  1.4172,  0.8954],
         [ 2.6720,  2.8294,  3.4048,  ...,  4.0308,  3.7615,  4.1439],
         ...,
         [ 0.4020, -0.3110, -0.1080,  ..., -0.5122, -0.1972, -0.4517],
         [ 0.1377,  0.2221,  0.7299,  ...,  0.6283,  0.5066,  0.3925],
         [-0.3997, -1.4623, -0.6131,  ...,  0.0834,  0.6901,  0.1406]],

        ...,

        [[-0.7460, -0.4353, -0.9142,  ..., -1.0739, -1.2581, -1.0430],
         [ 1.0983,  1.2080,  0.8037,  ...,  1.3655,  1.1675,  0.6963],
         [ 3.2246,  3.1398,  3.4364,  ...,  3.8618,  3.9126,  4.1112],
         ...,
         [ 0.5610, -0.3119,  0.1023,  ..., -0.7527, -0.4424, -0.5460],
         [-0.3140,  0.3226, -0.5301,  ...,  0.1243,  0.3507,  0.2256],
         [-1.6933, -1.3926, -1.0423,  ..., -0.4827, -0.3566, -0.6715]],

        [[ 0.2315, -0.1168, -0.5025,  ..., -0.5925, -0.5736, -0.4760],
         [ 1.2572,  1.4020,  1.0858,  ...,  1.2458,  1.3832,  1.6691],
         [ 2.9626,  3.5536,  3.2998,  ...,  4.3697,  4.3017,  4.7298],
         ...,
         [ 0.1481, -0.2179, -0.3279,  ..., -0.5782, -0.3615, -0.4684],
         [ 0.3387,  0.4793,  0.3653,  ...,  0.0432,  0.1319, -0.0077],
         [-1.0470, -1.6663, -0.9952,  ..., -0.2113, -0.5049,  0.1473]],

        [[ 0.1886, -0.3542, -0.5897,  ..., -0.5378, -0.9671, -1.1340],
         [ 1.2768,  0.1911,  0.9990,  ...,  1.3140,  1.3639,  1.2690],
         [ 2.4474,  3.5843,  4.0992,  ...,  4.2251,  4.1592,  4.4203],
         ...,
         [ 0.1660, -0.6426, -0.4612,  ..., -0.3841, -0.7779, -0.4218],
         [ 0.2679, -0.1556, -0.6388,  ...,  0.3437,  0.3223, -0.0260],
         [-0.8555, -1.0802, -1.2405,  ..., -0.3393,  0.0132, -0.4111]]],
       device='cuda:0', grad_fn=<PermuteBackward0>)
Tgt: tensor([[ 7740,    15, 13859,  ...,     2,     2,     2],
        [   55, 14798,  4652,  ...,     2,     2,     2],
        [   60, 14902,    25,  ...,     2,     2,     2],
        ...,
        [ 4240,   453,  1196,  ...,     2,     2,     2],
        [   60,   179,   167,  ...,     2,     2,     2],
        [ 4003,  8626,  3416,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[ 1.5333e-01,  1.3777e+00,  3.4614e+00,  ..., -1.0991e-01,
           1.1335e-01, -5.9442e-01],
         [-1.6749e-01,  1.0997e+00,  3.1685e+00,  ..., -5.1160e-01,
           2.1101e-01, -9.2412e-01],
         [-3.7179e-01,  1.7051e+00,  3.9956e+00,  ..., -1.2872e+00,
           4.5537e-01, -8.3823e-01],
         ...,
         [-8.4187e-01,  1.0553e+00,  4.7267e+00,  ..., -4.0792e-01,
          -1.0521e-01,  3.6479e-01],
         [-6.1347e-01,  1.6065e+00,  4.4517e+00,  ..., -3.3456e-01,
          -8.2491e-02, -3.4266e-01],
         [-2.6857e-01,  1.2661e+00,  4.6129e+00,  ..., -8.4329e-01,
           2.9681e-01,  5.7612e-02]],

        [[-1.1261e-01,  9.8949e-01,  3.4533e+00,  ..., -4.7259e-01,
          -1.1385e-01, -8.7703e-01],
         [-1.2589e+00,  5.8146e-01,  4.1136e+00,  ..., -3.5998e-01,
           1.2223e-01, -1.5206e+00],
         [-1.1588e+00,  6.5427e-01,  3.8189e+00,  ..., -7.1077e-01,
           4.1872e-01, -8.7849e-01],
         ...,
         [-5.5525e-01,  1.1483e+00,  4.9922e+00,  ..., -3.4698e-01,
           4.6210e-01, -5.2574e-01],
         [-5.8438e-01,  8.8187e-01,  4.8538e+00,  ..., -5.4127e-01,
           2.2156e-01, -1.8123e-01],
         [-6.2233e-01,  1.1096e+00,  5.0357e+00,  ..., -6.5184e-01,
           5.0120e-01, -2.8159e-01]],

        [[-2.5341e-01,  7.6460e-01,  3.7134e+00,  ...,  4.5152e-01,
           3.0281e-01, -1.1118e+00],
         [-3.6403e-01,  8.9587e-01,  4.4797e+00,  ..., -3.3512e-01,
           3.7941e-01, -6.5120e-01],
         [-3.9504e-01,  1.2583e+00,  3.7902e+00,  ..., -3.7510e-01,
           3.4541e-01, -9.3890e-01],
         ...,
         [-9.0165e-01,  1.0148e+00,  4.8193e+00,  ..., -6.1474e-01,
           5.3619e-01, -3.4148e-01],
         [-1.0472e+00,  1.0768e+00,  4.5852e+00,  ..., -3.1577e-01,
           3.8585e-01, -5.2687e-01],
         [-8.2934e-01,  1.0018e+00,  4.9714e+00,  ..., -3.8212e-01,
           3.6041e-01, -3.1111e-01]],

        ...,

        [[ 4.5741e-01,  1.1375e+00,  3.0865e+00,  ..., -1.3092e-03,
           1.9596e-01, -1.0207e+00],
         [-1.0404e+00,  2.8006e-01,  2.6390e+00,  ...,  4.6689e-01,
          -3.2321e-01, -8.4175e-01],
         [-7.0142e-01,  1.3713e+00,  3.8467e+00,  ...,  5.6869e-01,
          -1.0713e-01, -1.2061e+00],
         ...,
         [-9.2018e-01,  1.0035e+00,  4.7384e+00,  ..., -3.8927e-01,
           1.3304e-01, -1.3133e-01],
         [-5.9348e-01,  1.1114e+00,  4.7329e+00,  ...,  3.0915e-02,
           1.9573e-01, -1.6663e-01],
         [-2.7582e-01,  1.3304e+00,  4.4985e+00,  ..., -5.0305e-01,
          -9.8866e-02, -1.2183e-02]],

        [[ 3.9717e-01,  1.2927e+00,  3.0262e+00,  ..., -8.7419e-02,
           2.3294e-02, -6.5799e-01],
         [-6.2149e-02,  1.2430e+00,  2.8462e+00,  ..., -3.0538e-01,
           1.9339e-01, -1.2384e+00],
         [ 3.9880e-01,  1.7955e+00,  3.3802e+00,  ..., -6.8265e-01,
          -1.8171e-01, -1.3702e+00],
         ...,
         [-4.1033e-01,  1.2524e+00,  5.0205e+00,  ..., -5.9201e-01,
           1.5987e-01,  8.8663e-02],
         [-8.3737e-01,  1.0491e+00,  5.2126e+00,  ..., -5.7220e-01,
           3.5123e-01, -1.5322e-01],
         [-4.3965e-01,  1.0407e+00,  5.0481e+00,  ..., -6.2843e-01,
          -1.7873e-01, -1.5836e-01]],

        [[ 2.8190e-01,  8.7201e-01,  3.3965e+00,  ..., -2.8766e-01,
           3.1476e-02, -8.2382e-01],
         [-4.8555e-02,  1.0098e+00,  4.2345e+00,  ..., -3.9903e-01,
           3.0001e-01, -1.4125e+00],
         [-1.4208e-01,  1.5797e+00,  4.4919e+00,  ..., -5.9799e-01,
          -2.6713e-01, -9.9601e-01],
         ...,
         [-6.5007e-01,  1.3377e+00,  4.6990e+00,  ..., -2.9480e-01,
           4.9184e-01, -1.8269e-01],
         [-9.3309e-02,  1.3336e+00,  5.2462e+00,  ..., -1.6613e-01,
           2.6781e-01, -2.8508e-01],
         [-8.1187e-01,  1.2070e+00,  5.1815e+00,  ..., -4.4362e-01,
           2.7393e-01, -4.5671e-01]]], device='cuda:0',
       grad_fn=<GatherBackward>)
Tgt: tensor([[    0,    60, 26713,  ...,     2,     2,     2],
        [    0,    64,  5824,  ...,     2,     2,     2],
        [    0, 14040, 11837,  ...,     2,     2,     2],
        ...,
        [    0,  5838, 14725,  ...,     2,     2,     2],
        [    0,   209,    44,  ...,     2,     2,     2],
        [    0,    60,   430,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[ 1.5333e-01, -1.6749e-01, -3.7179e-01,  ..., -8.4187e-01,
          -6.1347e-01, -2.6857e-01],
         [ 1.3777e+00,  1.0997e+00,  1.7051e+00,  ...,  1.0553e+00,
           1.6065e+00,  1.2661e+00],
         [ 3.4614e+00,  3.1685e+00,  3.9956e+00,  ...,  4.7267e+00,
           4.4517e+00,  4.6129e+00],
         ...,
         [-1.0991e-01, -5.1160e-01, -1.2872e+00,  ..., -4.0792e-01,
          -3.3456e-01, -8.4329e-01],
         [ 1.1335e-01,  2.1101e-01,  4.5537e-01,  ..., -1.0521e-01,
          -8.2491e-02,  2.9681e-01],
         [-5.9442e-01, -9.2412e-01, -8.3823e-01,  ...,  3.6479e-01,
          -3.4266e-01,  5.7612e-02]],

        [[-1.1261e-01, -1.2589e+00, -1.1588e+00,  ..., -5.5525e-01,
          -5.8438e-01, -6.2233e-01],
         [ 9.8949e-01,  5.8146e-01,  6.5427e-01,  ...,  1.1483e+00,
           8.8187e-01,  1.1096e+00],
         [ 3.4533e+00,  4.1136e+00,  3.8189e+00,  ...,  4.9922e+00,
           4.8538e+00,  5.0357e+00],
         ...,
         [-4.7259e-01, -3.5998e-01, -7.1077e-01,  ..., -3.4698e-01,
          -5.4127e-01, -6.5184e-01],
         [-1.1385e-01,  1.2223e-01,  4.1872e-01,  ...,  4.6210e-01,
           2.2156e-01,  5.0120e-01],
         [-8.7703e-01, -1.5206e+00, -8.7849e-01,  ..., -5.2574e-01,
          -1.8123e-01, -2.8159e-01]],

        [[-2.5341e-01, -3.6403e-01, -3.9504e-01,  ..., -9.0165e-01,
          -1.0472e+00, -8.2934e-01],
         [ 7.6460e-01,  8.9587e-01,  1.2583e+00,  ...,  1.0148e+00,
           1.0768e+00,  1.0018e+00],
         [ 3.7134e+00,  4.4797e+00,  3.7902e+00,  ...,  4.8193e+00,
           4.5852e+00,  4.9714e+00],
         ...,
         [ 4.5152e-01, -3.3512e-01, -3.7510e-01,  ..., -6.1474e-01,
          -3.1577e-01, -3.8212e-01],
         [ 3.0281e-01,  3.7941e-01,  3.4541e-01,  ...,  5.3619e-01,
           3.8585e-01,  3.6041e-01],
         [-1.1118e+00, -6.5120e-01, -9.3890e-01,  ..., -3.4148e-01,
          -5.2687e-01, -3.1111e-01]],

        ...,

        [[ 4.5741e-01, -1.0404e+00, -7.0142e-01,  ..., -9.2018e-01,
          -5.9348e-01, -2.7582e-01],
         [ 1.1375e+00,  2.8006e-01,  1.3713e+00,  ...,  1.0035e+00,
           1.1114e+00,  1.3304e+00],
         [ 3.0865e+00,  2.6390e+00,  3.8467e+00,  ...,  4.7384e+00,
           4.7329e+00,  4.4985e+00],
         ...,
         [-1.3092e-03,  4.6689e-01,  5.6869e-01,  ..., -3.8927e-01,
           3.0915e-02, -5.0305e-01],
         [ 1.9596e-01, -3.2321e-01, -1.0713e-01,  ...,  1.3304e-01,
           1.9573e-01, -9.8866e-02],
         [-1.0207e+00, -8.4175e-01, -1.2061e+00,  ..., -1.3133e-01,
          -1.6663e-01, -1.2183e-02]],

        [[ 3.9717e-01, -6.2149e-02,  3.9880e-01,  ..., -4.1033e-01,
          -8.3737e-01, -4.3965e-01],
         [ 1.2927e+00,  1.2430e+00,  1.7955e+00,  ...,  1.2524e+00,
           1.0491e+00,  1.0407e+00],
         [ 3.0262e+00,  2.8462e+00,  3.3802e+00,  ...,  5.0205e+00,
           5.2126e+00,  5.0481e+00],
         ...,
         [-8.7419e-02, -3.0538e-01, -6.8265e-01,  ..., -5.9201e-01,
          -5.7220e-01, -6.2843e-01],
         [ 2.3294e-02,  1.9339e-01, -1.8171e-01,  ...,  1.5987e-01,
           3.5123e-01, -1.7873e-01],
         [-6.5799e-01, -1.2384e+00, -1.3702e+00,  ...,  8.8663e-02,
          -1.5322e-01, -1.5836e-01]],

        [[ 2.8190e-01, -4.8555e-02, -1.4208e-01,  ..., -6.5007e-01,
          -9.3309e-02, -8.1187e-01],
         [ 8.7201e-01,  1.0098e+00,  1.5797e+00,  ...,  1.3377e+00,
           1.3336e+00,  1.2070e+00],
         [ 3.3965e+00,  4.2345e+00,  4.4919e+00,  ...,  4.6990e+00,
           5.2462e+00,  5.1815e+00],
         ...,
         [-2.8766e-01, -3.9903e-01, -5.9799e-01,  ..., -2.9480e-01,
          -1.6613e-01, -4.4362e-01],
         [ 3.1476e-02,  3.0001e-01, -2.6713e-01,  ...,  4.9184e-01,
           2.6781e-01,  2.7393e-01],
         [-8.2382e-01, -1.4125e+00, -9.9601e-01,  ..., -1.8269e-01,
          -2.8508e-01, -4.5671e-01]]], device='cuda:0',
       grad_fn=<PermuteBackward0>)
Tgt: tensor([[    0,    60, 26713,  ...,     2,     2,     2],
        [    0,    64,  5824,  ...,     2,     2,     2],
        [    0, 14040, 11837,  ...,     2,     2,     2],
        ...,
        [    0,  5838, 14725,  ...,     2,     2,     2],
        [    0,   209,    44,  ...,     2,     2,     2],
        [    0,    60,   430,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[ 1.5333e-01, -1.6749e-01, -3.7179e-01,  ..., -8.4187e-01,
          -6.1347e-01, -2.6857e-01],
         [ 1.3777e+00,  1.0997e+00,  1.7051e+00,  ...,  1.0553e+00,
           1.6065e+00,  1.2661e+00],
         [ 3.4614e+00,  3.1685e+00,  3.9956e+00,  ...,  4.7267e+00,
           4.4517e+00,  4.6129e+00],
         ...,
         [-1.0991e-01, -5.1160e-01, -1.2872e+00,  ..., -4.0792e-01,
          -3.3456e-01, -8.4329e-01],
         [ 1.1335e-01,  2.1101e-01,  4.5537e-01,  ..., -1.0521e-01,
          -8.2491e-02,  2.9681e-01],
         [-5.9442e-01, -9.2412e-01, -8.3823e-01,  ...,  3.6479e-01,
          -3.4266e-01,  5.7612e-02]],

        [[-1.1261e-01, -1.2589e+00, -1.1588e+00,  ..., -5.5525e-01,
          -5.8438e-01, -6.2233e-01],
         [ 9.8949e-01,  5.8146e-01,  6.5427e-01,  ...,  1.1483e+00,
           8.8187e-01,  1.1096e+00],
         [ 3.4533e+00,  4.1136e+00,  3.8189e+00,  ...,  4.9922e+00,
           4.8538e+00,  5.0357e+00],
         ...,
         [-4.7259e-01, -3.5998e-01, -7.1077e-01,  ..., -3.4698e-01,
          -5.4127e-01, -6.5184e-01],
         [-1.1385e-01,  1.2223e-01,  4.1872e-01,  ...,  4.6210e-01,
           2.2156e-01,  5.0120e-01],
         [-8.7703e-01, -1.5206e+00, -8.7849e-01,  ..., -5.2574e-01,
          -1.8123e-01, -2.8159e-01]],

        [[-2.5341e-01, -3.6403e-01, -3.9504e-01,  ..., -9.0165e-01,
          -1.0472e+00, -8.2934e-01],
         [ 7.6460e-01,  8.9587e-01,  1.2583e+00,  ...,  1.0148e+00,
           1.0768e+00,  1.0018e+00],
         [ 3.7134e+00,  4.4797e+00,  3.7902e+00,  ...,  4.8193e+00,
           4.5852e+00,  4.9714e+00],
         ...,
         [ 4.5152e-01, -3.3512e-01, -3.7510e-01,  ..., -6.1474e-01,
          -3.1577e-01, -3.8212e-01],
         [ 3.0281e-01,  3.7941e-01,  3.4541e-01,  ...,  5.3619e-01,
           3.8585e-01,  3.6041e-01],
         [-1.1118e+00, -6.5120e-01, -9.3890e-01,  ..., -3.4148e-01,
          -5.2687e-01, -3.1111e-01]],

        ...,

        [[ 4.5741e-01, -1.0404e+00, -7.0142e-01,  ..., -9.2018e-01,
          -5.9348e-01, -2.7582e-01],
         [ 1.1375e+00,  2.8006e-01,  1.3713e+00,  ...,  1.0035e+00,
           1.1114e+00,  1.3304e+00],
         [ 3.0865e+00,  2.6390e+00,  3.8467e+00,  ...,  4.7384e+00,
           4.7329e+00,  4.4985e+00],
         ...,
         [-1.3092e-03,  4.6689e-01,  5.6869e-01,  ..., -3.8927e-01,
           3.0915e-02, -5.0305e-01],
         [ 1.9596e-01, -3.2321e-01, -1.0713e-01,  ...,  1.3304e-01,
           1.9573e-01, -9.8866e-02],
         [-1.0207e+00, -8.4175e-01, -1.2061e+00,  ..., -1.3133e-01,
          -1.6663e-01, -1.2183e-02]],

        [[ 3.9717e-01, -6.2149e-02,  3.9880e-01,  ..., -4.1033e-01,
          -8.3737e-01, -4.3965e-01],
         [ 1.2927e+00,  1.2430e+00,  1.7955e+00,  ...,  1.2524e+00,
           1.0491e+00,  1.0407e+00],
         [ 3.0262e+00,  2.8462e+00,  3.3802e+00,  ...,  5.0205e+00,
           5.2126e+00,  5.0481e+00],
         ...,
         [-8.7419e-02, -3.0538e-01, -6.8265e-01,  ..., -5.9201e-01,
          -5.7220e-01, -6.2843e-01],
         [ 2.3294e-02,  1.9339e-01, -1.8171e-01,  ...,  1.5987e-01,
           3.5123e-01, -1.7873e-01],
         [-6.5799e-01, -1.2384e+00, -1.3702e+00,  ...,  8.8663e-02,
          -1.5322e-01, -1.5836e-01]],

        [[ 2.8190e-01, -4.8555e-02, -1.4208e-01,  ..., -6.5007e-01,
          -9.3309e-02, -8.1187e-01],
         [ 8.7201e-01,  1.0098e+00,  1.5797e+00,  ...,  1.3377e+00,
           1.3336e+00,  1.2070e+00],
         [ 3.3965e+00,  4.2345e+00,  4.4919e+00,  ...,  4.6990e+00,
           5.2462e+00,  5.1815e+00],
         ...,
         [-2.8766e-01, -3.9903e-01, -5.9799e-01,  ..., -2.9480e-01,
          -1.6613e-01, -4.4362e-01],
         [ 3.1476e-02,  3.0001e-01, -2.6713e-01,  ...,  4.9184e-01,
           2.6781e-01,  2.7393e-01],
         [-8.2382e-01, -1.4125e+00, -9.9601e-01,  ..., -1.8269e-01,
          -2.8508e-01, -4.5671e-01]]], device='cuda:0',
       grad_fn=<PermuteBackward0>)
Tgt: tensor([[   60, 26713,  8076,  ...,     2,     2,     2],
        [   64,  5824,    15,  ...,     2,     2,     2],
        [14040, 11837,    16,  ...,     2,     2,     2],
        ...,
        [ 5838, 14725,    70,  ...,     2,     2,     2],
        [  209,    44,    14,  ...,     2,     2,     2],
        [   60,   430,   408,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[ 0.5218,  0.7077,  3.3799,  ..., -0.0240,  0.3118, -0.5350],
         [ 0.2744,  0.4476,  3.6055,  ..., -0.2013,  0.5368, -0.5649],
         [-0.3070,  0.4235,  4.1439,  ..., -0.6549, -0.0078, -0.9502],
         ...,
         [-0.1264,  0.9298,  3.9263,  ..., -0.6764, -0.2725, -0.6187],
         [ 0.1045,  0.5342,  4.6814,  ..., -0.7940,  0.3690, -0.6520],
         [-0.5590,  1.0285,  3.3725,  ..., -0.7369,  0.2698, -0.2956]],

        [[ 0.3932,  0.9917,  4.6252,  ...,  0.3772,  0.4441, -0.8563],
         [-0.1928,  1.3869,  4.4473,  ..., -0.6691,  0.2537, -0.8774],
         [-0.0783,  0.7328,  4.6109,  ..., -0.7268,  0.6233, -1.4948],
         ...,
         [-0.7445,  0.9364,  5.6362,  ..., -0.3242,  0.3382, -0.7173],
         [-1.0401,  1.2793,  5.6434,  ..., -0.2620,  0.1720, -0.2816],
         [-0.6855,  1.2094,  5.7967,  ..., -0.2196,  0.2836, -0.3818]],

        [[ 0.1358,  0.9838,  3.2566,  ...,  0.1780,  0.3056, -0.6173],
         [-0.6450,  1.2108,  4.2670,  ..., -0.3181,  0.2469, -0.9040],
         [ 0.2328,  1.1089,  3.7366,  ..., -0.0161,  0.0455, -1.1503],
         ...,
         [ 0.5018,  0.1323,  3.5075,  ..., -0.7709, -0.1496, -0.8288],
         [ 0.1625,  0.6365,  4.3871,  ..., -0.2918,  0.1240, -1.0609],
         [-0.3704,  1.4518,  3.9213,  ..., -0.7338,  0.5227, -0.4503]],

        ...,

        [[-0.1373,  1.5700,  4.0025,  ...,  0.2340, -0.0067, -1.2989],
         [-0.5571,  0.6526,  3.3028,  ...,  0.4167, -0.1518, -1.1378],
         [-0.5836,  1.1936,  4.1506,  ...,  0.3414, -0.1183, -1.3795],
         ...,
         [-0.8807,  1.3624,  5.4900,  ..., -0.4458,  0.2489, -0.3813],
         [-0.9798,  1.2401,  5.5470,  ..., -0.0277,  0.1837, -0.5102],
         [-0.8565,  1.0934,  5.4036,  ...,  0.1106,  0.4177, -0.4828]],

        [[ 0.3344,  0.9766,  3.7257,  ...,  0.2810,  0.1984, -0.6136],
         [-1.0523,  0.9486,  3.6984,  ..., -1.0971,  0.1721, -0.6372],
         [-1.2647,  0.9629,  3.6867,  ..., -0.2983, -0.7652, -0.5201],
         ...,
         [-0.8232,  1.5702,  3.7088,  ..., -0.8273, -0.0379, -0.2086],
         [-0.0748,  1.5687,  4.2192,  ..., -0.4847,  0.0899, -0.9811],
         [ 0.3374,  0.4533,  3.9823,  ..., -0.8111,  0.3828, -0.6991]],

        [[ 0.3166,  1.0049,  4.2437,  ..., -0.0269, -0.5455, -0.8923],
         [-0.2120,  1.0864,  3.7817,  ..., -0.4421,  0.4100, -0.6787],
         [-0.6656,  1.2747,  4.0671,  ..., -0.3814,  0.4792, -0.6201],
         ...,
         [-0.7931,  0.9130,  5.3380,  ..., -0.5658,  0.1705, -0.0903],
         [-0.8347,  1.7267,  5.2105,  ..., -0.3741,  0.3489, -0.1565],
         [-0.7811,  1.1505,  5.9557,  ..., -0.5055,  0.3153, -0.0219]]],
       device='cuda:0', grad_fn=<GatherBackward>)
Tgt: tensor([[    0, 12827,    36,  ...,    20,  1131,     1],
        [    0,  9104,   303,  ...,     2,     2,     2],
        [    0, 10335,  2939,  ...,  5370,  1006,     1],
        ...,
        [    0,  1842,  9737,  ...,     2,     2,     2],
        [    0,   141,    34,  ...,    17,  5867,     1],
        [    0,  4877,    14,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[ 0.5218,  0.2744, -0.3070,  ..., -0.1264,  0.1045, -0.5590],
         [ 0.7077,  0.4476,  0.4235,  ...,  0.9298,  0.5342,  1.0285],
         [ 3.3799,  3.6055,  4.1439,  ...,  3.9263,  4.6814,  3.3725],
         ...,
         [-0.0240, -0.2013, -0.6549,  ..., -0.6764, -0.7940, -0.7369],
         [ 0.3118,  0.5368, -0.0078,  ..., -0.2725,  0.3690,  0.2698],
         [-0.5350, -0.5649, -0.9502,  ..., -0.6187, -0.6520, -0.2956]],

        [[ 0.3932, -0.1928, -0.0783,  ..., -0.7445, -1.0401, -0.6855],
         [ 0.9917,  1.3869,  0.7328,  ...,  0.9364,  1.2793,  1.2094],
         [ 4.6252,  4.4473,  4.6109,  ...,  5.6362,  5.6434,  5.7967],
         ...,
         [ 0.3772, -0.6691, -0.7268,  ..., -0.3242, -0.2620, -0.2196],
         [ 0.4441,  0.2537,  0.6233,  ...,  0.3382,  0.1720,  0.2836],
         [-0.8563, -0.8774, -1.4948,  ..., -0.7173, -0.2816, -0.3818]],

        [[ 0.1358, -0.6450,  0.2328,  ...,  0.5018,  0.1625, -0.3704],
         [ 0.9838,  1.2108,  1.1089,  ...,  0.1323,  0.6365,  1.4518],
         [ 3.2566,  4.2670,  3.7366,  ...,  3.5075,  4.3871,  3.9213],
         ...,
         [ 0.1780, -0.3181, -0.0161,  ..., -0.7709, -0.2918, -0.7338],
         [ 0.3056,  0.2469,  0.0455,  ..., -0.1496,  0.1240,  0.5227],
         [-0.6173, -0.9040, -1.1503,  ..., -0.8288, -1.0609, -0.4503]],

        ...,

        [[-0.1373, -0.5571, -0.5836,  ..., -0.8807, -0.9798, -0.8565],
         [ 1.5700,  0.6526,  1.1936,  ...,  1.3624,  1.2401,  1.0934],
         [ 4.0025,  3.3028,  4.1506,  ...,  5.4900,  5.5470,  5.4036],
         ...,
         [ 0.2340,  0.4167,  0.3414,  ..., -0.4458, -0.0277,  0.1106],
         [-0.0067, -0.1518, -0.1183,  ...,  0.2489,  0.1837,  0.4177],
         [-1.2989, -1.1378, -1.3795,  ..., -0.3813, -0.5102, -0.4828]],

        [[ 0.3344, -1.0523, -1.2647,  ..., -0.8232, -0.0748,  0.3374],
         [ 0.9766,  0.9486,  0.9629,  ...,  1.5702,  1.5687,  0.4533],
         [ 3.7257,  3.6984,  3.6867,  ...,  3.7088,  4.2192,  3.9823],
         ...,
         [ 0.2810, -1.0971, -0.2983,  ..., -0.8273, -0.4847, -0.8111],
         [ 0.1984,  0.1721, -0.7652,  ..., -0.0379,  0.0899,  0.3828],
         [-0.6136, -0.6372, -0.5201,  ..., -0.2086, -0.9811, -0.6991]],

        [[ 0.3166, -0.2120, -0.6656,  ..., -0.7931, -0.8347, -0.7811],
         [ 1.0049,  1.0864,  1.2747,  ...,  0.9130,  1.7267,  1.1505],
         [ 4.2437,  3.7817,  4.0671,  ...,  5.3380,  5.2105,  5.9557],
         ...,
         [-0.0269, -0.4421, -0.3814,  ..., -0.5658, -0.3741, -0.5055],
         [-0.5455,  0.4100,  0.4792,  ...,  0.1705,  0.3489,  0.3153],
         [-0.8923, -0.6787, -0.6201,  ..., -0.0903, -0.1565, -0.0219]]],
       device='cuda:0', grad_fn=<PermuteBackward0>)
Tgt: tensor([[    0, 12827,    36,  ...,    20,  1131,     1],
        [    0,  9104,   303,  ...,     2,     2,     2],
        [    0, 10335,  2939,  ...,  5370,  1006,     1],
        ...,
        [    0,  1842,  9737,  ...,     2,     2,     2],
        [    0,   141,    34,  ...,    17,  5867,     1],
        [    0,  4877,    14,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[ 0.5218,  0.2744, -0.3070,  ..., -0.1264,  0.1045, -0.5590],
         [ 0.7077,  0.4476,  0.4235,  ...,  0.9298,  0.5342,  1.0285],
         [ 3.3799,  3.6055,  4.1439,  ...,  3.9263,  4.6814,  3.3725],
         ...,
         [-0.0240, -0.2013, -0.6549,  ..., -0.6764, -0.7940, -0.7369],
         [ 0.3118,  0.5368, -0.0078,  ..., -0.2725,  0.3690,  0.2698],
         [-0.5350, -0.5649, -0.9502,  ..., -0.6187, -0.6520, -0.2956]],

        [[ 0.3932, -0.1928, -0.0783,  ..., -0.7445, -1.0401, -0.6855],
         [ 0.9917,  1.3869,  0.7328,  ...,  0.9364,  1.2793,  1.2094],
         [ 4.6252,  4.4473,  4.6109,  ...,  5.6362,  5.6434,  5.7967],
         ...,
         [ 0.3772, -0.6691, -0.7268,  ..., -0.3242, -0.2620, -0.2196],
         [ 0.4441,  0.2537,  0.6233,  ...,  0.3382,  0.1720,  0.2836],
         [-0.8563, -0.8774, -1.4948,  ..., -0.7173, -0.2816, -0.3818]],

        [[ 0.1358, -0.6450,  0.2328,  ...,  0.5018,  0.1625, -0.3704],
         [ 0.9838,  1.2108,  1.1089,  ...,  0.1323,  0.6365,  1.4518],
         [ 3.2566,  4.2670,  3.7366,  ...,  3.5075,  4.3871,  3.9213],
         ...,
         [ 0.1780, -0.3181, -0.0161,  ..., -0.7709, -0.2918, -0.7338],
         [ 0.3056,  0.2469,  0.0455,  ..., -0.1496,  0.1240,  0.5227],
         [-0.6173, -0.9040, -1.1503,  ..., -0.8288, -1.0609, -0.4503]],

        ...,

        [[-0.1373, -0.5571, -0.5836,  ..., -0.8807, -0.9798, -0.8565],
         [ 1.5700,  0.6526,  1.1936,  ...,  1.3624,  1.2401,  1.0934],
         [ 4.0025,  3.3028,  4.1506,  ...,  5.4900,  5.5470,  5.4036],
         ...,
         [ 0.2340,  0.4167,  0.3414,  ..., -0.4458, -0.0277,  0.1106],
         [-0.0067, -0.1518, -0.1183,  ...,  0.2489,  0.1837,  0.4177],
         [-1.2989, -1.1378, -1.3795,  ..., -0.3813, -0.5102, -0.4828]],

        [[ 0.3344, -1.0523, -1.2647,  ..., -0.8232, -0.0748,  0.3374],
         [ 0.9766,  0.9486,  0.9629,  ...,  1.5702,  1.5687,  0.4533],
         [ 3.7257,  3.6984,  3.6867,  ...,  3.7088,  4.2192,  3.9823],
         ...,
         [ 0.2810, -1.0971, -0.2983,  ..., -0.8273, -0.4847, -0.8111],
         [ 0.1984,  0.1721, -0.7652,  ..., -0.0379,  0.0899,  0.3828],
         [-0.6136, -0.6372, -0.5201,  ..., -0.2086, -0.9811, -0.6991]],

        [[ 0.3166, -0.2120, -0.6656,  ..., -0.7931, -0.8347, -0.7811],
         [ 1.0049,  1.0864,  1.2747,  ...,  0.9130,  1.7267,  1.1505],
         [ 4.2437,  3.7817,  4.0671,  ...,  5.3380,  5.2105,  5.9557],
         ...,
         [-0.0269, -0.4421, -0.3814,  ..., -0.5658, -0.3741, -0.5055],
         [-0.5455,  0.4100,  0.4792,  ...,  0.1705,  0.3489,  0.3153],
         [-0.8923, -0.6787, -0.6201,  ..., -0.0903, -0.1565, -0.0219]]],
       device='cuda:0', grad_fn=<PermuteBackward0>)
Tgt: tensor([[12827,    36,   259,  ...,    20,  1131,     1],
        [ 9104,   303, 24208,  ...,     2,     2,     2],
        [10335,  2939,   746,  ...,  5370,  1006,     1],
        ...,
        [ 1842,  9737,    15,  ...,     2,     2,     2],
        [  141,    34,  5179,  ...,    17,  5867,     1],
        [ 4877,    14,    41,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[ 1.4202e-01,  1.0776e+00,  4.5030e+00,  ...,  1.1128e-01,
          -5.5896e-01, -8.3980e-01],
         [ 5.4669e-02,  2.2613e+00,  4.3939e+00,  ..., -8.4740e-01,
          -1.7797e-01, -1.0031e+00],
         [-3.4249e-01,  1.5609e+00,  4.0865e+00,  ..., -7.9783e-01,
           2.0851e-01, -1.3947e+00],
         ...,
         [-9.1230e-01,  8.6584e-01,  6.5913e+00,  ..., -5.8826e-01,
          -3.6116e-02, -6.4769e-02],
         [-4.6084e-01,  1.4053e+00,  6.3600e+00,  ..., -4.8950e-01,
          -4.1942e-01,  9.8591e-02],
         [-5.0101e-01,  9.4565e-01,  6.6111e+00,  ..., -2.0367e-01,
          -1.4782e-01, -1.4433e-01]],

        [[-7.9184e-02,  4.4090e-01,  4.6481e+00,  ...,  3.0177e-01,
          -4.6846e-01, -1.0333e+00],
         [-1.1042e+00,  1.0769e+00,  5.0587e+00,  ..., -2.3386e-01,
           4.0858e-01, -1.3146e+00],
         [-5.7914e-02,  8.6956e-01,  4.8068e+00,  ..., -4.7792e-01,
          -4.4220e-01, -9.1739e-01],
         ...,
         [-7.3789e-01,  1.3040e+00,  6.1257e+00,  ..., -1.8337e-01,
           3.7008e-02, -3.5466e-01],
         [-6.0698e-01,  1.2667e+00,  6.2724e+00,  ..., -3.4218e-01,
          -4.3055e-02, -1.5845e-01],
         [-6.2692e-01,  1.1547e+00,  6.1238e+00,  ..., -1.8883e-01,
          -3.1402e-01, -2.3962e-01]],

        [[ 2.4561e-01,  1.1160e+00,  4.0546e+00,  ...,  1.3269e-01,
           3.4174e-01, -6.3074e-01],
         [-2.0503e-01,  1.0248e+00,  4.8665e+00,  ..., -8.8804e-01,
           6.6730e-01, -1.0739e+00],
         [-4.1346e-01,  1.0916e+00,  4.2835e+00,  ...,  2.3107e-01,
           6.1976e-01, -1.1049e+00],
         ...,
         [-8.4316e-01,  9.4928e-01,  4.4014e+00,  ..., -4.3902e-01,
           4.3661e-01, -1.0834e+00],
         [ 4.0157e-01,  1.0139e+00,  4.8007e+00,  ..., -8.9306e-02,
           3.9637e-01, -8.3777e-01],
         [ 6.6030e-01,  5.2252e-01,  4.5827e+00,  ..., -1.3417e+00,
           4.1692e-01, -7.7413e-01]],

        ...,

        [[-4.4152e-01,  9.2547e-01,  4.4011e+00,  ...,  1.6546e-01,
           1.6010e-03, -1.0462e+00],
         [-6.1447e-01,  7.2585e-01,  3.6077e+00,  ..., -9.9841e-01,
           2.1894e-01, -1.1993e+00],
         [-5.6050e-01,  8.8003e-01,  3.9295e+00,  ...,  1.2085e-01,
           1.2933e-01, -4.0851e-01],
         ...,
         [-7.6105e-01,  1.1838e+00,  5.9384e+00,  ..., -2.4625e-01,
           3.9178e-01, -4.7760e-01],
         [-7.1512e-01,  6.0631e-01,  6.1028e+00,  ..., -2.4165e-01,
           3.0989e-01, -2.4361e-01],
         [-7.7287e-01,  1.0505e+00,  5.8456e+00,  ..., -6.3280e-01,
           2.1062e-01, -2.7979e-01]],

        [[ 2.4141e-01,  1.0307e+00,  4.5748e+00,  ...,  5.9026e-02,
          -2.8318e-01, -5.1186e-01],
         [-1.5057e+00,  1.0089e+00,  4.4241e+00,  ..., -3.4624e-01,
          -8.1144e-02, -9.2246e-01],
         [-7.7445e-02,  1.1548e+00,  4.3055e+00,  ..., -1.0233e+00,
           9.2632e-01, -6.0520e-01],
         ...,
         [-8.0913e-01,  1.3292e+00,  6.0625e+00,  ..., -2.2323e-01,
           1.2414e-01, -1.6214e-01],
         [-8.0908e-01,  1.1336e+00,  6.3589e+00,  ..., -1.4571e-01,
          -6.3754e-03,  2.3399e-01],
         [-6.6260e-01,  1.1533e+00,  6.0156e+00,  ..., -4.9134e-01,
           6.9744e-02,  2.6208e-01]],

        [[ 1.9677e-01,  8.2217e-01,  4.4645e+00,  ..., -1.7400e-02,
          -1.1675e-01, -1.3133e+00],
         [-3.5266e-01,  1.0403e+00,  4.9854e+00,  ..., -1.3088e-01,
           7.5025e-01, -1.2291e+00],
         [-2.4523e-01,  3.7901e-01,  4.8637e+00,  ..., -4.5624e-01,
           7.3854e-01, -4.8713e-01],
         ...,
         [-4.8599e-01,  1.2245e+00,  6.2722e+00,  ..., -6.5030e-01,
           2.3343e-01, -2.1468e-01],
         [-6.2546e-01,  1.0322e+00,  6.0094e+00,  ..., -6.4428e-01,
           4.8941e-01, -1.8510e-01],
         [-7.5447e-01,  1.1889e+00,  6.1305e+00,  ..., -6.8793e-01,
           1.8715e-01, -2.1225e-01]]], device='cuda:0',
       grad_fn=<GatherBackward>)
Tgt: tensor([[    0,    94,  2228,  ...,     2,     2,     2],
        [    0,  1160,   371,  ...,     2,     2,     2],
        [    0, 10809, 43553,  ...,   112,   115,     1],
        ...,
        [    0,  7740,    28,  ...,     2,     2,     2],
        [    0,   697,    22,  ...,     2,     2,     2],
        [    0,   306, 11600,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[ 1.4202e-01,  5.4669e-02, -3.4249e-01,  ..., -9.1230e-01,
          -4.6084e-01, -5.0101e-01],
         [ 1.0776e+00,  2.2613e+00,  1.5609e+00,  ...,  8.6584e-01,
           1.4053e+00,  9.4565e-01],
         [ 4.5030e+00,  4.3939e+00,  4.0865e+00,  ...,  6.5913e+00,
           6.3600e+00,  6.6111e+00],
         ...,
         [ 1.1128e-01, -8.4740e-01, -7.9783e-01,  ..., -5.8826e-01,
          -4.8950e-01, -2.0367e-01],
         [-5.5896e-01, -1.7797e-01,  2.0851e-01,  ..., -3.6116e-02,
          -4.1942e-01, -1.4782e-01],
         [-8.3980e-01, -1.0031e+00, -1.3947e+00,  ..., -6.4769e-02,
           9.8591e-02, -1.4433e-01]],

        [[-7.9184e-02, -1.1042e+00, -5.7914e-02,  ..., -7.3789e-01,
          -6.0698e-01, -6.2692e-01],
         [ 4.4090e-01,  1.0769e+00,  8.6956e-01,  ...,  1.3040e+00,
           1.2667e+00,  1.1547e+00],
         [ 4.6481e+00,  5.0587e+00,  4.8068e+00,  ...,  6.1257e+00,
           6.2724e+00,  6.1238e+00],
         ...,
         [ 3.0177e-01, -2.3386e-01, -4.7792e-01,  ..., -1.8337e-01,
          -3.4218e-01, -1.8883e-01],
         [-4.6846e-01,  4.0858e-01, -4.4220e-01,  ...,  3.7008e-02,
          -4.3055e-02, -3.1402e-01],
         [-1.0333e+00, -1.3146e+00, -9.1739e-01,  ..., -3.5466e-01,
          -1.5845e-01, -2.3962e-01]],

        [[ 2.4561e-01, -2.0503e-01, -4.1346e-01,  ..., -8.4316e-01,
           4.0157e-01,  6.6030e-01],
         [ 1.1160e+00,  1.0248e+00,  1.0916e+00,  ...,  9.4928e-01,
           1.0139e+00,  5.2252e-01],
         [ 4.0546e+00,  4.8665e+00,  4.2835e+00,  ...,  4.4014e+00,
           4.8007e+00,  4.5827e+00],
         ...,
         [ 1.3269e-01, -8.8804e-01,  2.3107e-01,  ..., -4.3902e-01,
          -8.9306e-02, -1.3417e+00],
         [ 3.4174e-01,  6.6730e-01,  6.1976e-01,  ...,  4.3661e-01,
           3.9637e-01,  4.1692e-01],
         [-6.3074e-01, -1.0739e+00, -1.1049e+00,  ..., -1.0834e+00,
          -8.3777e-01, -7.7413e-01]],

        ...,

        [[-4.4152e-01, -6.1447e-01, -5.6050e-01,  ..., -7.6105e-01,
          -7.1512e-01, -7.7287e-01],
         [ 9.2547e-01,  7.2585e-01,  8.8003e-01,  ...,  1.1838e+00,
           6.0631e-01,  1.0505e+00],
         [ 4.4011e+00,  3.6077e+00,  3.9295e+00,  ...,  5.9384e+00,
           6.1028e+00,  5.8456e+00],
         ...,
         [ 1.6546e-01, -9.9841e-01,  1.2085e-01,  ..., -2.4625e-01,
          -2.4165e-01, -6.3280e-01],
         [ 1.6010e-03,  2.1894e-01,  1.2933e-01,  ...,  3.9178e-01,
           3.0989e-01,  2.1062e-01],
         [-1.0462e+00, -1.1993e+00, -4.0851e-01,  ..., -4.7760e-01,
          -2.4361e-01, -2.7979e-01]],

        [[ 2.4141e-01, -1.5057e+00, -7.7445e-02,  ..., -8.0913e-01,
          -8.0908e-01, -6.6260e-01],
         [ 1.0307e+00,  1.0089e+00,  1.1548e+00,  ...,  1.3292e+00,
           1.1336e+00,  1.1533e+00],
         [ 4.5748e+00,  4.4241e+00,  4.3055e+00,  ...,  6.0625e+00,
           6.3589e+00,  6.0156e+00],
         ...,
         [ 5.9026e-02, -3.4624e-01, -1.0233e+00,  ..., -2.2323e-01,
          -1.4571e-01, -4.9134e-01],
         [-2.8318e-01, -8.1144e-02,  9.2632e-01,  ...,  1.2414e-01,
          -6.3754e-03,  6.9744e-02],
         [-5.1186e-01, -9.2246e-01, -6.0520e-01,  ..., -1.6214e-01,
           2.3399e-01,  2.6208e-01]],

        [[ 1.9677e-01, -3.5266e-01, -2.4523e-01,  ..., -4.8599e-01,
          -6.2546e-01, -7.5447e-01],
         [ 8.2217e-01,  1.0403e+00,  3.7901e-01,  ...,  1.2245e+00,
           1.0322e+00,  1.1889e+00],
         [ 4.4645e+00,  4.9854e+00,  4.8637e+00,  ...,  6.2722e+00,
           6.0094e+00,  6.1305e+00],
         ...,
         [-1.7400e-02, -1.3088e-01, -4.5624e-01,  ..., -6.5030e-01,
          -6.4428e-01, -6.8793e-01],
         [-1.1675e-01,  7.5025e-01,  7.3854e-01,  ...,  2.3343e-01,
           4.8941e-01,  1.8715e-01],
         [-1.3133e+00, -1.2291e+00, -4.8713e-01,  ..., -2.1468e-01,
          -1.8510e-01, -2.1225e-01]]], device='cuda:0',
       grad_fn=<PermuteBackward0>)
Tgt: tensor([[    0,    94,  2228,  ...,     2,     2,     2],
        [    0,  1160,   371,  ...,     2,     2,     2],
        [    0, 10809, 43553,  ...,   112,   115,     1],
        ...,
        [    0,  7740,    28,  ...,     2,     2,     2],
        [    0,   697,    22,  ...,     2,     2,     2],
        [    0,   306, 11600,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[ 1.4202e-01,  5.4669e-02, -3.4249e-01,  ..., -9.1230e-01,
          -4.6084e-01, -5.0101e-01],
         [ 1.0776e+00,  2.2613e+00,  1.5609e+00,  ...,  8.6584e-01,
           1.4053e+00,  9.4565e-01],
         [ 4.5030e+00,  4.3939e+00,  4.0865e+00,  ...,  6.5913e+00,
           6.3600e+00,  6.6111e+00],
         ...,
         [ 1.1128e-01, -8.4740e-01, -7.9783e-01,  ..., -5.8826e-01,
          -4.8950e-01, -2.0367e-01],
         [-5.5896e-01, -1.7797e-01,  2.0851e-01,  ..., -3.6116e-02,
          -4.1942e-01, -1.4782e-01],
         [-8.3980e-01, -1.0031e+00, -1.3947e+00,  ..., -6.4769e-02,
           9.8591e-02, -1.4433e-01]],

        [[-7.9184e-02, -1.1042e+00, -5.7914e-02,  ..., -7.3789e-01,
          -6.0698e-01, -6.2692e-01],
         [ 4.4090e-01,  1.0769e+00,  8.6956e-01,  ...,  1.3040e+00,
           1.2667e+00,  1.1547e+00],
         [ 4.6481e+00,  5.0587e+00,  4.8068e+00,  ...,  6.1257e+00,
           6.2724e+00,  6.1238e+00],
         ...,
         [ 3.0177e-01, -2.3386e-01, -4.7792e-01,  ..., -1.8337e-01,
          -3.4218e-01, -1.8883e-01],
         [-4.6846e-01,  4.0858e-01, -4.4220e-01,  ...,  3.7008e-02,
          -4.3055e-02, -3.1402e-01],
         [-1.0333e+00, -1.3146e+00, -9.1739e-01,  ..., -3.5466e-01,
          -1.5845e-01, -2.3962e-01]],

        [[ 2.4561e-01, -2.0503e-01, -4.1346e-01,  ..., -8.4316e-01,
           4.0157e-01,  6.6030e-01],
         [ 1.1160e+00,  1.0248e+00,  1.0916e+00,  ...,  9.4928e-01,
           1.0139e+00,  5.2252e-01],
         [ 4.0546e+00,  4.8665e+00,  4.2835e+00,  ...,  4.4014e+00,
           4.8007e+00,  4.5827e+00],
         ...,
         [ 1.3269e-01, -8.8804e-01,  2.3107e-01,  ..., -4.3902e-01,
          -8.9306e-02, -1.3417e+00],
         [ 3.4174e-01,  6.6730e-01,  6.1976e-01,  ...,  4.3661e-01,
           3.9637e-01,  4.1692e-01],
         [-6.3074e-01, -1.0739e+00, -1.1049e+00,  ..., -1.0834e+00,
          -8.3777e-01, -7.7413e-01]],

        ...,

        [[-4.4152e-01, -6.1447e-01, -5.6050e-01,  ..., -7.6105e-01,
          -7.1512e-01, -7.7287e-01],
         [ 9.2547e-01,  7.2585e-01,  8.8003e-01,  ...,  1.1838e+00,
           6.0631e-01,  1.0505e+00],
         [ 4.4011e+00,  3.6077e+00,  3.9295e+00,  ...,  5.9384e+00,
           6.1028e+00,  5.8456e+00],
         ...,
         [ 1.6546e-01, -9.9841e-01,  1.2085e-01,  ..., -2.4625e-01,
          -2.4165e-01, -6.3280e-01],
         [ 1.6010e-03,  2.1894e-01,  1.2933e-01,  ...,  3.9178e-01,
           3.0989e-01,  2.1062e-01],
         [-1.0462e+00, -1.1993e+00, -4.0851e-01,  ..., -4.7760e-01,
          -2.4361e-01, -2.7979e-01]],

        [[ 2.4141e-01, -1.5057e+00, -7.7445e-02,  ..., -8.0913e-01,
          -8.0908e-01, -6.6260e-01],
         [ 1.0307e+00,  1.0089e+00,  1.1548e+00,  ...,  1.3292e+00,
           1.1336e+00,  1.1533e+00],
         [ 4.5748e+00,  4.4241e+00,  4.3055e+00,  ...,  6.0625e+00,
           6.3589e+00,  6.0156e+00],
         ...,
         [ 5.9026e-02, -3.4624e-01, -1.0233e+00,  ..., -2.2323e-01,
          -1.4571e-01, -4.9134e-01],
         [-2.8318e-01, -8.1144e-02,  9.2632e-01,  ...,  1.2414e-01,
          -6.3754e-03,  6.9744e-02],
         [-5.1186e-01, -9.2246e-01, -6.0520e-01,  ..., -1.6214e-01,
           2.3399e-01,  2.6208e-01]],

        [[ 1.9677e-01, -3.5266e-01, -2.4523e-01,  ..., -4.8599e-01,
          -6.2546e-01, -7.5447e-01],
         [ 8.2217e-01,  1.0403e+00,  3.7901e-01,  ...,  1.2245e+00,
           1.0322e+00,  1.1889e+00],
         [ 4.4645e+00,  4.9854e+00,  4.8637e+00,  ...,  6.2722e+00,
           6.0094e+00,  6.1305e+00],
         ...,
         [-1.7400e-02, -1.3088e-01, -4.5624e-01,  ..., -6.5030e-01,
          -6.4428e-01, -6.8793e-01],
         [-1.1675e-01,  7.5025e-01,  7.3854e-01,  ...,  2.3343e-01,
           4.8941e-01,  1.8715e-01],
         [-1.3133e+00, -1.2291e+00, -4.8713e-01,  ..., -2.1468e-01,
          -1.8510e-01, -2.1225e-01]]], device='cuda:0',
       grad_fn=<PermuteBackward0>)
Tgt: tensor([[   94,  2228,    14,  ...,     2,     2,     2],
        [ 1160,   371,  3217,  ...,     2,     2,     2],
        [10809, 43553, 21659,  ...,   112,   115,     1],
        ...,
        [ 7740,    28, 27068,  ...,     2,     2,     2],
        [  697,    22,  8449,  ...,     2,     2,     2],
        [  306, 11600,  5647,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[ 2.2295e-01,  1.7593e+00,  4.8887e+00,  ..., -4.2517e-01,
          -9.2965e-02, -1.0891e+00],
         [-3.2458e-01,  1.3496e+00,  4.7256e+00,  ..., -6.1718e-01,
           2.9154e-01, -1.0467e+00],
         [-7.6269e-01,  7.3947e-01,  4.8390e+00,  ..., -6.8231e-01,
           4.2450e-01, -3.8028e-01],
         ...,
         [-9.0131e-01,  1.4684e+00,  6.7705e+00,  ..., -3.3712e-01,
           2.2845e-02, -2.1389e-01],
         [-6.2776e-01,  1.5599e+00,  6.7553e+00,  ..., -3.8992e-01,
           1.6533e-01,  3.2669e-02],
         [-6.1303e-01,  1.2884e+00,  6.9979e+00,  ..., -4.4576e-01,
           2.4488e-01, -8.1304e-02]],

        [[ 2.4929e-01,  9.2668e-01,  5.2063e+00,  ...,  2.4090e-01,
          -7.3459e-02, -1.4542e+00],
         [-1.2003e+00,  1.0889e+00,  5.0414e+00,  ..., -4.3044e-01,
           2.0110e-02, -1.6777e+00],
         [-3.1296e-01,  1.1753e+00,  4.8609e+00,  ..., -1.1233e+00,
           5.5521e-01, -1.2719e+00],
         ...,
         [-1.6685e-01,  9.4433e-01,  6.9466e+00,  ..., -2.1157e-01,
           2.7503e-01, -5.1675e-01],
         [-2.3568e-01,  7.7151e-01,  6.3902e+00,  ..., -1.3161e-01,
           8.9896e-02, -2.5266e-01],
         [-4.0874e-01,  9.3006e-01,  6.7939e+00,  ..., -2.7924e-01,
           4.7611e-01, -2.4709e-01]],

        [[-5.4245e-01,  9.1639e-01,  4.6947e+00,  ..., -2.0470e-01,
          -1.2429e-01, -1.0494e+00],
         [-1.0715e+00,  1.7015e+00,  4.6103e+00,  ..., -5.3675e-01,
           1.1033e-01, -1.2773e+00],
         [-9.4523e-01,  1.6395e+00,  4.5613e+00,  ..., -9.8502e-01,
           1.0943e-03, -1.6740e+00],
         ...,
         [-1.0127e+00,  1.5083e+00,  6.4680e+00,  ..., -1.4722e-01,
           3.0464e-01, -8.2941e-01],
         [-1.2838e+00,  1.4620e+00,  6.7394e+00,  ..., -4.0486e-01,
           6.2109e-01, -9.5575e-01],
         [-1.0017e+00,  1.3797e+00,  6.6183e+00,  ..., -6.4280e-01,
           5.0996e-01, -4.9124e-01]],

        ...,

        [[ 3.8316e-01,  1.7110e+00,  4.9958e+00,  ..., -1.9404e-03,
           8.0239e-02, -8.3312e-01],
         [-7.1879e-01,  1.7118e+00,  3.8836e+00,  ..., -1.3212e+00,
          -5.7882e-02, -7.3197e-01],
         [-1.1821e-01,  9.6694e-01,  5.4221e+00,  ..., -1.2044e-01,
           9.7045e-02, -9.3516e-01],
         ...,
         [-4.0536e-01,  1.4766e+00,  6.9141e+00,  ..., -2.2242e-01,
           2.5467e-01,  6.4305e-02],
         [-7.3553e-01,  1.3350e+00,  6.4534e+00,  ..., -4.3552e-01,
           4.2476e-01, -1.4452e-01],
         [-8.9834e-01,  1.5795e+00,  6.9218e+00,  ..., -4.7995e-01,
           3.1668e-01,  3.6859e-01]],

        [[ 1.1443e-01,  1.3103e+00,  4.9043e+00,  ..., -1.5215e-01,
          -7.2952e-02, -5.9670e-01],
         [-5.2027e-01,  1.0568e+00,  4.0413e+00,  ..., -4.6580e-01,
           3.1150e-01, -4.7262e-01],
         [-6.6843e-02,  1.1669e+00,  4.8105e+00,  ..., -3.7149e-01,
          -4.1297e-01, -1.1645e+00],
         ...,
         [-7.6393e-01,  1.3413e+00,  7.0063e+00,  ..., -4.0290e-01,
           3.9736e-01, -7.3343e-01],
         [-5.5450e-01,  1.7822e+00,  6.6066e+00,  ..., -6.6256e-01,
           7.3678e-01, -2.9899e-01],
         [ 1.4392e-01,  1.6815e+00,  6.8249e+00,  ..., -5.4567e-01,
           4.7322e-01,  2.6829e-01]],

        [[ 2.1691e-01,  1.4613e+00,  5.0116e+00,  ...,  2.4768e-01,
           1.4529e-01, -9.9415e-01],
         [-6.2142e-01,  7.8603e-01,  4.5085e+00,  ..., -3.0164e-01,
           2.9479e-01, -7.8815e-01],
         [ 3.3285e-02,  1.2572e+00,  5.2884e+00,  ..., -5.1919e-02,
           2.3625e-02, -9.2039e-01],
         ...,
         [-4.9019e-01,  1.4013e+00,  6.9419e+00,  ..., -1.8241e-01,
           4.6372e-01, -3.8777e-01],
         [-5.5413e-01,  1.3329e+00,  6.8428e+00,  ..., -2.8378e-01,
           6.5671e-01, -5.6572e-02],
         [-4.2690e-01,  1.4416e+00,  7.0410e+00,  ..., -2.1658e-01,
           8.4010e-01, -6.4129e-02]]], device='cuda:0',
       grad_fn=<GatherBackward>)
Tgt: tensor([[    0,  1003,  1090,  ...,     2,     2,     2],
        [    0,   697,    22,  ...,     2,     2,     2],
        [    0, 20055,    23,  ...,     2,     2,     2],
        ...,
        [    0,    40, 14182,  ...,     2,     2,     2],
        [    0,    55, 24819,  ...,     2,     2,     2],
        [    0,    55,   855,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[ 2.2295e-01, -3.2458e-01, -7.6269e-01,  ..., -9.0131e-01,
          -6.2776e-01, -6.1303e-01],
         [ 1.7593e+00,  1.3496e+00,  7.3947e-01,  ...,  1.4684e+00,
           1.5599e+00,  1.2884e+00],
         [ 4.8887e+00,  4.7256e+00,  4.8390e+00,  ...,  6.7705e+00,
           6.7553e+00,  6.9979e+00],
         ...,
         [-4.2517e-01, -6.1718e-01, -6.8231e-01,  ..., -3.3712e-01,
          -3.8992e-01, -4.4576e-01],
         [-9.2965e-02,  2.9154e-01,  4.2450e-01,  ...,  2.2845e-02,
           1.6533e-01,  2.4488e-01],
         [-1.0891e+00, -1.0467e+00, -3.8028e-01,  ..., -2.1389e-01,
           3.2669e-02, -8.1304e-02]],

        [[ 2.4929e-01, -1.2003e+00, -3.1296e-01,  ..., -1.6685e-01,
          -2.3568e-01, -4.0874e-01],
         [ 9.2668e-01,  1.0889e+00,  1.1753e+00,  ...,  9.4433e-01,
           7.7151e-01,  9.3006e-01],
         [ 5.2063e+00,  5.0414e+00,  4.8609e+00,  ...,  6.9466e+00,
           6.3902e+00,  6.7939e+00],
         ...,
         [ 2.4090e-01, -4.3044e-01, -1.1233e+00,  ..., -2.1157e-01,
          -1.3161e-01, -2.7924e-01],
         [-7.3459e-02,  2.0110e-02,  5.5521e-01,  ...,  2.7503e-01,
           8.9896e-02,  4.7611e-01],
         [-1.4542e+00, -1.6777e+00, -1.2719e+00,  ..., -5.1675e-01,
          -2.5266e-01, -2.4709e-01]],

        [[-5.4245e-01, -1.0715e+00, -9.4523e-01,  ..., -1.0127e+00,
          -1.2838e+00, -1.0017e+00],
         [ 9.1639e-01,  1.7015e+00,  1.6395e+00,  ...,  1.5083e+00,
           1.4620e+00,  1.3797e+00],
         [ 4.6947e+00,  4.6103e+00,  4.5613e+00,  ...,  6.4680e+00,
           6.7394e+00,  6.6183e+00],
         ...,
         [-2.0470e-01, -5.3675e-01, -9.8502e-01,  ..., -1.4722e-01,
          -4.0486e-01, -6.4280e-01],
         [-1.2429e-01,  1.1033e-01,  1.0943e-03,  ...,  3.0464e-01,
           6.2109e-01,  5.0996e-01],
         [-1.0494e+00, -1.2773e+00, -1.6740e+00,  ..., -8.2941e-01,
          -9.5575e-01, -4.9124e-01]],

        ...,

        [[ 3.8316e-01, -7.1879e-01, -1.1821e-01,  ..., -4.0536e-01,
          -7.3553e-01, -8.9834e-01],
         [ 1.7110e+00,  1.7118e+00,  9.6694e-01,  ...,  1.4766e+00,
           1.3350e+00,  1.5795e+00],
         [ 4.9958e+00,  3.8836e+00,  5.4221e+00,  ...,  6.9141e+00,
           6.4534e+00,  6.9218e+00],
         ...,
         [-1.9404e-03, -1.3212e+00, -1.2044e-01,  ..., -2.2242e-01,
          -4.3552e-01, -4.7995e-01],
         [ 8.0239e-02, -5.7882e-02,  9.7045e-02,  ...,  2.5467e-01,
           4.2476e-01,  3.1668e-01],
         [-8.3312e-01, -7.3197e-01, -9.3516e-01,  ...,  6.4305e-02,
          -1.4452e-01,  3.6859e-01]],

        [[ 1.1443e-01, -5.2027e-01, -6.6843e-02,  ..., -7.6393e-01,
          -5.5450e-01,  1.4392e-01],
         [ 1.3103e+00,  1.0568e+00,  1.1669e+00,  ...,  1.3413e+00,
           1.7822e+00,  1.6815e+00],
         [ 4.9043e+00,  4.0413e+00,  4.8105e+00,  ...,  7.0063e+00,
           6.6066e+00,  6.8249e+00],
         ...,
         [-1.5215e-01, -4.6580e-01, -3.7149e-01,  ..., -4.0290e-01,
          -6.6256e-01, -5.4567e-01],
         [-7.2952e-02,  3.1150e-01, -4.1297e-01,  ...,  3.9736e-01,
           7.3678e-01,  4.7322e-01],
         [-5.9670e-01, -4.7262e-01, -1.1645e+00,  ..., -7.3343e-01,
          -2.9899e-01,  2.6829e-01]],

        [[ 2.1691e-01, -6.2142e-01,  3.3285e-02,  ..., -4.9019e-01,
          -5.5413e-01, -4.2690e-01],
         [ 1.4613e+00,  7.8603e-01,  1.2572e+00,  ...,  1.4013e+00,
           1.3329e+00,  1.4416e+00],
         [ 5.0116e+00,  4.5085e+00,  5.2884e+00,  ...,  6.9419e+00,
           6.8428e+00,  7.0410e+00],
         ...,
         [ 2.4768e-01, -3.0164e-01, -5.1919e-02,  ..., -1.8241e-01,
          -2.8378e-01, -2.1658e-01],
         [ 1.4529e-01,  2.9479e-01,  2.3625e-02,  ...,  4.6372e-01,
           6.5671e-01,  8.4010e-01],
         [-9.9415e-01, -7.8815e-01, -9.2039e-01,  ..., -3.8777e-01,
          -5.6572e-02, -6.4129e-02]]], device='cuda:0',
       grad_fn=<PermuteBackward0>)
Tgt: tensor([[    0,  1003,  1090,  ...,     2,     2,     2],
        [    0,   697,    22,  ...,     2,     2,     2],
        [    0, 20055,    23,  ...,     2,     2,     2],
        ...,
        [    0,    40, 14182,  ...,     2,     2,     2],
        [    0,    55, 24819,  ...,     2,     2,     2],
        [    0,    55,   855,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[ 2.2295e-01, -3.2458e-01, -7.6269e-01,  ..., -9.0131e-01,
          -6.2776e-01, -6.1303e-01],
         [ 1.7593e+00,  1.3496e+00,  7.3947e-01,  ...,  1.4684e+00,
           1.5599e+00,  1.2884e+00],
         [ 4.8887e+00,  4.7256e+00,  4.8390e+00,  ...,  6.7705e+00,
           6.7553e+00,  6.9979e+00],
         ...,
         [-4.2517e-01, -6.1718e-01, -6.8231e-01,  ..., -3.3712e-01,
          -3.8992e-01, -4.4576e-01],
         [-9.2965e-02,  2.9154e-01,  4.2450e-01,  ...,  2.2845e-02,
           1.6533e-01,  2.4488e-01],
         [-1.0891e+00, -1.0467e+00, -3.8028e-01,  ..., -2.1389e-01,
           3.2669e-02, -8.1304e-02]],

        [[ 2.4929e-01, -1.2003e+00, -3.1296e-01,  ..., -1.6685e-01,
          -2.3568e-01, -4.0874e-01],
         [ 9.2668e-01,  1.0889e+00,  1.1753e+00,  ...,  9.4433e-01,
           7.7151e-01,  9.3006e-01],
         [ 5.2063e+00,  5.0414e+00,  4.8609e+00,  ...,  6.9466e+00,
           6.3902e+00,  6.7939e+00],
         ...,
         [ 2.4090e-01, -4.3044e-01, -1.1233e+00,  ..., -2.1157e-01,
          -1.3161e-01, -2.7924e-01],
         [-7.3459e-02,  2.0110e-02,  5.5521e-01,  ...,  2.7503e-01,
           8.9896e-02,  4.7611e-01],
         [-1.4542e+00, -1.6777e+00, -1.2719e+00,  ..., -5.1675e-01,
          -2.5266e-01, -2.4709e-01]],

        [[-5.4245e-01, -1.0715e+00, -9.4523e-01,  ..., -1.0127e+00,
          -1.2838e+00, -1.0017e+00],
         [ 9.1639e-01,  1.7015e+00,  1.6395e+00,  ...,  1.5083e+00,
           1.4620e+00,  1.3797e+00],
         [ 4.6947e+00,  4.6103e+00,  4.5613e+00,  ...,  6.4680e+00,
           6.7394e+00,  6.6183e+00],
         ...,
         [-2.0470e-01, -5.3675e-01, -9.8502e-01,  ..., -1.4722e-01,
          -4.0486e-01, -6.4280e-01],
         [-1.2429e-01,  1.1033e-01,  1.0943e-03,  ...,  3.0464e-01,
           6.2109e-01,  5.0996e-01],
         [-1.0494e+00, -1.2773e+00, -1.6740e+00,  ..., -8.2941e-01,
          -9.5575e-01, -4.9124e-01]],

        ...,

        [[ 3.8316e-01, -7.1879e-01, -1.1821e-01,  ..., -4.0536e-01,
          -7.3553e-01, -8.9834e-01],
         [ 1.7110e+00,  1.7118e+00,  9.6694e-01,  ...,  1.4766e+00,
           1.3350e+00,  1.5795e+00],
         [ 4.9958e+00,  3.8836e+00,  5.4221e+00,  ...,  6.9141e+00,
           6.4534e+00,  6.9218e+00],
         ...,
         [-1.9404e-03, -1.3212e+00, -1.2044e-01,  ..., -2.2242e-01,
          -4.3552e-01, -4.7995e-01],
         [ 8.0239e-02, -5.7882e-02,  9.7045e-02,  ...,  2.5467e-01,
           4.2476e-01,  3.1668e-01],
         [-8.3312e-01, -7.3197e-01, -9.3516e-01,  ...,  6.4305e-02,
          -1.4452e-01,  3.6859e-01]],

        [[ 1.1443e-01, -5.2027e-01, -6.6843e-02,  ..., -7.6393e-01,
          -5.5450e-01,  1.4392e-01],
         [ 1.3103e+00,  1.0568e+00,  1.1669e+00,  ...,  1.3413e+00,
           1.7822e+00,  1.6815e+00],
         [ 4.9043e+00,  4.0413e+00,  4.8105e+00,  ...,  7.0063e+00,
           6.6066e+00,  6.8249e+00],
         ...,
         [-1.5215e-01, -4.6580e-01, -3.7149e-01,  ..., -4.0290e-01,
          -6.6256e-01, -5.4567e-01],
         [-7.2952e-02,  3.1150e-01, -4.1297e-01,  ...,  3.9736e-01,
           7.3678e-01,  4.7322e-01],
         [-5.9670e-01, -4.7262e-01, -1.1645e+00,  ..., -7.3343e-01,
          -2.9899e-01,  2.6829e-01]],

        [[ 2.1691e-01, -6.2142e-01,  3.3285e-02,  ..., -4.9019e-01,
          -5.5413e-01, -4.2690e-01],
         [ 1.4613e+00,  7.8603e-01,  1.2572e+00,  ...,  1.4013e+00,
           1.3329e+00,  1.4416e+00],
         [ 5.0116e+00,  4.5085e+00,  5.2884e+00,  ...,  6.9419e+00,
           6.8428e+00,  7.0410e+00],
         ...,
         [ 2.4768e-01, -3.0164e-01, -5.1919e-02,  ..., -1.8241e-01,
          -2.8378e-01, -2.1658e-01],
         [ 1.4529e-01,  2.9479e-01,  2.3625e-02,  ...,  4.6372e-01,
           6.5671e-01,  8.4010e-01],
         [-9.9415e-01, -7.8815e-01, -9.2039e-01,  ..., -3.8777e-01,
          -5.6572e-02, -6.4129e-02]]], device='cuda:0',
       grad_fn=<PermuteBackward0>)
Tgt: tensor([[ 1003,  1090,    34,  ...,     2,     2,     2],
        [  697,    22,  8449,  ...,     2,     2,     2],
        [20055,    23,  1273,  ...,     2,     2,     2],
        ...,
        [   40, 14182,   789,  ...,     2,     2,     2],
        [   55, 24819,    15,  ...,     2,     2,     2],
        [   55,   855,    48,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[ 2.7970e-01,  1.2066e+00,  5.1870e+00,  ...,  1.9760e-01,
           1.4384e-01, -1.4395e+00],
         [ 6.2056e-02,  9.7204e-01,  5.0587e+00,  ..., -9.9757e-01,
          -3.7226e-01, -6.4692e-01],
         [-7.9569e-01,  8.6911e-01,  5.5207e+00,  ..., -5.6252e-01,
           1.7759e-01, -1.2050e+00],
         ...,
         [-3.6749e-01,  1.2516e+00,  7.1780e+00,  ..., -3.8724e-01,
           1.1153e-01, -4.4579e-01],
         [-1.2320e-01,  1.4831e+00,  6.9335e+00,  ..., -4.0926e-01,
           3.1230e-01, -1.9590e-01],
         [-5.1265e-01,  1.1218e+00,  7.6923e+00,  ..., -8.4940e-01,
           7.9766e-02, -3.1438e-03]],

        [[-1.3803e-01,  6.3158e-01,  5.4280e+00,  ...,  2.9022e-01,
          -1.0621e-01, -1.1054e+00],
         [-8.8678e-02,  9.5880e-01,  6.1711e+00,  ..., -1.4051e-02,
           4.6697e-01, -1.2339e+00],
         [-3.9319e-01,  5.7462e-01,  5.6397e+00,  ...,  1.0831e-01,
           7.0893e-02, -1.6437e+00],
         ...,
         [-1.0534e+00,  9.0675e-01,  7.2003e+00,  ..., -2.3940e-01,
           3.1018e-01, -5.9983e-01],
         [-7.7794e-01,  7.6805e-01,  7.3256e+00,  ..., -4.6087e-01,
           3.5078e-01, -5.6171e-01],
         [-5.9260e-01,  4.7365e-01,  7.1092e+00,  ..., -4.4446e-01,
           2.9353e-01, -5.1565e-01]],

        [[-4.2539e-01,  1.2393e+00,  5.5992e+00,  ..., -4.2186e-01,
          -2.5839e-02, -1.4968e+00],
         [-5.2997e-01,  7.5387e-01,  4.9087e+00,  ..., -4.8731e-01,
          -6.3884e-02, -1.2950e+00],
         [-4.8773e-01,  1.1108e+00,  5.1662e+00,  ..., -8.7419e-01,
          -1.6197e-01, -1.5887e+00],
         ...,
         [-8.8611e-01,  1.3321e+00,  7.1892e+00,  ..., -5.3317e-01,
           2.0477e-01, -1.0181e+00],
         [-1.2445e+00,  1.0211e+00,  7.3664e+00,  ..., -5.1436e-01,
           2.2641e-01, -4.3853e-01],
         [-4.8475e-01,  1.1948e+00,  7.0541e+00,  ..., -6.3390e-01,
           7.9155e-02, -8.9605e-01]],

        ...,

        [[-2.3728e-01,  6.3106e-01,  5.8855e+00,  ...,  6.8279e-02,
           2.8075e-01, -1.3684e+00],
         [-7.8785e-01,  1.0567e+00,  5.7469e+00,  ..., -7.3566e-01,
          -1.3814e-01, -1.8903e+00],
         [-4.9107e-01,  1.2408e+00,  4.7373e+00,  ...,  1.1580e-01,
          -1.7509e-01, -1.8670e+00],
         ...,
         [-5.7899e-01,  7.8160e-01,  7.5244e+00,  ..., -1.5681e-01,
           2.3256e-01, -5.0253e-01],
         [-1.1745e+00,  7.2876e-01,  7.4450e+00,  ...,  3.2145e-02,
           1.6879e-01, -7.1085e-01],
         [-6.6275e-01,  7.0079e-01,  7.4305e+00,  ..., -3.3592e-01,
          -1.4391e-01, -4.1821e-01]],

        [[-3.3368e-02,  1.2097e+00,  5.8633e+00,  ..., -3.3915e-01,
          -2.3104e-01, -1.0211e+00],
         [-5.8759e-01,  1.5279e+00,  4.9779e+00,  ..., -8.3087e-01,
          -7.6887e-03, -4.1607e-01],
         [-6.2548e-01,  1.1562e+00,  5.3853e+00,  ..., -1.1648e+00,
          -2.2417e-01, -1.6273e+00],
         ...,
         [-1.1331e+00,  1.1493e+00,  7.3734e+00,  ..., -7.2274e-01,
           2.2578e-01, -7.0035e-01],
         [-1.0341e+00,  7.0850e-01,  7.3644e+00,  ..., -7.3900e-01,
           1.8789e-01, -5.7687e-01],
         [-9.9102e-01,  1.4518e+00,  7.4369e+00,  ..., -8.8180e-01,
           1.1434e-01, -8.0264e-01]],

        [[ 2.6337e-01,  1.4373e+00,  4.8445e+00,  ...,  9.0218e-02,
           1.3242e-02, -6.7745e-01],
         [-2.1116e-01,  7.0445e-01,  5.3453e+00,  ..., -5.1323e-01,
           1.5483e-01, -1.6115e+00],
         [-1.0208e-01,  1.0303e+00,  5.0657e+00,  ..., -8.0587e-01,
           1.3056e-01, -4.5130e-01],
         ...,
         [-4.7917e-01,  1.0921e+00,  4.3830e+00,  ..., -1.1992e+00,
          -3.3452e-01, -7.1636e-01],
         [ 2.6964e-01, -4.5349e-02,  4.4662e+00,  ...,  3.3194e-02,
           4.8848e-01,  1.2143e-01],
         [-2.2241e-01,  1.2021e+00,  5.3377e+00,  ..., -3.2173e-01,
          -7.9778e-02, -5.0086e-01]]], device='cuda:0',
       grad_fn=<GatherBackward>)
Tgt: tensor([[    0,   128,  1834,  ...,     2,     2,     2],
        [    0,  4276,     1,  ...,     2,     2,     2],
        [    0,  2048,     1,  ...,     2,     2,     2],
        ...,
        [    0, 11103,   293,  ...,     2,     2,     2],
        [    0, 38979,     1,  ...,     2,     2,     2],
        [    0, 19335, 41281,  ...,   336,  1808,     1]], device='cuda:0')
Output: tensor([[[ 2.7970e-01,  6.2056e-02, -7.9569e-01,  ..., -3.6749e-01,
          -1.2320e-01, -5.1265e-01],
         [ 1.2066e+00,  9.7204e-01,  8.6911e-01,  ...,  1.2516e+00,
           1.4831e+00,  1.1218e+00],
         [ 5.1870e+00,  5.0587e+00,  5.5207e+00,  ...,  7.1780e+00,
           6.9335e+00,  7.6923e+00],
         ...,
         [ 1.9760e-01, -9.9757e-01, -5.6252e-01,  ..., -3.8724e-01,
          -4.0926e-01, -8.4940e-01],
         [ 1.4384e-01, -3.7226e-01,  1.7759e-01,  ...,  1.1153e-01,
           3.1230e-01,  7.9766e-02],
         [-1.4395e+00, -6.4692e-01, -1.2050e+00,  ..., -4.4579e-01,
          -1.9590e-01, -3.1438e-03]],

        [[-1.3803e-01, -8.8678e-02, -3.9319e-01,  ..., -1.0534e+00,
          -7.7794e-01, -5.9260e-01],
         [ 6.3158e-01,  9.5880e-01,  5.7462e-01,  ...,  9.0675e-01,
           7.6805e-01,  4.7365e-01],
         [ 5.4280e+00,  6.1711e+00,  5.6397e+00,  ...,  7.2003e+00,
           7.3256e+00,  7.1092e+00],
         ...,
         [ 2.9022e-01, -1.4051e-02,  1.0831e-01,  ..., -2.3940e-01,
          -4.6087e-01, -4.4446e-01],
         [-1.0621e-01,  4.6697e-01,  7.0893e-02,  ...,  3.1018e-01,
           3.5078e-01,  2.9353e-01],
         [-1.1054e+00, -1.2339e+00, -1.6437e+00,  ..., -5.9983e-01,
          -5.6171e-01, -5.1565e-01]],

        [[-4.2539e-01, -5.2997e-01, -4.8773e-01,  ..., -8.8611e-01,
          -1.2445e+00, -4.8475e-01],
         [ 1.2393e+00,  7.5387e-01,  1.1108e+00,  ...,  1.3321e+00,
           1.0211e+00,  1.1948e+00],
         [ 5.5992e+00,  4.9087e+00,  5.1662e+00,  ...,  7.1892e+00,
           7.3664e+00,  7.0541e+00],
         ...,
         [-4.2186e-01, -4.8731e-01, -8.7419e-01,  ..., -5.3317e-01,
          -5.1436e-01, -6.3390e-01],
         [-2.5839e-02, -6.3884e-02, -1.6197e-01,  ...,  2.0477e-01,
           2.2641e-01,  7.9155e-02],
         [-1.4968e+00, -1.2950e+00, -1.5887e+00,  ..., -1.0181e+00,
          -4.3853e-01, -8.9605e-01]],

        ...,

        [[-2.3728e-01, -7.8785e-01, -4.9107e-01,  ..., -5.7899e-01,
          -1.1745e+00, -6.6275e-01],
         [ 6.3106e-01,  1.0567e+00,  1.2408e+00,  ...,  7.8160e-01,
           7.2876e-01,  7.0079e-01],
         [ 5.8855e+00,  5.7469e+00,  4.7373e+00,  ...,  7.5244e+00,
           7.4450e+00,  7.4305e+00],
         ...,
         [ 6.8279e-02, -7.3566e-01,  1.1580e-01,  ..., -1.5681e-01,
           3.2145e-02, -3.3592e-01],
         [ 2.8075e-01, -1.3814e-01, -1.7509e-01,  ...,  2.3256e-01,
           1.6879e-01, -1.4391e-01],
         [-1.3684e+00, -1.8903e+00, -1.8670e+00,  ..., -5.0253e-01,
          -7.1085e-01, -4.1821e-01]],

        [[-3.3368e-02, -5.8759e-01, -6.2548e-01,  ..., -1.1331e+00,
          -1.0341e+00, -9.9102e-01],
         [ 1.2097e+00,  1.5279e+00,  1.1562e+00,  ...,  1.1493e+00,
           7.0850e-01,  1.4518e+00],
         [ 5.8633e+00,  4.9779e+00,  5.3853e+00,  ...,  7.3734e+00,
           7.3644e+00,  7.4369e+00],
         ...,
         [-3.3915e-01, -8.3087e-01, -1.1648e+00,  ..., -7.2274e-01,
          -7.3900e-01, -8.8180e-01],
         [-2.3104e-01, -7.6887e-03, -2.2417e-01,  ...,  2.2578e-01,
           1.8789e-01,  1.1434e-01],
         [-1.0211e+00, -4.1607e-01, -1.6273e+00,  ..., -7.0035e-01,
          -5.7687e-01, -8.0264e-01]],

        [[ 2.6337e-01, -2.1116e-01, -1.0208e-01,  ..., -4.7917e-01,
           2.6964e-01, -2.2241e-01],
         [ 1.4373e+00,  7.0445e-01,  1.0303e+00,  ...,  1.0921e+00,
          -4.5349e-02,  1.2021e+00],
         [ 4.8445e+00,  5.3453e+00,  5.0657e+00,  ...,  4.3830e+00,
           4.4662e+00,  5.3377e+00],
         ...,
         [ 9.0218e-02, -5.1323e-01, -8.0587e-01,  ..., -1.1992e+00,
           3.3194e-02, -3.2173e-01],
         [ 1.3242e-02,  1.5483e-01,  1.3056e-01,  ..., -3.3452e-01,
           4.8848e-01, -7.9778e-02],
         [-6.7745e-01, -1.6115e+00, -4.5130e-01,  ..., -7.1636e-01,
           1.2143e-01, -5.0086e-01]]], device='cuda:0',
       grad_fn=<PermuteBackward0>)
Tgt: tensor([[    0,   128,  1834,  ...,     2,     2,     2],
        [    0,  4276,     1,  ...,     2,     2,     2],
        [    0,  2048,     1,  ...,     2,     2,     2],
        ...,
        [    0, 11103,   293,  ...,     2,     2,     2],
        [    0, 38979,     1,  ...,     2,     2,     2],
        [    0, 19335, 41281,  ...,   336,  1808,     1]], device='cuda:0')
Output: tensor([[[ 2.7970e-01,  6.2056e-02, -7.9569e-01,  ..., -3.6749e-01,
          -1.2320e-01, -5.1265e-01],
         [ 1.2066e+00,  9.7204e-01,  8.6911e-01,  ...,  1.2516e+00,
           1.4831e+00,  1.1218e+00],
         [ 5.1870e+00,  5.0587e+00,  5.5207e+00,  ...,  7.1780e+00,
           6.9335e+00,  7.6923e+00],
         ...,
         [ 1.9760e-01, -9.9757e-01, -5.6252e-01,  ..., -3.8724e-01,
          -4.0926e-01, -8.4940e-01],
         [ 1.4384e-01, -3.7226e-01,  1.7759e-01,  ...,  1.1153e-01,
           3.1230e-01,  7.9766e-02],
         [-1.4395e+00, -6.4692e-01, -1.2050e+00,  ..., -4.4579e-01,
          -1.9590e-01, -3.1438e-03]],

        [[-1.3803e-01, -8.8678e-02, -3.9319e-01,  ..., -1.0534e+00,
          -7.7794e-01, -5.9260e-01],
         [ 6.3158e-01,  9.5880e-01,  5.7462e-01,  ...,  9.0675e-01,
           7.6805e-01,  4.7365e-01],
         [ 5.4280e+00,  6.1711e+00,  5.6397e+00,  ...,  7.2003e+00,
           7.3256e+00,  7.1092e+00],
         ...,
         [ 2.9022e-01, -1.4051e-02,  1.0831e-01,  ..., -2.3940e-01,
          -4.6087e-01, -4.4446e-01],
         [-1.0621e-01,  4.6697e-01,  7.0893e-02,  ...,  3.1018e-01,
           3.5078e-01,  2.9353e-01],
         [-1.1054e+00, -1.2339e+00, -1.6437e+00,  ..., -5.9983e-01,
          -5.6171e-01, -5.1565e-01]],

        [[-4.2539e-01, -5.2997e-01, -4.8773e-01,  ..., -8.8611e-01,
          -1.2445e+00, -4.8475e-01],
         [ 1.2393e+00,  7.5387e-01,  1.1108e+00,  ...,  1.3321e+00,
           1.0211e+00,  1.1948e+00],
         [ 5.5992e+00,  4.9087e+00,  5.1662e+00,  ...,  7.1892e+00,
           7.3664e+00,  7.0541e+00],
         ...,
         [-4.2186e-01, -4.8731e-01, -8.7419e-01,  ..., -5.3317e-01,
          -5.1436e-01, -6.3390e-01],
         [-2.5839e-02, -6.3884e-02, -1.6197e-01,  ...,  2.0477e-01,
           2.2641e-01,  7.9155e-02],
         [-1.4968e+00, -1.2950e+00, -1.5887e+00,  ..., -1.0181e+00,
          -4.3853e-01, -8.9605e-01]],

        ...,

        [[-2.3728e-01, -7.8785e-01, -4.9107e-01,  ..., -5.7899e-01,
          -1.1745e+00, -6.6275e-01],
         [ 6.3106e-01,  1.0567e+00,  1.2408e+00,  ...,  7.8160e-01,
           7.2876e-01,  7.0079e-01],
         [ 5.8855e+00,  5.7469e+00,  4.7373e+00,  ...,  7.5244e+00,
           7.4450e+00,  7.4305e+00],
         ...,
         [ 6.8279e-02, -7.3566e-01,  1.1580e-01,  ..., -1.5681e-01,
           3.2145e-02, -3.3592e-01],
         [ 2.8075e-01, -1.3814e-01, -1.7509e-01,  ...,  2.3256e-01,
           1.6879e-01, -1.4391e-01],
         [-1.3684e+00, -1.8903e+00, -1.8670e+00,  ..., -5.0253e-01,
          -7.1085e-01, -4.1821e-01]],

        [[-3.3368e-02, -5.8759e-01, -6.2548e-01,  ..., -1.1331e+00,
          -1.0341e+00, -9.9102e-01],
         [ 1.2097e+00,  1.5279e+00,  1.1562e+00,  ...,  1.1493e+00,
           7.0850e-01,  1.4518e+00],
         [ 5.8633e+00,  4.9779e+00,  5.3853e+00,  ...,  7.3734e+00,
           7.3644e+00,  7.4369e+00],
         ...,
         [-3.3915e-01, -8.3087e-01, -1.1648e+00,  ..., -7.2274e-01,
          -7.3900e-01, -8.8180e-01],
         [-2.3104e-01, -7.6887e-03, -2.2417e-01,  ...,  2.2578e-01,
           1.8789e-01,  1.1434e-01],
         [-1.0211e+00, -4.1607e-01, -1.6273e+00,  ..., -7.0035e-01,
          -5.7687e-01, -8.0264e-01]],

        [[ 2.6337e-01, -2.1116e-01, -1.0208e-01,  ..., -4.7917e-01,
           2.6964e-01, -2.2241e-01],
         [ 1.4373e+00,  7.0445e-01,  1.0303e+00,  ...,  1.0921e+00,
          -4.5349e-02,  1.2021e+00],
         [ 4.8445e+00,  5.3453e+00,  5.0657e+00,  ...,  4.3830e+00,
           4.4662e+00,  5.3377e+00],
         ...,
         [ 9.0218e-02, -5.1323e-01, -8.0587e-01,  ..., -1.1992e+00,
           3.3194e-02, -3.2173e-01],
         [ 1.3242e-02,  1.5483e-01,  1.3056e-01,  ..., -3.3452e-01,
           4.8848e-01, -7.9778e-02],
         [-6.7745e-01, -1.6115e+00, -4.5130e-01,  ..., -7.1636e-01,
           1.2143e-01, -5.0086e-01]]], device='cuda:0',
       grad_fn=<PermuteBackward0>)
Tgt: tensor([[  128,  1834,  1432,  ...,     2,     2,     2],
        [ 4276,     1,     2,  ...,     2,     2,     2],
        [ 2048,     1,     2,  ...,     2,     2,     2],
        ...,
        [11103,   293,  1243,  ...,     2,     2,     2],
        [38979,     1,     2,  ...,     2,     2,     2],
        [19335, 41281, 13880,  ...,   336,  1808,     1]], device='cuda:0')
Output: tensor([[[-9.1934e-02,  1.1400e+00,  6.1154e+00,  ..., -1.9526e-01,
          -1.1180e-01, -1.0881e+00],
         [-6.3210e-01,  6.7671e-01,  5.8993e+00,  ..., -8.3304e-01,
           1.3660e-01, -1.3160e+00],
         [-3.5438e-01,  7.7808e-01,  6.6245e+00,  ..., -1.2857e+00,
           3.6901e-01, -8.0779e-01],
         ...,
         [-6.7419e-01,  1.1936e+00,  7.9190e+00,  ..., -5.2182e-01,
           7.8637e-02, -1.9894e-01],
         [-6.2312e-01,  9.3323e-01,  8.1845e+00,  ..., -4.0067e-01,
           2.3653e-01, -5.1565e-01],
         [-6.9980e-01,  1.4642e+00,  7.9456e+00,  ..., -6.7286e-01,
           3.6574e-01, -4.6077e-01]],

        [[ 1.4328e-01,  1.3741e+00,  6.1355e+00,  ..., -2.7486e-01,
          -3.1440e-01, -9.6596e-01],
         [-3.0843e-01,  1.4259e+00,  5.7648e+00,  ..., -8.3359e-01,
          -5.6346e-01, -1.0988e+00],
         [-1.1022e+00,  1.5477e+00,  5.4905e+00,  ..., -1.0732e+00,
          -1.5218e-01, -3.4488e-01],
         ...,
         [-6.2861e-01,  1.5691e+00,  8.2099e+00,  ..., -5.0051e-01,
           1.1406e-01, -8.4342e-02],
         [-6.5399e-01,  1.4154e+00,  8.0909e+00,  ..., -4.1190e-01,
          -1.1289e-01, -1.5888e-01],
         [-8.8007e-01,  1.3508e+00,  7.9190e+00,  ..., -3.7429e-01,
          -8.5804e-02, -4.6870e-01]],

        [[-1.2143e-01,  7.6841e-01,  6.2770e+00,  ..., -2.0244e-01,
          -2.7439e-01, -4.6432e-01],
         [ 1.1744e-01,  9.1179e-01,  5.8753e+00,  ..., -1.1313e+00,
          -2.2743e-01, -5.1515e-01],
         [ 3.4155e-01,  6.2112e-01,  5.7033e+00,  ...,  2.4111e-01,
          -5.7380e-01, -1.5393e-01],
         ...,
         [-5.0160e-01,  6.1666e-01,  8.0660e+00,  ..., -3.0791e-01,
           3.4192e-01,  1.6690e-01],
         [-2.9462e-01,  1.0534e+00,  8.2595e+00,  ..., -9.1110e-01,
           1.4227e-01, -1.8332e-01],
         [-5.4920e-01,  1.2377e+00,  8.1400e+00,  ..., -3.8486e-01,
           3.8665e-01,  2.5741e-02]],

        ...,

        [[ 3.8323e-01,  1.1165e+00,  5.5698e+00,  ...,  1.0641e-01,
          -3.8511e-01, -1.1749e+00],
         [-2.9725e-01,  1.3417e+00,  5.5243e+00,  ..., -5.4584e-01,
          -3.5225e-01, -1.3837e+00],
         [-2.3717e-01,  1.8664e+00,  5.4639e+00,  ..., -8.6621e-01,
           7.1736e-01, -7.2292e-01],
         ...,
         [-9.1576e-01,  1.4028e+00,  7.8418e+00,  ..., -1.5394e-01,
           1.3053e-03, -7.0617e-01],
         [-6.0589e-01,  1.7073e+00,  7.7154e+00,  ..., -3.7756e-01,
           3.4102e-01, -6.3533e-01],
         [-7.5567e-01,  1.2820e+00,  7.7361e+00,  ..., -4.6383e-01,
          -4.0208e-01, -6.0521e-01]],

        [[ 9.2355e-02,  1.2220e+00,  5.5050e+00,  ..., -2.2313e-01,
           1.6538e-01, -1.2067e+00],
         [-2.0982e-01,  1.1019e+00,  6.4524e+00,  ..., -1.3700e-01,
          -1.3251e-01, -1.2413e+00],
         [-2.3093e-01,  9.2238e-01,  6.0409e+00,  ...,  6.6189e-01,
           2.1934e-01, -1.0952e+00],
         ...,
         [-7.4527e-01,  1.0363e+00,  7.8453e+00,  ..., -3.5499e-01,
           4.1691e-01,  6.5587e-02],
         [-2.5622e-01,  1.3135e+00,  7.9650e+00,  ..., -2.2557e-01,
           7.2639e-01,  1.5464e-01],
         [-7.1766e-01,  1.3925e+00,  8.0023e+00,  ..., -2.4741e-01,
           2.4778e-01,  5.8086e-02]],

        [[ 5.6395e-01,  1.0535e+00,  5.3290e+00,  ...,  2.6815e-01,
          -1.6615e-01, -3.0072e-01],
         [-6.1241e-02,  6.9666e-01,  5.1080e+00,  ..., -2.8003e-01,
           5.1551e-01, -6.7146e-01],
         [ 1.6922e-01,  9.2457e-01,  5.7496e+00,  ..., -2.7451e-01,
          -4.1918e-01, -7.7501e-01],
         ...,
         [-5.2100e-01,  1.1784e-01,  5.8348e+00,  ..., -2.8839e-01,
           6.7735e-02,  2.0710e-01],
         [-2.0194e-01,  1.2649e+00,  5.7317e+00,  ..., -5.7161e-01,
           4.4114e-01,  3.6015e-03],
         [-3.0744e-01,  8.8562e-01,  6.2434e+00,  ..., -1.4489e+00,
           4.0450e-01, -1.6417e-01]]], device='cuda:0',
       grad_fn=<GatherBackward>)
Tgt: tensor([[    0,   804,    14,  ...,     2,     2,     2],
        [    0,   145,    27,  ...,     2,     2,     2],
        [    0, 38857,   721,  ...,     2,     2,     2],
        ...,
        [    0,  8626, 30580,  ...,     2,     2,     2],
        [    0,   565,    21,  ...,     2,     2,     2],
        [    0,  1198, 21561,  ..., 28279,    14,     1]], device='cuda:0')
Output: tensor([[[-9.1934e-02, -6.3210e-01, -3.5438e-01,  ..., -6.7419e-01,
          -6.2312e-01, -6.9980e-01],
         [ 1.1400e+00,  6.7671e-01,  7.7808e-01,  ...,  1.1936e+00,
           9.3323e-01,  1.4642e+00],
         [ 6.1154e+00,  5.8993e+00,  6.6245e+00,  ...,  7.9190e+00,
           8.1845e+00,  7.9456e+00],
         ...,
         [-1.9526e-01, -8.3304e-01, -1.2857e+00,  ..., -5.2182e-01,
          -4.0067e-01, -6.7286e-01],
         [-1.1180e-01,  1.3660e-01,  3.6901e-01,  ...,  7.8637e-02,
           2.3653e-01,  3.6574e-01],
         [-1.0881e+00, -1.3160e+00, -8.0779e-01,  ..., -1.9894e-01,
          -5.1565e-01, -4.6077e-01]],

        [[ 1.4328e-01, -3.0843e-01, -1.1022e+00,  ..., -6.2861e-01,
          -6.5399e-01, -8.8007e-01],
         [ 1.3741e+00,  1.4259e+00,  1.5477e+00,  ...,  1.5691e+00,
           1.4154e+00,  1.3508e+00],
         [ 6.1355e+00,  5.7648e+00,  5.4905e+00,  ...,  8.2099e+00,
           8.0909e+00,  7.9190e+00],
         ...,
         [-2.7486e-01, -8.3359e-01, -1.0732e+00,  ..., -5.0051e-01,
          -4.1190e-01, -3.7429e-01],
         [-3.1440e-01, -5.6346e-01, -1.5218e-01,  ...,  1.1406e-01,
          -1.1289e-01, -8.5804e-02],
         [-9.6596e-01, -1.0988e+00, -3.4488e-01,  ..., -8.4342e-02,
          -1.5888e-01, -4.6870e-01]],

        [[-1.2143e-01,  1.1744e-01,  3.4155e-01,  ..., -5.0160e-01,
          -2.9462e-01, -5.4920e-01],
         [ 7.6841e-01,  9.1179e-01,  6.2112e-01,  ...,  6.1666e-01,
           1.0534e+00,  1.2377e+00],
         [ 6.2770e+00,  5.8753e+00,  5.7033e+00,  ...,  8.0660e+00,
           8.2595e+00,  8.1400e+00],
         ...,
         [-2.0244e-01, -1.1313e+00,  2.4111e-01,  ..., -3.0791e-01,
          -9.1110e-01, -3.8486e-01],
         [-2.7439e-01, -2.2743e-01, -5.7380e-01,  ...,  3.4192e-01,
           1.4227e-01,  3.8665e-01],
         [-4.6432e-01, -5.1515e-01, -1.5393e-01,  ...,  1.6690e-01,
          -1.8332e-01,  2.5741e-02]],

        ...,

        [[ 3.8323e-01, -2.9725e-01, -2.3717e-01,  ..., -9.1576e-01,
          -6.0589e-01, -7.5567e-01],
         [ 1.1165e+00,  1.3417e+00,  1.8664e+00,  ...,  1.4028e+00,
           1.7073e+00,  1.2820e+00],
         [ 5.5698e+00,  5.5243e+00,  5.4639e+00,  ...,  7.8418e+00,
           7.7154e+00,  7.7361e+00],
         ...,
         [ 1.0641e-01, -5.4584e-01, -8.6621e-01,  ..., -1.5394e-01,
          -3.7756e-01, -4.6383e-01],
         [-3.8511e-01, -3.5225e-01,  7.1736e-01,  ...,  1.3053e-03,
           3.4102e-01, -4.0208e-01],
         [-1.1749e+00, -1.3837e+00, -7.2292e-01,  ..., -7.0617e-01,
          -6.3533e-01, -6.0521e-01]],

        [[ 9.2355e-02, -2.0982e-01, -2.3093e-01,  ..., -7.4527e-01,
          -2.5622e-01, -7.1766e-01],
         [ 1.2220e+00,  1.1019e+00,  9.2238e-01,  ...,  1.0363e+00,
           1.3135e+00,  1.3925e+00],
         [ 5.5050e+00,  6.4524e+00,  6.0409e+00,  ...,  7.8453e+00,
           7.9650e+00,  8.0023e+00],
         ...,
         [-2.2313e-01, -1.3700e-01,  6.6189e-01,  ..., -3.5499e-01,
          -2.2557e-01, -2.4741e-01],
         [ 1.6538e-01, -1.3251e-01,  2.1934e-01,  ...,  4.1691e-01,
           7.2639e-01,  2.4778e-01],
         [-1.2067e+00, -1.2413e+00, -1.0952e+00,  ...,  6.5587e-02,
           1.5464e-01,  5.8086e-02]],

        [[ 5.6395e-01, -6.1241e-02,  1.6922e-01,  ..., -5.2100e-01,
          -2.0194e-01, -3.0744e-01],
         [ 1.0535e+00,  6.9666e-01,  9.2457e-01,  ...,  1.1784e-01,
           1.2649e+00,  8.8562e-01],
         [ 5.3290e+00,  5.1080e+00,  5.7496e+00,  ...,  5.8348e+00,
           5.7317e+00,  6.2434e+00],
         ...,
         [ 2.6815e-01, -2.8003e-01, -2.7451e-01,  ..., -2.8839e-01,
          -5.7161e-01, -1.4489e+00],
         [-1.6615e-01,  5.1551e-01, -4.1918e-01,  ...,  6.7735e-02,
           4.4114e-01,  4.0450e-01],
         [-3.0072e-01, -6.7146e-01, -7.7501e-01,  ...,  2.0710e-01,
           3.6015e-03, -1.6417e-01]]], device='cuda:0',
       grad_fn=<PermuteBackward0>)
Tgt: tensor([[    0,   804,    14,  ...,     2,     2,     2],
        [    0,   145,    27,  ...,     2,     2,     2],
        [    0, 38857,   721,  ...,     2,     2,     2],
        ...,
        [    0,  8626, 30580,  ...,     2,     2,     2],
        [    0,   565,    21,  ...,     2,     2,     2],
        [    0,  1198, 21561,  ..., 28279,    14,     1]], device='cuda:0')
Output: tensor([[[-9.1934e-02, -6.3210e-01, -3.5438e-01,  ..., -6.7419e-01,
          -6.2312e-01, -6.9980e-01],
         [ 1.1400e+00,  6.7671e-01,  7.7808e-01,  ...,  1.1936e+00,
           9.3323e-01,  1.4642e+00],
         [ 6.1154e+00,  5.8993e+00,  6.6245e+00,  ...,  7.9190e+00,
           8.1845e+00,  7.9456e+00],
         ...,
         [-1.9526e-01, -8.3304e-01, -1.2857e+00,  ..., -5.2182e-01,
          -4.0067e-01, -6.7286e-01],
         [-1.1180e-01,  1.3660e-01,  3.6901e-01,  ...,  7.8637e-02,
           2.3653e-01,  3.6574e-01],
         [-1.0881e+00, -1.3160e+00, -8.0779e-01,  ..., -1.9894e-01,
          -5.1565e-01, -4.6077e-01]],

        [[ 1.4328e-01, -3.0843e-01, -1.1022e+00,  ..., -6.2861e-01,
          -6.5399e-01, -8.8007e-01],
         [ 1.3741e+00,  1.4259e+00,  1.5477e+00,  ...,  1.5691e+00,
           1.4154e+00,  1.3508e+00],
         [ 6.1355e+00,  5.7648e+00,  5.4905e+00,  ...,  8.2099e+00,
           8.0909e+00,  7.9190e+00],
         ...,
         [-2.7486e-01, -8.3359e-01, -1.0732e+00,  ..., -5.0051e-01,
          -4.1190e-01, -3.7429e-01],
         [-3.1440e-01, -5.6346e-01, -1.5218e-01,  ...,  1.1406e-01,
          -1.1289e-01, -8.5804e-02],
         [-9.6596e-01, -1.0988e+00, -3.4488e-01,  ..., -8.4342e-02,
          -1.5888e-01, -4.6870e-01]],

        [[-1.2143e-01,  1.1744e-01,  3.4155e-01,  ..., -5.0160e-01,
          -2.9462e-01, -5.4920e-01],
         [ 7.6841e-01,  9.1179e-01,  6.2112e-01,  ...,  6.1666e-01,
           1.0534e+00,  1.2377e+00],
         [ 6.2770e+00,  5.8753e+00,  5.7033e+00,  ...,  8.0660e+00,
           8.2595e+00,  8.1400e+00],
         ...,
         [-2.0244e-01, -1.1313e+00,  2.4111e-01,  ..., -3.0791e-01,
          -9.1110e-01, -3.8486e-01],
         [-2.7439e-01, -2.2743e-01, -5.7380e-01,  ...,  3.4192e-01,
           1.4227e-01,  3.8665e-01],
         [-4.6432e-01, -5.1515e-01, -1.5393e-01,  ...,  1.6690e-01,
          -1.8332e-01,  2.5741e-02]],

        ...,

        [[ 3.8323e-01, -2.9725e-01, -2.3717e-01,  ..., -9.1576e-01,
          -6.0589e-01, -7.5567e-01],
         [ 1.1165e+00,  1.3417e+00,  1.8664e+00,  ...,  1.4028e+00,
           1.7073e+00,  1.2820e+00],
         [ 5.5698e+00,  5.5243e+00,  5.4639e+00,  ...,  7.8418e+00,
           7.7154e+00,  7.7361e+00],
         ...,
         [ 1.0641e-01, -5.4584e-01, -8.6621e-01,  ..., -1.5394e-01,
          -3.7756e-01, -4.6383e-01],
         [-3.8511e-01, -3.5225e-01,  7.1736e-01,  ...,  1.3053e-03,
           3.4102e-01, -4.0208e-01],
         [-1.1749e+00, -1.3837e+00, -7.2292e-01,  ..., -7.0617e-01,
          -6.3533e-01, -6.0521e-01]],

        [[ 9.2355e-02, -2.0982e-01, -2.3093e-01,  ..., -7.4527e-01,
          -2.5622e-01, -7.1766e-01],
         [ 1.2220e+00,  1.1019e+00,  9.2238e-01,  ...,  1.0363e+00,
           1.3135e+00,  1.3925e+00],
         [ 5.5050e+00,  6.4524e+00,  6.0409e+00,  ...,  7.8453e+00,
           7.9650e+00,  8.0023e+00],
         ...,
         [-2.2313e-01, -1.3700e-01,  6.6189e-01,  ..., -3.5499e-01,
          -2.2557e-01, -2.4741e-01],
         [ 1.6538e-01, -1.3251e-01,  2.1934e-01,  ...,  4.1691e-01,
           7.2639e-01,  2.4778e-01],
         [-1.2067e+00, -1.2413e+00, -1.0952e+00,  ...,  6.5587e-02,
           1.5464e-01,  5.8086e-02]],

        [[ 5.6395e-01, -6.1241e-02,  1.6922e-01,  ..., -5.2100e-01,
          -2.0194e-01, -3.0744e-01],
         [ 1.0535e+00,  6.9666e-01,  9.2457e-01,  ...,  1.1784e-01,
           1.2649e+00,  8.8562e-01],
         [ 5.3290e+00,  5.1080e+00,  5.7496e+00,  ...,  5.8348e+00,
           5.7317e+00,  6.2434e+00],
         ...,
         [ 2.6815e-01, -2.8003e-01, -2.7451e-01,  ..., -2.8839e-01,
          -5.7161e-01, -1.4489e+00],
         [-1.6615e-01,  5.1551e-01, -4.1918e-01,  ...,  6.7735e-02,
           4.4114e-01,  4.0450e-01],
         [-3.0072e-01, -6.7146e-01, -7.7501e-01,  ...,  2.0710e-01,
           3.6015e-03, -1.6417e-01]]], device='cuda:0',
       grad_fn=<PermuteBackward0>)
Tgt: tensor([[  804,    14,   439,  ...,     2,     2,     2],
        [  145,    27,  1875,  ...,     2,     2,     2],
        [38857,   721, 33031,  ...,     2,     2,     2],
        ...,
        [ 8626, 30580, 11635,  ...,     2,     2,     2],
        [  565,    21,   423,  ...,     2,     2,     2],
        [ 1198, 21561,   959,  ..., 28279,    14,     1]], device='cuda:0')
Output: tensor([[[ 3.6033e-02,  1.0926e+00,  6.1356e+00,  ...,  2.6924e-01,
           1.4281e-01, -6.9684e-01],
         [-2.1234e-01,  1.3744e+00,  6.7967e+00,  ..., -1.0615e+00,
          -2.2154e-01, -8.6529e-01],
         [ 4.7697e-01,  7.8055e-01,  6.1790e+00,  ..., -1.0581e+00,
           7.2892e-01, -1.2366e+00],
         ...,
         [-4.7118e-02,  5.9807e-01,  6.8158e+00,  ..., -7.2590e-01,
           2.7375e-01, -7.6480e-01],
         [-3.3358e-01,  9.5060e-01,  6.5707e+00,  ..., -1.1777e+00,
           2.5179e-01, -1.0504e+00],
         [-4.6129e-01,  8.3516e-01,  6.2746e+00,  ..., -7.7402e-01,
          -9.0666e-01, -9.8241e-02]],

        [[ 3.0703e-01,  1.3821e+00,  6.2907e+00,  ...,  1.3310e-01,
          -2.0004e-01, -1.1168e+00],
         [-5.4983e-01,  2.0832e+00,  6.3582e+00,  ..., -8.3042e-01,
          -3.0245e-01, -1.1511e+00],
         [-5.5095e-01,  9.6948e-01,  6.6304e+00,  ...,  3.4000e-01,
           4.9502e-01, -1.4324e+00],
         ...,
         [-7.4723e-01,  1.4225e+00,  8.2211e+00,  ..., -1.8600e-01,
           4.3442e-02,  3.3141e-02],
         [-5.2318e-01,  1.4405e+00,  8.1914e+00,  ..., -2.1051e-01,
           1.8184e-01, -1.4811e-01],
         [-5.6451e-01,  1.0836e+00,  8.3238e+00,  ..., -6.1415e-01,
           4.0393e-01, -6.3673e-01]],

        [[-6.7961e-02,  9.2696e-01,  6.5167e+00,  ..., -2.2899e-01,
           2.9920e-01, -1.3264e+00],
         [-7.2106e-01,  1.1827e+00,  6.4245e+00,  ..., -9.8358e-01,
           4.4681e-01, -8.7298e-01],
         [-3.9658e-01,  1.0423e+00,  5.9441e+00,  ..., -8.2087e-01,
           6.5187e-02, -1.0561e+00],
         ...,
         [-1.0607e+00,  7.0271e-01,  8.3343e+00,  ..., -4.3828e-01,
           3.8883e-01, -3.9339e-01],
         [-5.4181e-01,  9.4747e-01,  8.3907e+00,  ..., -8.6681e-01,
           6.0809e-01, -2.0254e-02],
         [-7.6330e-01,  1.4124e+00,  8.3536e+00,  ..., -8.9914e-01,
           2.5046e-01, -5.9087e-01]],

        ...,

        [[ 2.4025e-01,  1.3190e+00,  6.2169e+00,  ...,  1.3856e-01,
           6.7353e-02, -6.0264e-01],
         [-4.4007e-01,  1.0632e+00,  5.4769e+00,  ...,  2.3715e-03,
           7.6128e-02, -1.1990e+00],
         [-1.9482e-01,  5.7747e-01,  5.9422e+00,  ...,  8.1997e-02,
           8.6916e-01, -7.2273e-01],
         ...,
         [-1.0005e+00,  8.6911e-01,  6.1107e+00,  ..., -3.6484e-01,
          -7.3514e-02, -1.2212e+00],
         [-4.7363e-01,  9.2309e-01,  6.4275e+00,  ..., -3.1593e-01,
           5.0105e-01, -8.0393e-01],
         [-6.3785e-01,  1.1167e+00,  6.6845e+00,  ..., -1.0495e+00,
           4.6228e-01,  1.7563e-02]],

        [[ 4.1340e-01,  1.2136e+00,  6.0735e+00,  ..., -1.3039e-01,
           2.7536e-01, -6.0531e-01],
         [-3.7175e-01,  9.9749e-01,  5.9150e+00,  ..., -2.1679e-01,
           3.7254e-01, -1.7867e+00],
         [-5.1146e-01,  2.9319e-02,  6.1244e+00,  ..., -4.6237e-01,
           4.9934e-01, -8.8541e-01],
         ...,
         [-7.6527e-01,  8.0159e-01,  6.3825e+00,  ..., -1.8308e-01,
           4.9468e-01, -4.7406e-01],
         [-7.9736e-01,  1.0948e+00,  7.0918e+00,  ..., -7.0211e-01,
          -1.6227e-01, -9.4999e-01],
         [-7.0555e-01,  9.1661e-01,  6.3330e+00,  ..., -8.9258e-01,
           4.9762e-01, -1.2820e-01]],

        [[ 4.1916e-01,  7.9812e-01,  6.4092e+00,  ...,  7.1470e-02,
          -1.1477e-01, -8.4989e-01],
         [ 1.9719e-01,  8.8312e-01,  6.4099e+00,  ..., -1.2090e-01,
          -6.3512e-01, -1.6167e+00],
         [ 1.1807e-01,  1.4230e+00,  5.8699e+00,  ..., -6.3033e-01,
           2.2898e-01, -1.1419e+00],
         ...,
         [-3.2713e-01,  1.2344e+00,  8.3313e+00,  ..., -2.4818e-01,
           3.4623e-02,  1.4544e-02],
         [-1.8320e-01,  9.7391e-01,  8.4799e+00,  ..., -4.3349e-01,
           1.7956e-01, -1.3875e-01],
         [-5.9931e-01,  1.3813e+00,  8.4491e+00,  ..., -2.2353e-01,
          -1.0412e-01, -3.5732e-02]]], device='cuda:0',
       grad_fn=<GatherBackward>)
Tgt: tensor([[    0, 47504, 20843,  ...,   127,    24,     1],
        [    0,    94,  4362,  ...,     2,     2,     2],
        [    0,    15,    98,  ...,     2,     2,     2],
        ...,
        [    0, 13241,  1025,  ...,  8916,    14,     1],
        [    0,  1272,   202,  ...,  3465,  4807,     1],
        [    0,   565,    22,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[ 3.6033e-02, -2.1234e-01,  4.7697e-01,  ..., -4.7118e-02,
          -3.3358e-01, -4.6129e-01],
         [ 1.0926e+00,  1.3744e+00,  7.8055e-01,  ...,  5.9807e-01,
           9.5060e-01,  8.3516e-01],
         [ 6.1356e+00,  6.7967e+00,  6.1790e+00,  ...,  6.8158e+00,
           6.5707e+00,  6.2746e+00],
         ...,
         [ 2.6924e-01, -1.0615e+00, -1.0581e+00,  ..., -7.2590e-01,
          -1.1777e+00, -7.7402e-01],
         [ 1.4281e-01, -2.2154e-01,  7.2892e-01,  ...,  2.7375e-01,
           2.5179e-01, -9.0666e-01],
         [-6.9684e-01, -8.6529e-01, -1.2366e+00,  ..., -7.6480e-01,
          -1.0504e+00, -9.8241e-02]],

        [[ 3.0703e-01, -5.4983e-01, -5.5095e-01,  ..., -7.4723e-01,
          -5.2318e-01, -5.6451e-01],
         [ 1.3821e+00,  2.0832e+00,  9.6948e-01,  ...,  1.4225e+00,
           1.4405e+00,  1.0836e+00],
         [ 6.2907e+00,  6.3582e+00,  6.6304e+00,  ...,  8.2211e+00,
           8.1914e+00,  8.3238e+00],
         ...,
         [ 1.3310e-01, -8.3042e-01,  3.4000e-01,  ..., -1.8600e-01,
          -2.1051e-01, -6.1415e-01],
         [-2.0004e-01, -3.0245e-01,  4.9502e-01,  ...,  4.3442e-02,
           1.8184e-01,  4.0393e-01],
         [-1.1168e+00, -1.1511e+00, -1.4324e+00,  ...,  3.3141e-02,
          -1.4811e-01, -6.3673e-01]],

        [[-6.7961e-02, -7.2106e-01, -3.9658e-01,  ..., -1.0607e+00,
          -5.4181e-01, -7.6330e-01],
         [ 9.2696e-01,  1.1827e+00,  1.0423e+00,  ...,  7.0271e-01,
           9.4747e-01,  1.4124e+00],
         [ 6.5167e+00,  6.4245e+00,  5.9441e+00,  ...,  8.3343e+00,
           8.3907e+00,  8.3536e+00],
         ...,
         [-2.2899e-01, -9.8358e-01, -8.2087e-01,  ..., -4.3828e-01,
          -8.6681e-01, -8.9914e-01],
         [ 2.9920e-01,  4.4681e-01,  6.5187e-02,  ...,  3.8883e-01,
           6.0809e-01,  2.5046e-01],
         [-1.3264e+00, -8.7298e-01, -1.0561e+00,  ..., -3.9339e-01,
          -2.0254e-02, -5.9087e-01]],

        ...,

        [[ 2.4025e-01, -4.4007e-01, -1.9482e-01,  ..., -1.0005e+00,
          -4.7363e-01, -6.3785e-01],
         [ 1.3190e+00,  1.0632e+00,  5.7747e-01,  ...,  8.6911e-01,
           9.2309e-01,  1.1167e+00],
         [ 6.2169e+00,  5.4769e+00,  5.9422e+00,  ...,  6.1107e+00,
           6.4275e+00,  6.6845e+00],
         ...,
         [ 1.3856e-01,  2.3715e-03,  8.1997e-02,  ..., -3.6484e-01,
          -3.1593e-01, -1.0495e+00],
         [ 6.7353e-02,  7.6128e-02,  8.6916e-01,  ..., -7.3514e-02,
           5.0105e-01,  4.6228e-01],
         [-6.0264e-01, -1.1990e+00, -7.2273e-01,  ..., -1.2212e+00,
          -8.0393e-01,  1.7563e-02]],

        [[ 4.1340e-01, -3.7175e-01, -5.1146e-01,  ..., -7.6527e-01,
          -7.9736e-01, -7.0555e-01],
         [ 1.2136e+00,  9.9749e-01,  2.9319e-02,  ...,  8.0159e-01,
           1.0948e+00,  9.1661e-01],
         [ 6.0735e+00,  5.9150e+00,  6.1244e+00,  ...,  6.3825e+00,
           7.0918e+00,  6.3330e+00],
         ...,
         [-1.3039e-01, -2.1679e-01, -4.6237e-01,  ..., -1.8308e-01,
          -7.0211e-01, -8.9258e-01],
         [ 2.7536e-01,  3.7254e-01,  4.9934e-01,  ...,  4.9468e-01,
          -1.6227e-01,  4.9762e-01],
         [-6.0531e-01, -1.7867e+00, -8.8541e-01,  ..., -4.7406e-01,
          -9.4999e-01, -1.2820e-01]],

        [[ 4.1916e-01,  1.9719e-01,  1.1807e-01,  ..., -3.2713e-01,
          -1.8320e-01, -5.9931e-01],
         [ 7.9812e-01,  8.8312e-01,  1.4230e+00,  ...,  1.2344e+00,
           9.7391e-01,  1.3813e+00],
         [ 6.4092e+00,  6.4099e+00,  5.8699e+00,  ...,  8.3313e+00,
           8.4799e+00,  8.4491e+00],
         ...,
         [ 7.1470e-02, -1.2090e-01, -6.3033e-01,  ..., -2.4818e-01,
          -4.3349e-01, -2.2353e-01],
         [-1.1477e-01, -6.3512e-01,  2.2898e-01,  ...,  3.4623e-02,
           1.7956e-01, -1.0412e-01],
         [-8.4989e-01, -1.6167e+00, -1.1419e+00,  ...,  1.4544e-02,
          -1.3875e-01, -3.5732e-02]]], device='cuda:0',
       grad_fn=<PermuteBackward0>)
Tgt: tensor([[    0, 47504, 20843,  ...,   127,    24,     1],
        [    0,    94,  4362,  ...,     2,     2,     2],
        [    0,    15,    98,  ...,     2,     2,     2],
        ...,
        [    0, 13241,  1025,  ...,  8916,    14,     1],
        [    0,  1272,   202,  ...,  3465,  4807,     1],
        [    0,   565,    22,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[ 3.6033e-02, -2.1234e-01,  4.7697e-01,  ..., -4.7118e-02,
          -3.3358e-01, -4.6129e-01],
         [ 1.0926e+00,  1.3744e+00,  7.8055e-01,  ...,  5.9807e-01,
           9.5060e-01,  8.3516e-01],
         [ 6.1356e+00,  6.7967e+00,  6.1790e+00,  ...,  6.8158e+00,
           6.5707e+00,  6.2746e+00],
         ...,
         [ 2.6924e-01, -1.0615e+00, -1.0581e+00,  ..., -7.2590e-01,
          -1.1777e+00, -7.7402e-01],
         [ 1.4281e-01, -2.2154e-01,  7.2892e-01,  ...,  2.7375e-01,
           2.5179e-01, -9.0666e-01],
         [-6.9684e-01, -8.6529e-01, -1.2366e+00,  ..., -7.6480e-01,
          -1.0504e+00, -9.8241e-02]],

        [[ 3.0703e-01, -5.4983e-01, -5.5095e-01,  ..., -7.4723e-01,
          -5.2318e-01, -5.6451e-01],
         [ 1.3821e+00,  2.0832e+00,  9.6948e-01,  ...,  1.4225e+00,
           1.4405e+00,  1.0836e+00],
         [ 6.2907e+00,  6.3582e+00,  6.6304e+00,  ...,  8.2211e+00,
           8.1914e+00,  8.3238e+00],
         ...,
         [ 1.3310e-01, -8.3042e-01,  3.4000e-01,  ..., -1.8600e-01,
          -2.1051e-01, -6.1415e-01],
         [-2.0004e-01, -3.0245e-01,  4.9502e-01,  ...,  4.3442e-02,
           1.8184e-01,  4.0393e-01],
         [-1.1168e+00, -1.1511e+00, -1.4324e+00,  ...,  3.3141e-02,
          -1.4811e-01, -6.3673e-01]],

        [[-6.7961e-02, -7.2106e-01, -3.9658e-01,  ..., -1.0607e+00,
          -5.4181e-01, -7.6330e-01],
         [ 9.2696e-01,  1.1827e+00,  1.0423e+00,  ...,  7.0271e-01,
           9.4747e-01,  1.4124e+00],
         [ 6.5167e+00,  6.4245e+00,  5.9441e+00,  ...,  8.3343e+00,
           8.3907e+00,  8.3536e+00],
         ...,
         [-2.2899e-01, -9.8358e-01, -8.2087e-01,  ..., -4.3828e-01,
          -8.6681e-01, -8.9914e-01],
         [ 2.9920e-01,  4.4681e-01,  6.5187e-02,  ...,  3.8883e-01,
           6.0809e-01,  2.5046e-01],
         [-1.3264e+00, -8.7298e-01, -1.0561e+00,  ..., -3.9339e-01,
          -2.0254e-02, -5.9087e-01]],

        ...,

        [[ 2.4025e-01, -4.4007e-01, -1.9482e-01,  ..., -1.0005e+00,
          -4.7363e-01, -6.3785e-01],
         [ 1.3190e+00,  1.0632e+00,  5.7747e-01,  ...,  8.6911e-01,
           9.2309e-01,  1.1167e+00],
         [ 6.2169e+00,  5.4769e+00,  5.9422e+00,  ...,  6.1107e+00,
           6.4275e+00,  6.6845e+00],
         ...,
         [ 1.3856e-01,  2.3715e-03,  8.1997e-02,  ..., -3.6484e-01,
          -3.1593e-01, -1.0495e+00],
         [ 6.7353e-02,  7.6128e-02,  8.6916e-01,  ..., -7.3514e-02,
           5.0105e-01,  4.6228e-01],
         [-6.0264e-01, -1.1990e+00, -7.2273e-01,  ..., -1.2212e+00,
          -8.0393e-01,  1.7563e-02]],

        [[ 4.1340e-01, -3.7175e-01, -5.1146e-01,  ..., -7.6527e-01,
          -7.9736e-01, -7.0555e-01],
         [ 1.2136e+00,  9.9749e-01,  2.9319e-02,  ...,  8.0159e-01,
           1.0948e+00,  9.1661e-01],
         [ 6.0735e+00,  5.9150e+00,  6.1244e+00,  ...,  6.3825e+00,
           7.0918e+00,  6.3330e+00],
         ...,
         [-1.3039e-01, -2.1679e-01, -4.6237e-01,  ..., -1.8308e-01,
          -7.0211e-01, -8.9258e-01],
         [ 2.7536e-01,  3.7254e-01,  4.9934e-01,  ...,  4.9468e-01,
          -1.6227e-01,  4.9762e-01],
         [-6.0531e-01, -1.7867e+00, -8.8541e-01,  ..., -4.7406e-01,
          -9.4999e-01, -1.2820e-01]],

        [[ 4.1916e-01,  1.9719e-01,  1.1807e-01,  ..., -3.2713e-01,
          -1.8320e-01, -5.9931e-01],
         [ 7.9812e-01,  8.8312e-01,  1.4230e+00,  ...,  1.2344e+00,
           9.7391e-01,  1.3813e+00],
         [ 6.4092e+00,  6.4099e+00,  5.8699e+00,  ...,  8.3313e+00,
           8.4799e+00,  8.4491e+00],
         ...,
         [ 7.1470e-02, -1.2090e-01, -6.3033e-01,  ..., -2.4818e-01,
          -4.3349e-01, -2.2353e-01],
         [-1.1477e-01, -6.3512e-01,  2.2898e-01,  ...,  3.4623e-02,
           1.7956e-01, -1.0412e-01],
         [-8.4989e-01, -1.6167e+00, -1.1419e+00,  ...,  1.4544e-02,
          -1.3875e-01, -3.5732e-02]]], device='cuda:0',
       grad_fn=<PermuteBackward0>)
Tgt: tensor([[47504, 20843,  8777,  ...,   127,    24,     1],
        [   94,  4362,    14,  ...,     2,     2,     2],
        [   15,    98,   332,  ...,     2,     2,     2],
        ...,
        [13241,  1025,  5825,  ...,  8916,    14,     1],
        [ 1272,   202, 20760,  ...,  3465,  4807,     1],
        [  565,    22, 14623,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[-0.1203,  0.7808,  7.4278,  ..., -0.2737,  0.4832, -0.6547],
         [ 0.2252,  1.2747,  6.5693,  ..., -0.6909, -0.0296, -0.9824],
         [-0.5366,  1.3889,  6.9143,  ..., -0.8157,  0.3915, -1.0496],
         ...,
         [-0.4906,  1.2654,  9.3701,  ..., -0.6335,  0.2790, -0.4485],
         [-0.4613,  1.2148,  9.0441,  ..., -0.7151,  0.1491, -0.0298],
         [-0.2046,  1.0979,  9.2654,  ..., -0.7258,  0.5381, -0.2533]],

        [[-0.0170,  1.0572,  6.4814,  ...,  0.3191,  0.0690, -0.7304],
         [-0.6531,  0.3934,  6.8413,  ..., -0.2847,  0.1154, -0.6637],
         [-0.1721,  0.8492,  6.1360,  ..., -0.3672,  0.3510, -0.6366],
         ...,
         [-0.9272,  1.1975,  9.0276,  ..., -0.3422,  0.0234, -0.1602],
         [-0.5316,  1.1253,  9.1418,  ..., -0.3622,  0.0213, -0.0920],
         [-0.5890,  1.0669,  9.0326,  ..., -0.2422,  0.3713,  0.3980]],

        [[ 0.4723,  0.5909,  6.4454,  ..., -0.4144,  0.2025, -0.9103],
         [-0.4144,  2.1484,  6.1948,  ..., -0.8144,  0.4704, -0.7010],
         [-0.9408,  1.0513,  6.3637,  ..., -0.6297,  0.2275, -0.8565],
         ...,
         [-0.3692,  1.0224,  8.6782,  ..., -0.4320,  0.2687, -0.1214],
         [-0.8608,  0.9407,  8.4162,  ..., -0.1222,  0.3687, -0.1196],
         [-0.4127,  1.0043,  8.8549,  ..., -1.0250,  0.3153, -0.0695]],

        ...,

        [[ 0.4941,  1.0416,  6.7995,  ..., -0.1266,  0.1193, -1.0383],
         [-0.3528,  0.7416,  6.2967,  ..., -0.4134,  0.7906, -1.1316],
         [-0.3453,  1.8154,  6.1389,  ..., -0.3808,  0.4221, -1.4697],
         ...,
         [-0.1463,  0.9487,  6.6982,  ..., -1.1660,  0.0520, -0.5929],
         [-0.3660,  1.0940,  8.7193,  ..., -0.3462,  0.0378,  0.2425],
         [-0.5197,  1.5726,  8.6440,  ..., -0.6544,  0.2621,  0.1740]],

        [[-0.0673,  1.1062,  6.8343,  ...,  0.2463,  0.5085, -0.4998],
         [-0.9001,  0.9918,  6.8558,  ..., -0.6985,  0.2609, -0.2233],
         [-0.7396,  0.8294,  6.5180,  ..., -0.3105,  0.9324, -0.8122],
         ...,
         [-0.5527,  0.9415,  9.0056,  ..., -0.3799, -0.0602,  0.3970],
         [-0.8890,  1.2313,  8.9202,  ..., -0.9036,  0.5796, -0.0951],
         [-0.6324,  0.8727,  9.1664,  ..., -0.8222,  0.2761,  0.1672]],

        [[-0.4723,  0.9860,  7.3441,  ..., -0.8573,  0.3531, -0.9931],
         [-0.3201,  0.2990,  6.4411,  ..., -1.5361,  0.5207, -1.0661],
         [-1.1720,  1.3693,  6.2424,  ..., -1.0997,  0.6087, -1.3238],
         ...,
         [-0.9023,  1.0168,  9.0258,  ..., -0.8141,  0.2571, -0.1889],
         [-0.8516,  0.9990,  9.0100,  ..., -0.6152,  0.2927, -0.3906],
         [-1.0715,  0.8968,  9.0460,  ..., -0.9981,  0.4666, -0.3353]]],
       device='cuda:0', grad_fn=<GatherBackward>)
Tgt: tensor([[    0,  1186,    14,  ...,     2,     2,     2],
        [    0,    64,   103,  ...,     2,     2,     2],
        [    0,    94,  1338,  ...,     2,     2,     2],
        ...,
        [    0,  2216,    54,  ...,     2,     2,     2],
        [    0,  5852,    26,  ...,     2,     2,     2],
        [    0, 18906, 11622,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[-0.1203,  0.2252, -0.5366,  ..., -0.4906, -0.4613, -0.2046],
         [ 0.7808,  1.2747,  1.3889,  ...,  1.2654,  1.2148,  1.0979],
         [ 7.4278,  6.5693,  6.9143,  ...,  9.3701,  9.0441,  9.2654],
         ...,
         [-0.2737, -0.6909, -0.8157,  ..., -0.6335, -0.7151, -0.7258],
         [ 0.4832, -0.0296,  0.3915,  ...,  0.2790,  0.1491,  0.5381],
         [-0.6547, -0.9824, -1.0496,  ..., -0.4485, -0.0298, -0.2533]],

        [[-0.0170, -0.6531, -0.1721,  ..., -0.9272, -0.5316, -0.5890],
         [ 1.0572,  0.3934,  0.8492,  ...,  1.1975,  1.1253,  1.0669],
         [ 6.4814,  6.8413,  6.1360,  ...,  9.0276,  9.1418,  9.0326],
         ...,
         [ 0.3191, -0.2847, -0.3672,  ..., -0.3422, -0.3622, -0.2422],
         [ 0.0690,  0.1154,  0.3510,  ...,  0.0234,  0.0213,  0.3713],
         [-0.7304, -0.6637, -0.6366,  ..., -0.1602, -0.0920,  0.3980]],

        [[ 0.4723, -0.4144, -0.9408,  ..., -0.3692, -0.8608, -0.4127],
         [ 0.5909,  2.1484,  1.0513,  ...,  1.0224,  0.9407,  1.0043],
         [ 6.4454,  6.1948,  6.3637,  ...,  8.6782,  8.4162,  8.8549],
         ...,
         [-0.4144, -0.8144, -0.6297,  ..., -0.4320, -0.1222, -1.0250],
         [ 0.2025,  0.4704,  0.2275,  ...,  0.2687,  0.3687,  0.3153],
         [-0.9103, -0.7010, -0.8565,  ..., -0.1214, -0.1196, -0.0695]],

        ...,

        [[ 0.4941, -0.3528, -0.3453,  ..., -0.1463, -0.3660, -0.5197],
         [ 1.0416,  0.7416,  1.8154,  ...,  0.9487,  1.0940,  1.5726],
         [ 6.7995,  6.2967,  6.1389,  ...,  6.6982,  8.7193,  8.6440],
         ...,
         [-0.1266, -0.4134, -0.3808,  ..., -1.1660, -0.3462, -0.6544],
         [ 0.1193,  0.7906,  0.4221,  ...,  0.0520,  0.0378,  0.2621],
         [-1.0383, -1.1316, -1.4697,  ..., -0.5929,  0.2425,  0.1740]],

        [[-0.0673, -0.9001, -0.7396,  ..., -0.5527, -0.8890, -0.6324],
         [ 1.1062,  0.9918,  0.8294,  ...,  0.9415,  1.2313,  0.8727],
         [ 6.8343,  6.8558,  6.5180,  ...,  9.0056,  8.9202,  9.1664],
         ...,
         [ 0.2463, -0.6985, -0.3105,  ..., -0.3799, -0.9036, -0.8222],
         [ 0.5085,  0.2609,  0.9324,  ..., -0.0602,  0.5796,  0.2761],
         [-0.4998, -0.2233, -0.8122,  ...,  0.3970, -0.0951,  0.1672]],

        [[-0.4723, -0.3201, -1.1720,  ..., -0.9023, -0.8516, -1.0715],
         [ 0.9860,  0.2990,  1.3693,  ...,  1.0168,  0.9990,  0.8968],
         [ 7.3441,  6.4411,  6.2424,  ...,  9.0258,  9.0100,  9.0460],
         ...,
         [-0.8573, -1.5361, -1.0997,  ..., -0.8141, -0.6152, -0.9981],
         [ 0.3531,  0.5207,  0.6087,  ...,  0.2571,  0.2927,  0.4666],
         [-0.9931, -1.0661, -1.3238,  ..., -0.1889, -0.3906, -0.3353]]],
       device='cuda:0', grad_fn=<PermuteBackward0>)
Tgt: tensor([[    0,  1186,    14,  ...,     2,     2,     2],
        [    0,    64,   103,  ...,     2,     2,     2],
        [    0,    94,  1338,  ...,     2,     2,     2],
        ...,
        [    0,  2216,    54,  ...,     2,     2,     2],
        [    0,  5852,    26,  ...,     2,     2,     2],
        [    0, 18906, 11622,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[-0.1203,  0.2252, -0.5366,  ..., -0.4906, -0.4613, -0.2046],
         [ 0.7808,  1.2747,  1.3889,  ...,  1.2654,  1.2148,  1.0979],
         [ 7.4278,  6.5693,  6.9143,  ...,  9.3701,  9.0441,  9.2654],
         ...,
         [-0.2737, -0.6909, -0.8157,  ..., -0.6335, -0.7151, -0.7258],
         [ 0.4832, -0.0296,  0.3915,  ...,  0.2790,  0.1491,  0.5381],
         [-0.6547, -0.9824, -1.0496,  ..., -0.4485, -0.0298, -0.2533]],

        [[-0.0170, -0.6531, -0.1721,  ..., -0.9272, -0.5316, -0.5890],
         [ 1.0572,  0.3934,  0.8492,  ...,  1.1975,  1.1253,  1.0669],
         [ 6.4814,  6.8413,  6.1360,  ...,  9.0276,  9.1418,  9.0326],
         ...,
         [ 0.3191, -0.2847, -0.3672,  ..., -0.3422, -0.3622, -0.2422],
         [ 0.0690,  0.1154,  0.3510,  ...,  0.0234,  0.0213,  0.3713],
         [-0.7304, -0.6637, -0.6366,  ..., -0.1602, -0.0920,  0.3980]],

        [[ 0.4723, -0.4144, -0.9408,  ..., -0.3692, -0.8608, -0.4127],
         [ 0.5909,  2.1484,  1.0513,  ...,  1.0224,  0.9407,  1.0043],
         [ 6.4454,  6.1948,  6.3637,  ...,  8.6782,  8.4162,  8.8549],
         ...,
         [-0.4144, -0.8144, -0.6297,  ..., -0.4320, -0.1222, -1.0250],
         [ 0.2025,  0.4704,  0.2275,  ...,  0.2687,  0.3687,  0.3153],
         [-0.9103, -0.7010, -0.8565,  ..., -0.1214, -0.1196, -0.0695]],

        ...,

        [[ 0.4941, -0.3528, -0.3453,  ..., -0.1463, -0.3660, -0.5197],
         [ 1.0416,  0.7416,  1.8154,  ...,  0.9487,  1.0940,  1.5726],
         [ 6.7995,  6.2967,  6.1389,  ...,  6.6982,  8.7193,  8.6440],
         ...,
         [-0.1266, -0.4134, -0.3808,  ..., -1.1660, -0.3462, -0.6544],
         [ 0.1193,  0.7906,  0.4221,  ...,  0.0520,  0.0378,  0.2621],
         [-1.0383, -1.1316, -1.4697,  ..., -0.5929,  0.2425,  0.1740]],

        [[-0.0673, -0.9001, -0.7396,  ..., -0.5527, -0.8890, -0.6324],
         [ 1.1062,  0.9918,  0.8294,  ...,  0.9415,  1.2313,  0.8727],
         [ 6.8343,  6.8558,  6.5180,  ...,  9.0056,  8.9202,  9.1664],
         ...,
         [ 0.2463, -0.6985, -0.3105,  ..., -0.3799, -0.9036, -0.8222],
         [ 0.5085,  0.2609,  0.9324,  ..., -0.0602,  0.5796,  0.2761],
         [-0.4998, -0.2233, -0.8122,  ...,  0.3970, -0.0951,  0.1672]],

        [[-0.4723, -0.3201, -1.1720,  ..., -0.9023, -0.8516, -1.0715],
         [ 0.9860,  0.2990,  1.3693,  ...,  1.0168,  0.9990,  0.8968],
         [ 7.3441,  6.4411,  6.2424,  ...,  9.0258,  9.0100,  9.0460],
         ...,
         [-0.8573, -1.5361, -1.0997,  ..., -0.8141, -0.6152, -0.9981],
         [ 0.3531,  0.5207,  0.6087,  ...,  0.2571,  0.2927,  0.4666],
         [-0.9931, -1.0661, -1.3238,  ..., -0.1889, -0.3906, -0.3353]]],
       device='cuda:0', grad_fn=<PermuteBackward0>)
Tgt: tensor([[ 1186,    14,    72,  ...,     2,     2,     2],
        [   64,   103,  2442,  ...,     2,     2,     2],
        [   94,  1338,  2110,  ...,     2,     2,     2],
        ...,
        [ 2216,    54,  3206,  ...,     2,     2,     2],
        [ 5852,    26, 21130,  ...,     2,     2,     2],
        [18906, 11622, 39318,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[-4.5427e-01,  9.4877e-01,  7.6276e+00,  ...,  1.9196e-01,
          -1.1696e-02, -1.4091e+00],
         [-4.7368e-01,  3.7043e-01,  7.1570e+00,  ..., -1.2349e+00,
           3.5355e-01, -1.8602e+00],
         [-5.4442e-01,  1.2535e+00,  7.0374e+00,  ..., -8.1056e-01,
          -1.3852e-01, -1.8125e+00],
         ...,
         [-1.0511e+00,  1.2812e+00,  9.2292e+00,  ..., -5.4090e-01,
           8.5402e-03, -9.0273e-01],
         [-9.4560e-01,  1.1504e+00,  9.2842e+00,  ..., -7.6148e-01,
           1.0647e-01, -5.1210e-01],
         [-9.5491e-01,  1.2585e+00,  9.2378e+00,  ..., -1.1943e+00,
           4.8704e-01, -3.8388e-01]],

        [[-1.3110e-01,  1.8344e+00,  7.0475e+00,  ..., -1.0447e-01,
           1.1186e-01, -1.2568e+00],
         [-7.1125e-01,  1.8706e+00,  6.4951e+00,  ..., -5.3126e-01,
           3.3655e-01, -1.8651e+00],
         [ 1.6750e-01,  1.5392e+00,  6.9339e+00,  ..., -8.8635e-01,
           1.7814e-01, -1.4332e+00],
         ...,
         [-8.7058e-01,  1.5829e+00,  9.0806e+00,  ..., -5.0202e-01,
           3.0158e-01, -8.3570e-01],
         [-8.9250e-01,  1.3597e+00,  9.1039e+00,  ..., -4.7937e-01,
           4.8407e-01, -7.2875e-01],
         [-1.0350e+00,  1.4213e+00,  9.2445e+00,  ..., -4.1434e-01,
          -5.9822e-02, -7.9629e-01]],

        [[ 2.0130e-01,  1.4155e+00,  6.6389e+00,  ..., -2.5334e-01,
          -1.5793e-01, -7.7203e-01],
         [ 3.4113e-02,  6.8767e-01,  6.9228e+00,  ..., -1.4348e-01,
           4.6975e-01, -8.1338e-01],
         [-1.2990e-01,  1.4091e+00,  7.5129e+00,  ..., -5.9348e-01,
           5.8311e-01, -1.3611e+00],
         ...,
         [-5.9273e-01,  1.3538e+00,  9.1608e+00,  ..., -3.0292e-01,
           3.7832e-01, -4.2404e-01],
         [-3.0959e-01,  1.2225e+00,  9.5094e+00,  ..., -2.8044e-01,
           3.3387e-02, -1.7706e-01],
         [-3.0830e-01,  1.3799e+00,  9.6474e+00,  ..., -7.3709e-01,
           1.6072e-01, -7.0497e-02]],

        ...,

        [[ 5.5058e-01,  1.2562e+00,  6.9282e+00,  ...,  1.5846e-01,
           7.1750e-02, -7.7389e-01],
         [-1.2954e-01,  8.8913e-01,  6.4870e+00,  ..., -6.3026e-01,
           4.4580e-01, -1.0812e+00],
         [-4.6783e-01,  9.1948e-01,  6.6299e+00,  ..., -6.1964e-01,
           3.7619e-02, -1.4206e+00],
         ...,
         [-4.3376e-01,  9.7378e-01,  9.6132e+00,  ..., -6.3662e-01,
          -1.4187e-01, -3.1288e-01],
         [-7.5731e-01,  1.2023e+00,  9.3510e+00,  ..., -3.6851e-01,
           1.5726e-01, -6.0985e-01],
         [-7.6054e-01,  1.2733e+00,  9.4238e+00,  ..., -3.2027e-01,
           2.9023e-01, -3.4959e-01]],

        [[-3.0914e-01,  8.1430e-01,  7.3886e+00,  ..., -1.9262e-01,
          -5.1699e-03, -1.2932e+00],
         [-6.7246e-01,  1.2394e+00,  6.6433e+00,  ..., -1.0510e-01,
           4.2628e-01, -1.4372e+00],
         [-7.9574e-01,  1.0676e+00,  6.9591e+00,  ..., -1.0777e+00,
           3.7209e-01, -1.1491e+00],
         ...,
         [-8.3558e-01,  1.0727e+00,  9.1456e+00,  ..., -4.9068e-01,
           3.0589e-01, -6.3061e-01],
         [-8.9028e-01,  1.0739e+00,  9.0884e+00,  ..., -7.4744e-01,
           2.3199e-02, -6.3490e-01],
         [-9.7866e-01,  8.4507e-01,  9.2312e+00,  ..., -5.7540e-01,
           7.7590e-01, -4.1255e-01]],

        [[ 4.3054e-01,  1.0466e+00,  7.0949e+00,  ..., -3.8471e-02,
          -1.9733e-02, -1.1827e+00],
         [-1.6720e-01,  8.9766e-01,  7.2703e+00,  ..., -9.1545e-01,
           2.9742e-01, -1.5593e+00],
         [-7.2639e-02,  9.3538e-01,  6.9398e+00,  ...,  2.0156e-01,
          -1.3990e-01, -8.9530e-01],
         ...,
         [-3.0391e-01,  1.2069e+00,  9.6270e+00,  ..., -5.7346e-01,
           8.3181e-02, -5.0602e-01],
         [-7.3859e-01,  1.1265e+00,  9.4404e+00,  ..., -4.2717e-01,
           4.6083e-01, -3.0407e-01],
         [-1.1296e-01,  9.1157e-01,  9.7695e+00,  ..., -3.0389e-01,
           7.1390e-02, -2.0055e-01]]], device='cuda:0',
       grad_fn=<GatherBackward>)
Tgt: tensor([[    0, 18648,     1,  ...,     2,     2,     2],
        [    0,    54,     1,  ...,     2,     2,     2],
        [    0, 36142, 16980,  ...,     2,     2,     2],
        ...,
        [    0,    84,  6966,  ...,     2,     2,     2],
        [    0,  1356,  2730,  ...,     2,     2,     2],
        [    0,   661,    28,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[-4.5427e-01, -4.7368e-01, -5.4442e-01,  ..., -1.0511e+00,
          -9.4560e-01, -9.5491e-01],
         [ 9.4877e-01,  3.7043e-01,  1.2535e+00,  ...,  1.2812e+00,
           1.1504e+00,  1.2585e+00],
         [ 7.6276e+00,  7.1570e+00,  7.0374e+00,  ...,  9.2292e+00,
           9.2842e+00,  9.2378e+00],
         ...,
         [ 1.9196e-01, -1.2349e+00, -8.1056e-01,  ..., -5.4090e-01,
          -7.6148e-01, -1.1943e+00],
         [-1.1696e-02,  3.5355e-01, -1.3852e-01,  ...,  8.5402e-03,
           1.0647e-01,  4.8704e-01],
         [-1.4091e+00, -1.8602e+00, -1.8125e+00,  ..., -9.0273e-01,
          -5.1210e-01, -3.8388e-01]],

        [[-1.3110e-01, -7.1125e-01,  1.6750e-01,  ..., -8.7058e-01,
          -8.9250e-01, -1.0350e+00],
         [ 1.8344e+00,  1.8706e+00,  1.5392e+00,  ...,  1.5829e+00,
           1.3597e+00,  1.4213e+00],
         [ 7.0475e+00,  6.4951e+00,  6.9339e+00,  ...,  9.0806e+00,
           9.1039e+00,  9.2445e+00],
         ...,
         [-1.0447e-01, -5.3126e-01, -8.8635e-01,  ..., -5.0202e-01,
          -4.7937e-01, -4.1434e-01],
         [ 1.1186e-01,  3.3655e-01,  1.7814e-01,  ...,  3.0158e-01,
           4.8407e-01, -5.9822e-02],
         [-1.2568e+00, -1.8651e+00, -1.4332e+00,  ..., -8.3570e-01,
          -7.2875e-01, -7.9629e-01]],

        [[ 2.0130e-01,  3.4113e-02, -1.2990e-01,  ..., -5.9273e-01,
          -3.0959e-01, -3.0830e-01],
         [ 1.4155e+00,  6.8767e-01,  1.4091e+00,  ...,  1.3538e+00,
           1.2225e+00,  1.3799e+00],
         [ 6.6389e+00,  6.9228e+00,  7.5129e+00,  ...,  9.1608e+00,
           9.5094e+00,  9.6474e+00],
         ...,
         [-2.5334e-01, -1.4348e-01, -5.9348e-01,  ..., -3.0292e-01,
          -2.8044e-01, -7.3709e-01],
         [-1.5793e-01,  4.6975e-01,  5.8311e-01,  ...,  3.7832e-01,
           3.3387e-02,  1.6072e-01],
         [-7.7203e-01, -8.1338e-01, -1.3611e+00,  ..., -4.2404e-01,
          -1.7706e-01, -7.0497e-02]],

        ...,

        [[ 5.5058e-01, -1.2954e-01, -4.6783e-01,  ..., -4.3376e-01,
          -7.5731e-01, -7.6054e-01],
         [ 1.2562e+00,  8.8913e-01,  9.1948e-01,  ...,  9.7378e-01,
           1.2023e+00,  1.2733e+00],
         [ 6.9282e+00,  6.4870e+00,  6.6299e+00,  ...,  9.6132e+00,
           9.3510e+00,  9.4238e+00],
         ...,
         [ 1.5846e-01, -6.3026e-01, -6.1964e-01,  ..., -6.3662e-01,
          -3.6851e-01, -3.2027e-01],
         [ 7.1750e-02,  4.4580e-01,  3.7619e-02,  ..., -1.4187e-01,
           1.5726e-01,  2.9023e-01],
         [-7.7389e-01, -1.0812e+00, -1.4206e+00,  ..., -3.1288e-01,
          -6.0985e-01, -3.4959e-01]],

        [[-3.0914e-01, -6.7246e-01, -7.9574e-01,  ..., -8.3558e-01,
          -8.9028e-01, -9.7866e-01],
         [ 8.1430e-01,  1.2394e+00,  1.0676e+00,  ...,  1.0727e+00,
           1.0739e+00,  8.4507e-01],
         [ 7.3886e+00,  6.6433e+00,  6.9591e+00,  ...,  9.1456e+00,
           9.0884e+00,  9.2312e+00],
         ...,
         [-1.9262e-01, -1.0510e-01, -1.0777e+00,  ..., -4.9068e-01,
          -7.4744e-01, -5.7540e-01],
         [-5.1699e-03,  4.2628e-01,  3.7209e-01,  ...,  3.0589e-01,
           2.3199e-02,  7.7590e-01],
         [-1.2932e+00, -1.4372e+00, -1.1491e+00,  ..., -6.3061e-01,
          -6.3490e-01, -4.1255e-01]],

        [[ 4.3054e-01, -1.6720e-01, -7.2639e-02,  ..., -3.0391e-01,
          -7.3859e-01, -1.1296e-01],
         [ 1.0466e+00,  8.9766e-01,  9.3538e-01,  ...,  1.2069e+00,
           1.1265e+00,  9.1157e-01],
         [ 7.0949e+00,  7.2703e+00,  6.9398e+00,  ...,  9.6270e+00,
           9.4404e+00,  9.7695e+00],
         ...,
         [-3.8471e-02, -9.1545e-01,  2.0156e-01,  ..., -5.7346e-01,
          -4.2717e-01, -3.0389e-01],
         [-1.9733e-02,  2.9742e-01, -1.3990e-01,  ...,  8.3181e-02,
           4.6083e-01,  7.1390e-02],
         [-1.1827e+00, -1.5593e+00, -8.9530e-01,  ..., -5.0602e-01,
          -3.0407e-01, -2.0055e-01]]], device='cuda:0',
       grad_fn=<PermuteBackward0>)
Tgt: tensor([[    0, 18648,     1,  ...,     2,     2,     2],
        [    0,    54,     1,  ...,     2,     2,     2],
        [    0, 36142, 16980,  ...,     2,     2,     2],
        ...,
        [    0,    84,  6966,  ...,     2,     2,     2],
        [    0,  1356,  2730,  ...,     2,     2,     2],
        [    0,   661,    28,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[-4.5427e-01, -4.7368e-01, -5.4442e-01,  ..., -1.0511e+00,
          -9.4560e-01, -9.5491e-01],
         [ 9.4877e-01,  3.7043e-01,  1.2535e+00,  ...,  1.2812e+00,
           1.1504e+00,  1.2585e+00],
         [ 7.6276e+00,  7.1570e+00,  7.0374e+00,  ...,  9.2292e+00,
           9.2842e+00,  9.2378e+00],
         ...,
         [ 1.9196e-01, -1.2349e+00, -8.1056e-01,  ..., -5.4090e-01,
          -7.6148e-01, -1.1943e+00],
         [-1.1696e-02,  3.5355e-01, -1.3852e-01,  ...,  8.5402e-03,
           1.0647e-01,  4.8704e-01],
         [-1.4091e+00, -1.8602e+00, -1.8125e+00,  ..., -9.0273e-01,
          -5.1210e-01, -3.8388e-01]],

        [[-1.3110e-01, -7.1125e-01,  1.6750e-01,  ..., -8.7058e-01,
          -8.9250e-01, -1.0350e+00],
         [ 1.8344e+00,  1.8706e+00,  1.5392e+00,  ...,  1.5829e+00,
           1.3597e+00,  1.4213e+00],
         [ 7.0475e+00,  6.4951e+00,  6.9339e+00,  ...,  9.0806e+00,
           9.1039e+00,  9.2445e+00],
         ...,
         [-1.0447e-01, -5.3126e-01, -8.8635e-01,  ..., -5.0202e-01,
          -4.7937e-01, -4.1434e-01],
         [ 1.1186e-01,  3.3655e-01,  1.7814e-01,  ...,  3.0158e-01,
           4.8407e-01, -5.9822e-02],
         [-1.2568e+00, -1.8651e+00, -1.4332e+00,  ..., -8.3570e-01,
          -7.2875e-01, -7.9629e-01]],

        [[ 2.0130e-01,  3.4113e-02, -1.2990e-01,  ..., -5.9273e-01,
          -3.0959e-01, -3.0830e-01],
         [ 1.4155e+00,  6.8767e-01,  1.4091e+00,  ...,  1.3538e+00,
           1.2225e+00,  1.3799e+00],
         [ 6.6389e+00,  6.9228e+00,  7.5129e+00,  ...,  9.1608e+00,
           9.5094e+00,  9.6474e+00],
         ...,
         [-2.5334e-01, -1.4348e-01, -5.9348e-01,  ..., -3.0292e-01,
          -2.8044e-01, -7.3709e-01],
         [-1.5793e-01,  4.6975e-01,  5.8311e-01,  ...,  3.7832e-01,
           3.3387e-02,  1.6072e-01],
         [-7.7203e-01, -8.1338e-01, -1.3611e+00,  ..., -4.2404e-01,
          -1.7706e-01, -7.0497e-02]],

        ...,

        [[ 5.5058e-01, -1.2954e-01, -4.6783e-01,  ..., -4.3376e-01,
          -7.5731e-01, -7.6054e-01],
         [ 1.2562e+00,  8.8913e-01,  9.1948e-01,  ...,  9.7378e-01,
           1.2023e+00,  1.2733e+00],
         [ 6.9282e+00,  6.4870e+00,  6.6299e+00,  ...,  9.6132e+00,
           9.3510e+00,  9.4238e+00],
         ...,
         [ 1.5846e-01, -6.3026e-01, -6.1964e-01,  ..., -6.3662e-01,
          -3.6851e-01, -3.2027e-01],
         [ 7.1750e-02,  4.4580e-01,  3.7619e-02,  ..., -1.4187e-01,
           1.5726e-01,  2.9023e-01],
         [-7.7389e-01, -1.0812e+00, -1.4206e+00,  ..., -3.1288e-01,
          -6.0985e-01, -3.4959e-01]],

        [[-3.0914e-01, -6.7246e-01, -7.9574e-01,  ..., -8.3558e-01,
          -8.9028e-01, -9.7866e-01],
         [ 8.1430e-01,  1.2394e+00,  1.0676e+00,  ...,  1.0727e+00,
           1.0739e+00,  8.4507e-01],
         [ 7.3886e+00,  6.6433e+00,  6.9591e+00,  ...,  9.1456e+00,
           9.0884e+00,  9.2312e+00],
         ...,
         [-1.9262e-01, -1.0510e-01, -1.0777e+00,  ..., -4.9068e-01,
          -7.4744e-01, -5.7540e-01],
         [-5.1699e-03,  4.2628e-01,  3.7209e-01,  ...,  3.0589e-01,
           2.3199e-02,  7.7590e-01],
         [-1.2932e+00, -1.4372e+00, -1.1491e+00,  ..., -6.3061e-01,
          -6.3490e-01, -4.1255e-01]],

        [[ 4.3054e-01, -1.6720e-01, -7.2639e-02,  ..., -3.0391e-01,
          -7.3859e-01, -1.1296e-01],
         [ 1.0466e+00,  8.9766e-01,  9.3538e-01,  ...,  1.2069e+00,
           1.1265e+00,  9.1157e-01],
         [ 7.0949e+00,  7.2703e+00,  6.9398e+00,  ...,  9.6270e+00,
           9.4404e+00,  9.7695e+00],
         ...,
         [-3.8471e-02, -9.1545e-01,  2.0156e-01,  ..., -5.7346e-01,
          -4.2717e-01, -3.0389e-01],
         [-1.9733e-02,  2.9742e-01, -1.3990e-01,  ...,  8.3181e-02,
           4.6083e-01,  7.1390e-02],
         [-1.1827e+00, -1.5593e+00, -8.9530e-01,  ..., -5.0602e-01,
          -3.0407e-01, -2.0055e-01]]], device='cuda:0',
       grad_fn=<PermuteBackward0>)
Tgt: tensor([[18648,     1,     2,  ...,     2,     2,     2],
        [   54,     1,     2,  ...,     2,     2,     2],
        [36142, 16980, 34993,  ...,     2,     2,     2],
        ...,
        [   84,  6966,    23,  ...,     2,     2,     2],
        [ 1356,  2730,   450,  ...,     2,     2,     2],
        [  661,    28,  1131,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[-0.1117,  1.0500,  7.1942,  ...,  0.1693,  0.2240, -1.1133],
         [-0.3244,  1.0827,  6.4595,  ..., -0.3132, -0.5335, -1.6791],
         [-0.4941,  0.5160,  6.8710,  ...,  0.0666,  0.4007, -1.0020],
         ...,
         [-0.6126,  0.7760,  9.2925,  ...,  0.2768,  0.3915, -0.9457],
         [-0.5482,  1.0709,  9.2618,  ..., -0.2898, -0.0532, -0.6839],
         [-0.5727,  1.5092,  9.0763,  ..., -0.1673,  0.0142, -0.9306]],

        [[-0.4469,  1.1216,  7.8936,  ..., -0.2213,  0.1411, -1.3167],
         [-0.6663,  0.6783,  7.4433,  ..., -0.6379,  0.4013, -1.2927],
         [-0.8478,  1.0468,  7.6647,  ..., -0.3616, -0.1630, -0.6643],
         ...,
         [-0.7464,  1.1887, 10.1619,  ..., -0.7295,  0.5924, -0.5777],
         [-0.5647,  0.8897,  9.9874,  ..., -0.8454,  0.4870, -0.4061],
         [-0.4721,  1.0672,  9.9857,  ..., -0.7852,  0.3983, -0.7380]],

        [[ 0.2047,  1.1395,  7.4665,  ..., -0.4365,  0.1946, -0.8990],
         [-0.4794,  1.3539,  6.9978,  ..., -0.4515,  0.3386, -0.7697],
         [-0.2979,  1.3033,  6.9952,  ..., -0.7232,  0.1623, -1.1613],
         ...,
         [-0.2733,  1.4503,  9.7764,  ..., -0.4328, -0.0461, -0.1634],
         [-0.5815,  1.3004,  9.8047,  ..., -0.4409,  0.0286, -0.0676],
         [-0.7161,  1.2249,  9.8515,  ..., -0.3792,  0.1454, -0.3373]],

        ...,

        [[-0.1259,  0.8621,  7.9752,  ..., -0.0461,  0.2243, -1.2129],
         [ 0.0447,  0.5830,  8.0858,  ..., -0.4560,  0.2616, -1.0092],
         [ 0.2056,  0.5645,  7.4292,  ..., -0.3037,  0.1174, -1.6586],
         ...,
         [-0.6467,  0.9465,  9.6562,  ..., -0.3972,  0.3123, -0.8253],
         [-0.5322,  1.1228,  9.6242,  ..., -0.1425,  0.2999, -0.5646],
         [-0.0415,  0.6810,  9.6172,  ..., -0.4086,  0.1566, -0.6472]],

        [[-0.4363,  0.7855,  7.7510,  ...,  0.0514,  0.1360, -1.0105],
         [-0.7097,  1.0689,  7.4269,  ..., -0.2232,  0.4050, -0.8930],
         [-0.5470,  0.7930,  7.3003,  ..., -0.8841, -0.1890, -0.7142],
         ...,
         [-0.9444,  1.2795,  9.5981,  ..., -0.3397,  0.2251, -0.6150],
         [-0.8546,  0.7204,  9.7485,  ..., -0.5988,  0.2162, -0.5341],
         [-1.1753,  1.3983,  9.3524,  ..., -0.5780, -0.0507, -0.4669]],

        [[-0.0310,  1.2717,  7.4740,  ..., -0.2669,  0.3224, -0.7428],
         [-0.4729,  1.4908,  6.9197,  ..., -0.7513,  0.0273, -0.7627],
         [-0.5810,  1.0345,  6.9758,  ..., -0.6125,  0.6879, -0.7730],
         ...,
         [-0.6223,  1.6281,  9.8917,  ..., -0.5834,  0.2213, -0.3330],
         [-0.3549,  1.2111,  9.9016,  ..., -0.3951,  0.1056, -0.4379],
         [-0.4897,  1.5144,  9.6831,  ..., -0.7587,  0.6027, -0.3682]]],
       device='cuda:0', grad_fn=<GatherBackward>)
Tgt: tensor([[    0,  2263,   587,  ...,     2,     2,     2],
        [    0,    29, 26335,  ...,     2,     2,     2],
        [    0,    55,   235,  ...,     2,     2,     2],
        ...,
        [    0,   554,   450,  ...,     2,     2,     2],
        [    0, 39918, 10908,  ...,     2,     2,     2],
        [    0,    94,  1052,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[-0.1117, -0.3244, -0.4941,  ..., -0.6126, -0.5482, -0.5727],
         [ 1.0500,  1.0827,  0.5160,  ...,  0.7760,  1.0709,  1.5092],
         [ 7.1942,  6.4595,  6.8710,  ...,  9.2925,  9.2618,  9.0763],
         ...,
         [ 0.1693, -0.3132,  0.0666,  ...,  0.2768, -0.2898, -0.1673],
         [ 0.2240, -0.5335,  0.4007,  ...,  0.3915, -0.0532,  0.0142],
         [-1.1133, -1.6791, -1.0020,  ..., -0.9457, -0.6839, -0.9306]],

        [[-0.4469, -0.6663, -0.8478,  ..., -0.7464, -0.5647, -0.4721],
         [ 1.1216,  0.6783,  1.0468,  ...,  1.1887,  0.8897,  1.0672],
         [ 7.8936,  7.4433,  7.6647,  ..., 10.1619,  9.9874,  9.9857],
         ...,
         [-0.2213, -0.6379, -0.3616,  ..., -0.7295, -0.8454, -0.7852],
         [ 0.1411,  0.4013, -0.1630,  ...,  0.5924,  0.4870,  0.3983],
         [-1.3167, -1.2927, -0.6643,  ..., -0.5777, -0.4061, -0.7380]],

        [[ 0.2047, -0.4794, -0.2979,  ..., -0.2733, -0.5815, -0.7161],
         [ 1.1395,  1.3539,  1.3033,  ...,  1.4503,  1.3004,  1.2249],
         [ 7.4665,  6.9978,  6.9952,  ...,  9.7764,  9.8047,  9.8515],
         ...,
         [-0.4365, -0.4515, -0.7232,  ..., -0.4328, -0.4409, -0.3792],
         [ 0.1946,  0.3386,  0.1623,  ..., -0.0461,  0.0286,  0.1454],
         [-0.8990, -0.7697, -1.1613,  ..., -0.1634, -0.0676, -0.3373]],

        ...,

        [[-0.1259,  0.0447,  0.2056,  ..., -0.6467, -0.5322, -0.0415],
         [ 0.8621,  0.5830,  0.5645,  ...,  0.9465,  1.1228,  0.6810],
         [ 7.9752,  8.0858,  7.4292,  ...,  9.6562,  9.6242,  9.6172],
         ...,
         [-0.0461, -0.4560, -0.3037,  ..., -0.3972, -0.1425, -0.4086],
         [ 0.2243,  0.2616,  0.1174,  ...,  0.3123,  0.2999,  0.1566],
         [-1.2129, -1.0092, -1.6586,  ..., -0.8253, -0.5646, -0.6472]],

        [[-0.4363, -0.7097, -0.5470,  ..., -0.9444, -0.8546, -1.1753],
         [ 0.7855,  1.0689,  0.7930,  ...,  1.2795,  0.7204,  1.3983],
         [ 7.7510,  7.4269,  7.3003,  ...,  9.5981,  9.7485,  9.3524],
         ...,
         [ 0.0514, -0.2232, -0.8841,  ..., -0.3397, -0.5988, -0.5780],
         [ 0.1360,  0.4050, -0.1890,  ...,  0.2251,  0.2162, -0.0507],
         [-1.0105, -0.8930, -0.7142,  ..., -0.6150, -0.5341, -0.4669]],

        [[-0.0310, -0.4729, -0.5810,  ..., -0.6223, -0.3549, -0.4897],
         [ 1.2717,  1.4908,  1.0345,  ...,  1.6281,  1.2111,  1.5144],
         [ 7.4740,  6.9197,  6.9758,  ...,  9.8917,  9.9016,  9.6831],
         ...,
         [-0.2669, -0.7513, -0.6125,  ..., -0.5834, -0.3951, -0.7587],
         [ 0.3224,  0.0273,  0.6879,  ...,  0.2213,  0.1056,  0.6027],
         [-0.7428, -0.7627, -0.7730,  ..., -0.3330, -0.4379, -0.3682]]],
       device='cuda:0', grad_fn=<PermuteBackward0>)
Tgt: tensor([[    0,  2263,   587,  ...,     2,     2,     2],
        [    0,    29, 26335,  ...,     2,     2,     2],
        [    0,    55,   235,  ...,     2,     2,     2],
        ...,
        [    0,   554,   450,  ...,     2,     2,     2],
        [    0, 39918, 10908,  ...,     2,     2,     2],
        [    0,    94,  1052,  ...,     2,     2,     2]], device='cuda:0')
Output: tensor([[[-0.1117, -0.3244, -0.4941,  ..., -0.6126, -0.5482, -0.5727],
         [ 1.0500,  1.0827,  0.5160,  ...,  0.7760,  1.0709,  1.5092],
         [ 7.1942,  6.4595,  6.8710,  ...,  9.2925,  9.2618,  9.0763],
         ...,
         [ 0.1693, -0.3132,  0.0666,  ...,  0.2768, -0.2898, -0.1673],
         [ 0.2240, -0.5335,  0.4007,  ...,  0.3915, -0.0532,  0.0142],
         [-1.1133, -1.6791, -1.0020,  ..., -0.9457, -0.6839, -0.9306]],

        [[-0.4469, -0.6663, -0.8478,  ..., -0.7464, -0.5647, -0.4721],
         [ 1.1216,  0.6783,  1.0468,  ...,  1.1887,  0.8897,  1.0672],
         [ 7.8936,  7.4433,  7.6647,  ..., 10.1619,  9.9874,  9.9857],
         ...,
         [-0.2213, -0.6379, -0.3616,  ..., -0.7295, -0.8454, -0.7852],
         [ 0.1411,  0.4013, -0.1630,  ...,  0.5924,  0.4870,  0.3983],
         [-1.3167, -1.2927, -0.6643,  ..., -0.5777, -0.4061, -0.7380]],

        [[ 0.2047, -0.4794, -0.2979,  ..., -0.2733, -0.5815, -0.7161],
         [ 1.1395,  1.3539,  1.3033,  ...,  1.4503,  1.3004,  1.2249],
         [ 7.4665,  6.9978,  6.9952,  ...,  9.7764,  9.8047,  9.8515],
         ...,
         [-0.4365, -0.4515, -0.7232,  ..., -0.4328, -0.4409, -0.3792],
         [ 0.1946,  0.3386,  0.1623,  ..., -0.0461,  0.0286,  0.1454],
         [-0.8990, -0.7697, -1.1613,  ..., -0.1634, -0.0676, -0.3373]],

        ...,

        [[-0.1259,  0.0447,  0.2056,  ..., -0.6467, -0.5322, -0.0415],
         [ 0.8621,  0.5830,  0.5645,  ...,  0.9465,  1.1228,  0.6810],
         [ 7.9752,  8.0858,  7.4292,  ...,  9.6562,  9.6242,  9.6172],
         ...,
         [-0.0461, -0.4560, -0.3037,  ..., -0.3972, -0.1425, -0.4086],
         [ 0.2243,  0.2616,  0.1174,  ...,  0.3123,  0.2999,  0.1566],
         [-1.2129, -1.0092, -1.6586,  ..., -0.8253, -0.5646, -0.6472]],

        [[-0.4363, -0.7097, -0.5470,  ..., -0.9444, -0.8546, -1.1753],
         [ 0.7855,  1.0689,  0.7930,  ...,  1.2795,  0.7204,  1.3983],
         [ 7.7510,  7.4269,  7.3003,  ...,  9.5981,  9.7485,  9.3524],
         ...,
         [ 0.0514, -0.2232, -0.8841,  ..., -0.3397, -0.5988, -0.5780],
         [ 0.1360,  0.4050, -0.1890,  ...,  0.2251,  0.2162, -0.0507],
         [-1.0105, -0.8930, -0.7142,  ..., -0.6150, -0.5341, -0.4669]],

        [[-0.0310, -0.4729, -0.5810,  ..., -0.6223, -0.3549, -0.4897],
         [ 1.2717,  1.4908,  1.0345,  ...,  1.6281,  1.2111,  1.5144],
         [ 7.4740,  6.9197,  6.9758,  ...,  9.8917,  9.9016,  9.6831],
         ...,
         [-0.2669, -0.7513, -0.6125,  ..., -0.5834, -0.3951, -0.7587],
         [ 0.3224,  0.0273,  0.6879,  ...,  0.2213,  0.1056,  0.6027],
         [-0.7428, -0.7627, -0.7730,  ..., -0.3330, -0.4379, -0.3682]]],
       device='cuda:0', grad_fn=<PermuteBackward0>)
Tgt: tensor([[ 2263,   587,  4383,  ...,     2,     2,     2],
        [   29, 26335, 31099,  ...,     2,     2,     2],
        [   55,   235,    23,  ...,     2,     2,     2],
        ...,
        [  554,   450,     1,  ...,     2,     2,     2],
        [39918, 10908,  9745,  ...,     2,     2,     2],
        [   94,  1052,    14,  ...,     2,     2,     2]], device='cuda:0')
Traceback (most recent call last):
  File "/local_disk0/.ephemeral_nfs/cluster_libraries/python/lib/python3.11/site-packages/wandb/sdk/lib/redirect.py", line 648, in write
    cb(data)
  File "/local_disk0/.ephemeral_nfs/cluster_libraries/python/lib/python3.11/site-packages/wandb/sdk/wandb_run.py", line 2388, in <lambda>
    lambda data: self._console_raw_callback("stderr", data),
KeyboardInterrupt:
 27%|██▋       | 16/59 [00:26<01:12,  1.68s/batch, loss=142]
  0%|          | 0/59 [00:14<?, ?batch/s, loss=6.77]
Output: torch.Size([168, 49, 68729])
Tgt: torch.Size([168, 50])
Output: torch.Size([168, 68729, 49])
Tgt: torch.Size([168, 50])
Output: torch.Size([168, 68729, 49])
Tgt: torch.Size([168, 49])
Epoch 0/50 | Train Loss: 0.11468505051176427 | Val Loss: 0.0
The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
[34m[1mwandb[0m: [33mWARNING[0m Calling wandb.login() after wandb.init() has no effect.
Reading CSV file...
Splitting is completed. Train size: 9801, Val size: 99, Test size: 100
Datasets are created.
DataLoaders are created.
  0%|          | 0/59 [00:14<?, ?batch/s]
OUTPUT: torch.Size([21, 68729, 49])
TGT: torch.Size([21, 48])
OUTPUT: torch.Size([21, 68729, 49])
TGT: torch.Size([21, 48])
OUTPUT: torch.Size([21, 68729, 49])
TGT: torch.Size([21, 48])
OUTPUT: torch.Size([21, 68729, 49])OUTPUT: torch.Size([21, 68729, 49])

TGT: torch.Size([21, 48])TGT: torch.Size([21, 48])

OUTPUT: torch.Size([21, 68729, 49])
TGT: torch.Size([21, 48])
OUTPUT: torch.Size([21, 68729, 49])
TGT: torch.Size([21, 48])
OUTPUT: torch.Size([21, 68729, 49])
TGT: torch.Size([21, 48])
The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
[34m[1mwandb[0m: [33mWARNING[0m Calling wandb.login() after wandb.init() has no effect.
Reading CSV file...
Splitting is completed. Train size: 9801, Val size: 99, Test size: 100
Datasets are created.
DataLoaders are created.
  0%|          | 0/59 [00:15<?, ?batch/s]
OUTPUT: torch.Size([21, 68729, 49])
TGT: torch.Size([21, 49])
OUTPUT: torch.Size([21, 68729, 49])
TGT: torch.Size([21, 49])
OUTPUT: torch.Size([21, 68729, 49])
TGT: torch.Size([21, 49])
OUTPUT: torch.Size([21, 68729, 49])OUTPUT: torch.Size([21, 68729, 49])

TGT: torch.Size([21, 49])TGT: torch.Size([21, 49])

OUTPUT: torch.Size([21, 68729, 49])
TGT: torch.Size([21, 49])
OUTPUT: torch.Size([21, 68729, 49])
TGT: torch.Size([21, 49])
OUTPUT: torch.Size([21, 68729, 49])
TGT: torch.Size([21, 49])
The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
[34m[1mwandb[0m: [33mWARNING[0m Calling wandb.login() after wandb.init() has no effect.
Reading CSV file...
Splitting is completed. Train size: 9801, Val size: 99, Test size: 100
Datasets are created.
DataLoaders are created.
  0%|          | 0/59 [00:15<?, ?batch/s]
The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
[34m[1mwandb[0m: [33mWARNING[0m Calling wandb.login() after wandb.init() has no effect.
Reading CSV file...
Splitting is completed. Train size: 9801, Val size: 99, Test size: 100
Datasets are created.
DataLoaders are created.
  0%|          | 0/59 [00:15<?, ?batch/s]
The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
[34m[1mwandb[0m: [33mWARNING[0m Calling wandb.login() after wandb.init() has no effect.
Reading CSV file...
Splitting is completed. Train size: 9801, Val size: 99, Test size: 100
Datasets are created.
DataLoaders are created.
  0%|          | 0/59 [00:16<?, ?batch/s]
The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
[34m[1mwandb[0m: [33mWARNING[0m Calling wandb.login() after wandb.init() has no effect.
Reading CSV file...
Splitting is completed. Train size: 9801, Val size: 99, Test size: 100
Datasets are created.
DataLoaders are created.
  0%|          | 0/59 [00:00<?, ?batch/s]
OUTPUT: tensor([[[-0.1119, -0.3586, -0.8210,  ...,  0.1071, -0.0711, -0.1088],
         [-0.2843,  0.2100,  0.3855,  ...,  0.0873,  0.0914,  0.3260],
         [-0.0796,  0.3395,  0.0388,  ...,  0.2819,  0.3084,  0.5569],
         ...,
         [ 0.1603,  0.0753, -0.5513,  ...,  0.1769,  0.4118,  0.5633],
         [-0.9168,  0.3528, -0.1350,  ..., -0.8570, -0.4405, -0.3512],
         [ 0.7874,  0.4019,  0.8868,  ...,  0.1449, -0.2158, -0.1267]],

        [[ 0.2094, -1.0647, -0.2848,  ...,  0.3225, -0.1242,  0.1190],
         [-0.1451,  0.8159,  0.0140,  ..., -0.3536, -0.1040, -0.1979],
         [ 0.0806,  0.6868,  1.4135,  ...,  1.0786,  1.2051,  0.9527],
         ...,
         [ 0.3009, -0.4773, -0.6228,  ...,  0.1865,  0.0081,  0.4132],
         [-0.8417, -0.7003, -1.3111,  ..., -0.5153, -0.2396, -0.8369],
         [ 0.3160,  0.1946,  0.1652,  ..., -0.2771, -0.3898,  0.0325]],

        [[ 0.3627,  0.0904,  0.8529,  ...,  0.4851,  0.4099,  0.1291],
         [ 0.4154,  0.7501,  0.2471,  ...,  0.2396,  0.0692, -0.2029],
         [-0.1543,  0.9570,  0.3545,  ...,  0.6710,  0.9132,  0.3555],
         ...,
         [-0.0314, -0.6680, -0.6326,  ..., -0.0980, -0.1826,  0.0905],
         [-0.7988, -0.3801, -1.1508,  ..., -0.6492, -0.6123, -0.4258],
         [ 0.7241,  0.1037,  0.2755,  ..., -0.3178, -0.1543, -0.2080]],

        ...,

        [[ 0.0350, -0.4247,  0.3953,  ...,  0.3100,  0.4340,  0.3390],
         [ 0.0571, -0.3427,  0.9402,  ...,  0.0852, -0.0128,  0.0484],
         [-0.0702,  0.8349, -0.1339,  ...,  0.8294,  0.2884,  0.7950],
         ...,
         [-0.1048, -0.4923, -0.6839,  ...,  0.2885,  0.2179,  0.9225],
         [-1.3460, -1.0579, -0.8374,  ..., -0.6971, -0.7319, -0.4438],
         [ 0.4936, -0.0776,  0.2511,  ..., -0.4032,  0.1022, -0.1395]],

        [[ 0.0485, -0.3024,  0.0617,  ...,  0.1721, -0.0463, -0.0822],
         [ 0.2192, -0.1197,  0.4965,  ..., -0.0750, -0.0080, -0.0849],
         [ 0.0941, -0.5591,  0.3887,  ...,  0.5465,  0.4990,  0.6196],
         ...,
         [ 0.3480, -0.1471, -0.6615,  ...,  0.2793,  0.1981,  0.6486],
         [-0.9933, -0.8892, -1.2692,  ..., -1.1132, -0.4700, -0.8187],
         [ 0.5893,  0.6780, -0.4491,  ..., -0.3725, -0.3551, -0.2183]],

        [[ 0.3445, -0.4191,  0.4010,  ...,  0.3120,  0.5970,  0.4227],
         [-0.0815,  0.0625, -0.4055,  ...,  0.1788,  0.4218, -0.0118],
         [ 0.0252,  0.8725, -0.2072,  ...,  0.4137,  0.4765,  0.5912],
         ...,
         [-0.0660, -0.4072, -0.7484,  ...,  0.4140,  0.3501,  0.2179],
         [-0.9213, -0.7471, -0.9096,  ..., -0.4193, -0.5119, -0.4541],
         [ 0.5508, -0.2851,  0.1421,  ..., -0.5202, -0.1391, -0.0716]]],
       device='cuda:0', grad_fn=<PermuteBackward0>)
TGT: tensor([[  129,    22, 41963,  ...,     2,     2,     2],
        [14062, 11884,   900,  ...,     2,     2,     2],
        [ 7443,     1,     2,  ...,     2,     2,     2],
        ...,
        [  206,     1,     2,  ...,     2,     2,     2],
        [   55,   595, 32407,  ...,     2,     2,     2],
        [ 1770,    55,   689,  ...,     2,     2,     2]], device='cuda:0')
Traceback (most recent call last):
  File "/databricks/python/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1479, in __del__
    self._shutdown_workers()
  File "/databricks/python/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1443, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/usr/lib/python3.11/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/multiprocessing/popen_fork.py", line 40, in wait
    if not wait([self.sentinel], timeout):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/multiprocessing/connection.py", line 935, in wait
    ready = selector.select(timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt:
  0%|          | 0/59 [00:15<?, ?batch/s, loss=11]
Epoch 0/50 | Train Loss: 0.1858523255687649 | Val Loss: 0.0
  0%|          | 0/59 [00:17<?, ?batch/s, loss=10.6]
OUTPUT: torch.Size([168, 68729, 49])
TGT: torch.Size([168, 49])
Epoch 0/50 | Train Loss: 0.17915604478221828 | Val Loss: 0.0
The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
[34m[1mwandb[0m: [33mWARNING[0m Calling wandb.login() after wandb.init() has no effect.
Reading CSV file...
Splitting is completed. Train size: 9801, Val size: 99, Test size: 100
Datasets are created.
DataLoaders are created.
  0%|          | 0/59 [00:17<?, ?batch/s]
  0%|          | 0/59 [00:18<?, ?batch/s]
OUTPUT: torch.Size([21, 68729, 49])
TGT: torch.Size([21, 49])
OUTPUT: torch.Size([21, 68729, 49])
TGT: torch.Size([21, 49])
OUTPUT: torch.Size([21, 68729, 49])
TGT: torch.Size([21, 49])
OUTPUT: torch.Size([21, 68729, 49])
TGT: torch.Size([21, 49])
OUTPUT: torch.Size([21, 68729, 49])
TGT: torch.Size([21, 49])
OUTPUT: torch.Size([21, 68729, 49])
TGT: torch.Size([21, 49])
OUTPUT: torch.Size([21, 68729, 49])
TGT: torch.Size([21, 49])
OUTPUT: torch.Size([21, 68729, 49])
TGT: torch.Size([21, 49])
